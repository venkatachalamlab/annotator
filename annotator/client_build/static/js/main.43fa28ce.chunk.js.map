{"version":3,"sources":["annotation_window/actions.ts","third_party/lru.js","api/index.ts","annotations/actions.ts","app/selectors.ts","annotation_window/helpers.ts","annotation_window/selectors.ts","worldlines/selectors.ts","annotations/selectors.ts","annotations/sagas.ts","annotations/components/AnnotationsSVG.tsx","annotations/components/AnnotationPanel.tsx","worldlines/actions.ts","worldlines/sagas.ts","worldlines/components/Worldline.tsx","worldlines/components/WorldlinePanel.tsx","annotation_window/sagas.ts","test_components/ActionForm.tsx","annotation_window/components/AnnotationWindowTest.tsx","annotation_window/components/AnnovationView.tsx","annotation_window/components/WindowPanel.tsx","annotation_window/webgl/gl-matrix/common.js","annotation_window/webgl/gl-matrix/mat3.js","annotation_window/webgl/gl-matrix/mat4.js","annotation_window/webgl/gl-matrix/vec3.js","annotation_window/webgl/gl-matrix/vec4.js","annotation_window/webgl/gl-matrix/quat.js","annotation_window/webgl/gl-matrix/vec2.js","annotation_window/webgl/webgl-util.js","annotation_window/webgl/shader-srcs.js","annotation_window/components/VolumeView.tsx","annotation_window/components/AnnotationWindow.tsx","app/components/App.tsx","app/actions.ts","app/sagas.ts","app/components/AppTest.tsx","serviceWorker.js","index.tsx"],"names":["initialState","x","y","z","c_idx","t_idx","shape_x","shape_y","shape_z","views","shape_t","scale_x","scale_y","scale_z","LUT","red","green","blue","selected_annotation","visible_worldlines","selected_worldline","active_provenance","fill_circles","show_all_annotations","rpc_list","name","default_args","docstring","rpc_keybindings","rpc_args","threshold","val","min","max","Math","reducers","set_state","state","action","payload","set_x","adjust_x","set_y","adjust_y","set_z","adjust_z","set_c_idx","adjust_c_idx","idx","n","length","set_t_idx","set_scale_x","set_scale_y","set_scale_z","set_shape_x","set_shape_y","set_shape_z","set_LUT_color","set_selected_annotation_local","set_selected_worldline_local","set_active_provenance","set_fill_circles","toggle_fill_circles","set_show_all_annotations","toggle_all_annotations","set_rpc_list","set_rpc_keybinding","set_rpc_args","set_rpc_arg","center_on_annotation","Number","annotation_window_slice","createSlice","actions","reducer","NEWER","Symbol","OLDER","LRUMap","limit","entries","this","size","oldest","newest","undefined","_keymap","Map","assign","Entry","key","value","EntryIterator","oldestEntry","entry","KeyIterator","ValueIterator","prototype","_markEntryAsUsed","MAX_VALUE","clear","it","iterator","itv","next","done","e","set","Error","get","shift","delete","find","has","ent","keys","values","forEach","fun","thisObj","call","toJSON","s","Array","i","toString","String","image_cache","annotation_cache","fetch_metadata","fetch","then","json","fetch_data_cache","url","signal","a","uint8_array","arrayBuffer","array","Uint8ClampedArray","catch","err","console","error","insert_annotation","annotation","method","headers","body","JSON","stringify","response","fetch_annotations_cache","t","annotations","fetch_annotations","update_annotation","id","delete_annotation","create_worldline","fetch_worldlines","update_worldline","w","delete_worldline","save","data","window","alert","path","log","load","fetch_rpcs","rpc","arg","annotations_slice","set_annotation_local","delete_annotation_local","get_annotations_state","app_state","idx_from_coord","coord","shape","floor","LUT_linear","lut","get_state","annotation_window","get_x","createSelector","get_y","get_z","get_c_idx","get_t_idx","get_shape_x","get_shape_y","get_shape_z","get_shape_t","get_views","get_scale_x","get_scale_y","get_scale_z","get_LUT","get_selected_annotation","get_visible_worldlines","get_selected_worldline","get_active_provenance","get_fill_circles","get_show_all_annotations","get_rpc_list","get_rpc_keybindings","get_x_idx","get_y_idx","get_z_idx","get_view","get_dim_viewname","dim","view","get_x_viewname","get_y_viewname","get_z_viewname","get_dim_viewidx","bare_getter","get_x_viewidx","get_y_viewidx","get_z_viewidx","make_data_url","get_x_url","get_y_url","get_z_url","get_vol_url","worldlines","get_worldlines","Object","filter","visible","map","app_selectors","get_annotation_ids","fp","get_used_worldline_ids","mapValues","get_annotations_list","get_visible_annotations","worldlines_selectors","pickBy","includes","worldline_id","get_selected_annotation_id","annotation_window_selectors","all","findKey","get_color","worldline","color","get_annotations_with_all_info","selected","get_annotations_view3D","pick","get_visible_annotations_near","output_x","output_y","r","close_3D","abs","radius","get_x_annotations","get_y_annotations","get_z_annotations","insert_annotation_here","get_annotations","watch_insert_annotation","watch_insert_annotation_here","watch_get_annotations","watch_annotations_on_set_t_idx","watch_update_annotation","watch_delete_annotation","prefix","saga_action_types","saga_actions","createAction","api","put","annotation_window_saga_actions","set_selected_annotation","select","bare","provenance","abort_controller","AbortController","cached_annotations","abort","annotation_window_actions","annotations_selectors","updated_annotation","ok","takeEvery","takeLatest","sagas","props","annotation_SVGs","cx","size_x","cy","size_y","stroke","strokeWidth","fill","onClick","deselect","preventDefault","stopPropagation","onDoubleClick","AnnotationSVG","AnnotationPanel","connect","selectors","dispatch","bindActionCreators","connector","React","useState","setAnnotation","useEffect","textfields","style","position","TF","field","field_key","TextField","type","label","onChange","event","new_annotation","handle_change","target","width","height","margin","InputProps","fontFamily","Card","elevation","variant","square","left","top","CardContent","IconButton","aria-label","fontSize","set_worldlines_local","set_worldline_lists_local","worldline_lists","selected_lists","set_worldline_local","update_worldline_local","delete_worldline_local","worldlines_slice","set_all_visible","watch_create_worldline","watch_get_worldlines","watch_update_worldline","watch_delete_worldline","watch_set_all_visible","set_all_invisible","new_worldline_raw","new_worldline","raw_worldlines","removed_id","new_worldlines","Worldline","get_name","setState","float","checked","on_check","marginTop","border","onBlur","on_rename","backgroundColor","padding","on_recolor","opacity","WorldlinesPanel","set_selected_worldline","new_name","new_color","Button","fetch_state","center_on_current_annotation","adjust_t","click","doubleclick","rpc_from_key","watch_fetch_state","watch_set_selected_annotation","watch_set_selected_worldline","watch_center_on_current_annotation","watch_adjust_t","watch_click","watch_doubleclick","watch_save","watch_load","watch_rpc","watch_rpc_from_key","meta","rpcs","new_state","new_id","worldlines_actions","annotations_saga_actions","worldlines_saga_actions","result","status","callbacks","try_int_payload","parseInt","putResolve","delay","exception","traceback","method_idx","ActionForm","handleChange","bind","handleSubmit","input_parser","onSubmit","defaultValue","Component","FloatForm","parseFloat","x_idx","A","full_state","bare_state","derived_state","state_json","mapDispatchToProps","connector_X","height_scale","width_scale","data_url","x_dim","y_dim","connector_Y","connector_Z","AnnotationView","fetch_and_draw","draw_to_canvas","LUTdata","ctx","refs","canvas","getContext","iData","ImageData","putImageData","make_click_handler","click_fn","getBoundingClientRect","x_pixels","clientX","y_pixels","clientY","x_local","y_local","handle_click","handle_doubleclick","prev_props","svg_width","svg_height","hline","x1","y1","x2","y2","vline","right","ref","zIndex","AnnotationsSVG","AnnotationViewX","AnnotationViewY","AnnotationViewZ","DocstringTooltip","withStyles","tooltip","maxWidth","Tooltip","WindowPanel","window_state","set_window_state","toFixed","update","InputLabelProps","rpc_keys","split","keyname","rpc_idx","Fragment","interactive","title","placement","FormControl","marginBottom","InputLabel","Select","labelId","handle_new_rpc_keybinding","MenuItem","nextState","createNextState","draft","handle_rpc_arg_change","ARRAY_TYPE","Float32Array","RANDOM","random","PI","hypot","arguments","sqrt","create","out","glMatrix","fromMat4","clone","copy","fromValues","m00","m01","m02","m10","m11","m12","m20","m21","m22","identity","transpose","a01","a02","a12","invert","a00","a10","a11","a20","a21","a22","b01","b11","b21","det","adjoint","determinant","multiply","b","b00","b02","b10","b12","b20","b22","translate","v","rotate","rad","sin","c","cos","scale","fromTranslation","fromRotation","fromScaling","fromMat2d","fromQuat","q","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","projection","str","frob","add","subtract","multiplyScalar","multiplyScalarAndAdd","exactEquals","equals","a0","a1","a2","a3","a4","a5","a6","a7","a8","b0","b1","b2","b3","b4","b5","b6","b7","b8","mul","sub","m03","m13","m23","m30","m31","m32","m33","axis","len","rotateX","rotateY","rotateZ","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","xy","xz","yz","fromQuat2","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","fromRotationTranslationScale","sx","sy","sz","fromRotationTranslationScaleOrigin","o","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","frustum","bottom","near","far","rl","tb","nf","perspective","fovy","aspect","f","tan","Infinity","perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","ortho","lr","bt","lookAt","eye","center","up","x0","y0","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","targetTo","a9","a14","a15","b9","b13","b14","b15","divide","ceil","round","scaleAndAdd","distance","squaredDistance","squaredLength","negate","inverse","normalize","dot","cross","lerp","hermite","d","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformMat4","m","transformMat3","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","p","angle","mag","cosine","acos","zero","div","dist","sqrDist","sqrLen","vec","stride","offset","count","fn","l","u","B","C","D","E","F","G","H","I","J","v1","v2","v3","v4","s1","s2","ix","iy","iz","iw","setAxisAngle","getAxisAngle","out_axis","getAngle","dotproduct","calculateW","exp","et","ln","atan2","pow","slerp","omega","cosom","sinom","scale0","scale1","u1","u2","u3","sqrt1MinusU1","sqrtU1","invDot","conjugate","fromMat3","fRoot","fTrace","j","k","fromEuler","halfToRad","cz","vec4","rotationTo","tmpvec3","vec3","xUnitVec3","yUnitVec3","sqlerp","temp1","temp2","setAxes","matr","mat3","transformMat2","transformMat2d","p0","p1","sinC","cosC","Shader","gl","vertexSrc","fragmentSrc","self","program","compileShader","regexUniform","matchUniformName","uniforms","vertexUnifs","match","fragUnifs","unif","getUniformLocation","use","useProgram","vert","frag","vs","createShader","VERTEX_SHADER","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","fs","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","ArcballCamera","zoomSpeed","screenDims","veye","vcenter","vup","zAxis","viewDist","xAxis","yAxis","invScreen","centerTranslation","mat4","vt","rotMat","rotation","quat","camera","invCamera","updateCameraMatrix","prevMouse","curMouse","mPrev","vec2","clamp","mCur","mPrevBall","screenToArcball","mCurBall","zoom","amount","pan","mouseDelta","delta","worldDelta","eyePos","eyeDir","dir","upDir","unitP","pointDist","Buffer","capacity","dtype","buffer","Uint8Array","Int8Array","Uint16Array","Int16Array","Uint32Array","Int32Array","Float64Array","append","buf","newCap","tmp","constructor","BYTES_PER_ELEMENT","Controller","mousemove","press","wheel","twoFingerDrag","pinch","registerForCanvas","addEventListener","evt","rect","deltaY","oncontextmenu","touches","changedTouches","identifier","prevTouch","curTouch","buttons","curTouches","oldTouches","push","newTouches","motionVectors","motionDirs","pinchAxis","panAxis","pinchMotion","panMotion","sign","oldDist","newDist","panAmount","touchEnd","cubeStrip","_VolumeView","shader","volumeTexture","proj","projView","targetFrameTime","samplingRate","WIDTH","HEIGHT","volDims","tex","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_3D","texStorage3D","R8","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_WRAP_R","CLAMP_TO_EDGE","TEXTURE_WRAP_S","TEXTURE_WRAP_T","texSubImage3D","RED","UNSIGNED_BYTE","longestAxis","volScale","uniform3iv","uniform3fv","deleteTexture","setInterval","document","hidden","startTime","Date","clearColor","COLOR_BUFFER_BIT","uniformMatrix4fv","drawArrays","TRIANGLE_STRIP","finish","targetSamplingRate","getTime","uniform1f","defaultEye","controller","prev","cur","amt","drag","vao","createVertexArray","bindVertexArray","vbo","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform1i","enable","CULL_FACE","cullFace","FRONT","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","colormapImage","Image","onload","draw","colormap","TEXTURE1","TEXTURE_2D","texStorage2D","SRGB8_ALPHA8","texSubImage2D","RGBA","src","VolumeView","XYZSliderBase","Slider","orientation","flip","step","track","handler","TSliderBase","max_val","LUTSliderBase","setValue","newValue","valueLabelDisplay","AnnotationWindow","annotations_z","annotations_3D","size_z","x_image_left","y_image_top","x_slider_top","y_slider_left","z_slider_1_left","z_slider_1_top","z_slider_2_left","z_slider_2_top","t_slider_top","t_slider_length","annotation_panel_left","LUT_slider_length","LUT_top","LUT_G_left","LUT_B_left","window_panel_top","worldlines_panel_left","XSlider","YSlider","ZSlider1","ZSlider2","TSlider","LUTSliderRed","h","LUTSliderGreen","LUTSliderBlue","tabIndex","onKeyDown","fromCharCode","which","ctrl","ctrlKey","shiftKey","onKeyUp","annotation_panel_top","App","annotations_actions","combineReducers","annotation_window_reducer","annotations_reducer","worldlines_reducer","saga","annotation_window_sagas","annotations_sagas","worldlines_sagas","AppTest","theme","Boolean","location","hostname","sagaMiddleware","createSagaMiddleware","middleware","getDefaultMiddleware","thunk","store","configureStore","run","darkTheme","createMuiTheme","palette","primary","secondary","pink","typography","join","ReactDOM","render","ThemeProvider","exact","component","getElementById","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.43fa28ce.chunk.js","sourcesContent":["import { AnnotationWindowState_t as State_t, rpc_t } from './model'\r\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\"\r\nimport { annotation_id_t, Annotation_t } from '../annotations/model'\r\nimport { worldline_id_t } from '../worldlines/model';\r\n\r\nexport const initialState: State_t = {\r\n  x: 0.5,\r\n  y: 0.5,\r\n  z: 0.5,\r\n  c_idx: 0,\r\n  t_idx: 0,\r\n  shape_x: 0,\r\n  shape_y: 0,\r\n  shape_z: 0,\r\n  views: [\"slice\", \"mip\", \"vol\"],\r\n  shape_t: 0,\r\n  scale_x: 1,\r\n  scale_y: 1,\r\n  scale_z: 1,\r\n  LUT: {\r\n    red: [0, 150],\r\n    green: [0, 150],\r\n    blue: [0, 150]\r\n  },\r\n  selected_annotation: null,\r\n  visible_worldlines: [],\r\n  selected_worldline: null,\r\n  active_provenance: \"ANTT\",\r\n  fill_circles: true,\r\n  show_all_annotations: false,\r\n  rpc_list: [{ name: \"None found\", default_args: \"\", docstring: \"\" }],\r\n  rpc_keybindings: {\r\n    \"1\": 0,\r\n    \"2\": 0,\r\n    \"3\": 0,\r\n    \"4\": 0,\r\n    \"5\": 0,\r\n    \"6\": 0,\r\n    \"7\": 0,\r\n    \"8\": 0,\r\n    \"9\": 0,\r\n    \"0\": 0,\r\n  },\r\n  rpc_args: {\r\n    \"1\": \"\",\r\n    \"2\": \"\",\r\n    \"3\": \"\",\r\n    \"4\": \"\",\r\n    \"5\": \"\",\r\n    \"6\": \"\",\r\n    \"7\": \"\",\r\n    \"8\": \"\",\r\n    \"9\": \"\",\r\n    \"0\": \"\",\r\n  },\r\n};\r\n\r\nconst threshold = (val: number, min: number, max: number): number =>\r\n  Math.max(Math.min(val, max), 0)\r\n\r\nconst reducers = {\r\n\r\n  set_state: (state: State_t, action: PayloadAction<State_t>) =>\r\n    action.payload,\r\n\r\n  set_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.x = threshold(action.payload, 0, 1)\r\n  },\r\n  adjust_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.x = threshold(state.x + action.payload, 0, 1)\r\n  },\r\n\r\n  set_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.y = threshold(action.payload, 0, 1)\r\n  },\r\n  adjust_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.y = threshold(state.y + action.payload, 0, 1)\r\n  },\r\n\r\n  set_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.z = threshold(action.payload, 0, 1)\r\n  },\r\n  adjust_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.z = threshold(state.z + action.payload, 0, 1)\r\n  },\r\n\r\n  set_c_idx: (state: State_t, action: PayloadAction<number>) => {\r\n    state.c_idx = action.payload\r\n  },\r\n\r\n  adjust_c_idx: (state: State_t, action: PayloadAction<number>) => {\r\n    const idx = state.c_idx + action.payload\r\n    const n = state.views.length\r\n    state.c_idx = ((idx % n) + n) % n\r\n  },\r\n\r\n  set_t_idx: (state: State_t, action: PayloadAction<number>) => {\r\n    state.t_idx = threshold(action.payload, 0, state.shape_t - 1)\r\n  },\r\n\r\n  set_scale_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.scale_x = action.payload;\r\n  },\r\n  set_scale_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.scale_y = action.payload;\r\n  },\r\n  set_scale_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.scale_z = action.payload;\r\n  },\r\n\r\n  set_shape_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.shape_x = action.payload;\r\n  },\r\n  set_shape_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.shape_y = action.payload;\r\n  },\r\n  set_shape_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.shape_z = action.payload;\r\n  },\r\n\r\n  set_LUT_color: (state: State_t,\r\n    action: PayloadAction<[\"red\" | \"green\" | \"blue\", number, number]>) => {\r\n    state.LUT[action.payload[0]] = [action.payload[1], action.payload[2]]\r\n  },\r\n\r\n  set_selected_annotation_local: (\r\n    state: State_t, action: PayloadAction<annotation_id_t | null>) => {\r\n    state.selected_annotation = action.payload\r\n  },\r\n\r\n  set_selected_worldline_local: (\r\n    state: State_t, action: PayloadAction<worldline_id_t | null>) => {\r\n    state.selected_worldline = action.payload\r\n  },\r\n\r\n  set_active_provenance: (\r\n    state: State_t, action: PayloadAction<string>) => {\r\n    state.active_provenance = action.payload\r\n  },\r\n\r\n  set_fill_circles: (\r\n    state: State_t, action: PayloadAction<boolean>) => {\r\n    state.fill_circles = action.payload\r\n  },\r\n\r\n  toggle_fill_circles: (\r\n    state: State_t, action: PayloadAction) => {\r\n    state.fill_circles = !state.fill_circles\r\n  },\r\n\r\n  set_show_all_annotations: (\r\n    state: State_t, action: PayloadAction<boolean>) => {\r\n    state.show_all_annotations = action.payload\r\n  },\r\n\r\n  toggle_all_annotations: (\r\n    state: State_t, action: PayloadAction) => {\r\n    state.show_all_annotations = !state.show_all_annotations\r\n  },\r\n\r\n  set_rpc_list: (\r\n    state: State_t, action: PayloadAction<rpc_t[]>) => {\r\n    state.rpc_list = action.payload\r\n  },\r\n\r\n  set_rpc_keybinding: (\r\n    state: State_t, action: PayloadAction<[string, number]>) => {\r\n    state.rpc_keybindings[action.payload[0]] = action.payload[1]\r\n  },\r\n\r\n  set_rpc_args: (\r\n    state: State_t, action: PayloadAction<{ [key: string]: string }>) => {\r\n    state.rpc_args = action.payload\r\n  },\r\n\r\n  set_rpc_arg: (\r\n    state: State_t, action: PayloadAction<[string, string]>) => {\r\n    state.rpc_args[action.payload[0]] = action.payload[1]\r\n  },\r\n\r\n  center_on_annotation: (\r\n    state: State_t, action: PayloadAction<Annotation_t>) => {\r\n    state.x = Number(action.payload.x)\r\n    state.y = Number(action.payload.y)\r\n    state.z = Number(action.payload.z)\r\n  },\r\n}\r\n\r\nconst annotation_window_slice = createSlice({\r\n  name: 'annotation_window',\r\n  initialState,\r\n  reducers\r\n})\r\n\r\nexport const { actions, reducer } = annotation_window_slice\r\n","/**\r\n * A doubly linked list-based Least Recently Used (LRU) cache. Will keep most\r\n * recently used items while discarding least recently used items when its limit\r\n * is reached.\r\n *\r\n * Licensed under MIT. Copyright (c) 2010 Rasmus Andersson <http://hunch.se/>\r\n * See README.md for details.\r\n *\r\n * Illustration of the design:\r\n *\r\n *       entry             entry             entry             entry\r\n *       ______            ______            ______            ______\r\n *      | head |.newer => |      |.newer => |      |.newer => | tail |\r\n *      |  A   |          |  B   |          |  C   |          |  D   |\r\n *      |______| <= older.|______| <= older.|______| <= older.|______|\r\n *\r\n *  removed  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  added\r\n */\r\n\r\nconst NEWER = Symbol('newer');\r\nconst OLDER = Symbol('older');\r\n\r\nexport function LRUMap(limit, entries) {\r\n  if (typeof limit !== 'number') {\r\n    // called as (entries)\r\n    entries = limit;\r\n    limit = 0;\r\n  }\r\n\r\n  this.size = 0;\r\n  this.limit = limit;\r\n  this.oldest = this.newest = undefined;\r\n  this._keymap = new Map();\r\n\r\n  if (entries) {\r\n    this.assign(entries);\r\n    if (limit < 1) {\r\n      this.limit = this.size;\r\n    }\r\n  }\r\n}\r\n\r\nfunction Entry(key, value) {\r\n  this.key = key;\r\n  this.value = value;\r\n  this[NEWER] = undefined;\r\n  this[OLDER] = undefined;\r\n}\r\n\r\n\r\nLRUMap.prototype._markEntryAsUsed = function(entry) {\r\n  if (entry === this.newest) {\r\n    // Already the most recenlty used entry, so no need to update the list\r\n    return;\r\n  }\r\n  // HEAD--------------TAIL\r\n  //   <.older   .newer>\r\n  //  <--- add direction --\r\n  //   A  B  C  <D>  E\r\n  if (entry[NEWER]) {\r\n    if (entry === this.oldest) {\r\n      this.oldest = entry[NEWER];\r\n    }\r\n    entry[NEWER][OLDER] = entry[OLDER]; // C <-- E.\r\n  }\r\n  if (entry[OLDER]) {\r\n    entry[OLDER][NEWER] = entry[NEWER]; // C. --> E\r\n  }\r\n  entry[NEWER] = undefined; // D --x\r\n  entry[OLDER] = this.newest; // D. --> E\r\n  if (this.newest) {\r\n    this.newest[NEWER] = entry; // E. <-- D\r\n  }\r\n  this.newest = entry;\r\n};\r\n\r\nLRUMap.prototype.assign = function(entries) {\r\n  let entry, limit = this.limit || Number.MAX_VALUE;\r\n  this._keymap.clear();\r\n  let it = entries[Symbol.iterator]();\r\n  for (let itv = it.next(); !itv.done; itv = it.next()) {\r\n    let e = new Entry(itv.value[0], itv.value[1]);\r\n    this._keymap.set(e.key, e);\r\n    if (!entry) {\r\n      this.oldest = e;\r\n    } else {\r\n      entry[NEWER] = e;\r\n      e[OLDER] = entry;\r\n    }\r\n    entry = e;\r\n    if (limit-- === 0) {\r\n      throw new Error('overflow');\r\n    }\r\n  }\r\n  this.newest = entry;\r\n  this.size = this._keymap.size;\r\n};\r\n\r\nLRUMap.prototype.get = function(key) {\r\n  // First, find our cache entry\r\n  var entry = this._keymap.get(key);\r\n  if (!entry) return; // Not cached. Sorry.\r\n  // As <key> was found in the cache, register it as being requested recently\r\n  this._markEntryAsUsed(entry);\r\n  return entry.value;\r\n};\r\n\r\nLRUMap.prototype.set = function(key, value) {\r\n  var entry = this._keymap.get(key);\r\n\r\n  if (entry) {\r\n    // update existing\r\n    entry.value = value;\r\n    this._markEntryAsUsed(entry);\r\n    return this;\r\n  }\r\n\r\n  // new entry\r\n  this._keymap.set(key, (entry = new Entry(key, value)));\r\n\r\n  if (this.newest) {\r\n    // link previous tail to the new tail (entry)\r\n    this.newest[NEWER] = entry;\r\n    entry[OLDER] = this.newest;\r\n  } else {\r\n    // we're first in -- yay\r\n    this.oldest = entry;\r\n  }\r\n\r\n  // add new entry to the end of the linked list -- it's now the freshest entry.\r\n  this.newest = entry;\r\n  ++this.size;\r\n  if (this.size > this.limit) {\r\n    // we hit the limit -- remove the head\r\n    this.shift();\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nLRUMap.prototype.shift = function() {\r\n  // todo: handle special case when limit == 1\r\n  var entry = this.oldest;\r\n  if (entry) {\r\n    if (this.oldest[NEWER]) {\r\n      // advance the list\r\n      this.oldest = this.oldest[NEWER];\r\n      this.oldest[OLDER] = undefined;\r\n    } else {\r\n      // the cache is exhausted\r\n      this.oldest = undefined;\r\n      this.newest = undefined;\r\n    }\r\n    // Remove last strong reference to <entry> and remove links from the purged\r\n    // entry being returned:\r\n    entry[NEWER] = entry[OLDER] = undefined;\r\n    this._keymap.delete(entry.key);\r\n    --this.size;\r\n    return [entry.key, entry.value];\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------\r\n// Following code is optional and can be removed without breaking the core\r\n// functionality.\r\n\r\nLRUMap.prototype.find = function(key) {\r\n  let e = this._keymap.get(key);\r\n  return e ? e.value : undefined;\r\n};\r\n\r\nLRUMap.prototype.has = function(key) {\r\n  return this._keymap.has(key);\r\n};\r\n\r\nLRUMap.prototype['delete'] = function(key) {\r\n  var entry = this._keymap.get(key);\r\n  if (!entry) return;\r\n  this._keymap.delete(entry.key);\r\n  if (entry[NEWER] && entry[OLDER]) {\r\n    // relink the older entry with the newer entry\r\n    entry[OLDER][NEWER] = entry[NEWER];\r\n    entry[NEWER][OLDER] = entry[OLDER];\r\n  } else if (entry[NEWER]) {\r\n    // remove the link to us\r\n    entry[NEWER][OLDER] = undefined;\r\n    // link the newer entry to head\r\n    this.oldest = entry[NEWER];\r\n  } else if (entry[OLDER]) {\r\n    // remove the link to us\r\n    entry[OLDER][NEWER] = undefined;\r\n    // link the newer entry to head\r\n    this.newest = entry[OLDER];\r\n  } else {// if(entry[OLDER] === undefined && entry.newer === undefined) {\r\n    this.oldest = this.newest = undefined;\r\n  }\r\n\r\n  this.size--;\r\n  return entry.value;\r\n};\r\n\r\nLRUMap.prototype.clear = function() {\r\n  // Not clearing links should be safe, as we don't expose live links to user\r\n  this.oldest = this.newest = undefined;\r\n  this.size = 0;\r\n  this._keymap.clear();\r\n};\r\n\r\n\r\nfunction EntryIterator(oldestEntry) { this.entry = oldestEntry; }\r\nEntryIterator.prototype[Symbol.iterator] = function() { return this; }\r\nEntryIterator.prototype.next = function() {\r\n  let ent = this.entry;\r\n  if (ent) {\r\n    this.entry = ent[NEWER];\r\n    return { done: false, value: [ent.key, ent.value] };\r\n  } else {\r\n    return { done: true, value: undefined };\r\n  }\r\n};\r\n\r\n\r\nfunction KeyIterator(oldestEntry) { this.entry = oldestEntry; }\r\nKeyIterator.prototype[Symbol.iterator] = function() { return this; }\r\nKeyIterator.prototype.next = function() {\r\n  let ent = this.entry;\r\n  if (ent) {\r\n    this.entry = ent[NEWER];\r\n    return { done: false, value: ent.key };\r\n  } else {\r\n    return { done: true, value: undefined };\r\n  }\r\n};\r\n\r\nfunction ValueIterator(oldestEntry) { this.entry = oldestEntry; }\r\nValueIterator.prototype[Symbol.iterator] = function() { return this; }\r\nValueIterator.prototype.next = function() {\r\n  let ent = this.entry;\r\n  if (ent) {\r\n    this.entry = ent[NEWER];\r\n    return { done: false, value: ent.value };\r\n  } else {\r\n    return { done: true, value: undefined };\r\n  }\r\n};\r\n\r\n\r\nLRUMap.prototype.keys = function() {\r\n  return new KeyIterator(this.oldest);\r\n};\r\n\r\nLRUMap.prototype.values = function() {\r\n  return new ValueIterator(this.oldest);\r\n};\r\n\r\nLRUMap.prototype.entries = function() {\r\n  return this;\r\n};\r\n\r\nLRUMap.prototype[Symbol.iterator] = function() {\r\n  return new EntryIterator(this.oldest);\r\n};\r\n\r\nLRUMap.prototype.forEach = function(fun, thisObj) {\r\n  if (typeof thisObj !== 'object') {\r\n    thisObj = this;\r\n  }\r\n  let entry = this.oldest;\r\n  while (entry) {\r\n    fun.call(thisObj, entry.value, entry.key, this);\r\n    entry = entry[NEWER];\r\n  }\r\n};\r\n\r\n/** Returns a JSON (array) representation */\r\nLRUMap.prototype.toJSON = function() {\r\n  var s = new Array(this.size), i = 0, entry = this.oldest;\r\n  while (entry) {\r\n    s[i++] = { key: entry.key, value: entry.value };\r\n    entry = entry[NEWER];\r\n  }\r\n  return s;\r\n};\r\n\r\n/** Returns a String representation */\r\nLRUMap.prototype.toString = function() {\r\n  var s = '', entry = this.oldest;\r\n  while (entry) {\r\n    s += String(entry.key)+':'+entry.value;\r\n    entry = entry[NEWER];\r\n    if (entry) {\r\n      s += ' < ';\r\n    }\r\n  }\r\n  return s;\r\n};\r\n","import { LRUMap } from '../third_party/lru'\r\nimport { AnnotationsState_t, Annotation_t, annotation_id_t } from '../annotations/model'\r\nimport { Worldline_t, Worldlines_t, worldline_id_t } from '../worldlines/model'\r\n\r\nconst image_cache = new LRUMap<string, Uint8ClampedArray>(5000)\r\nconst annotation_cache = new LRUMap<number, AnnotationsState_t>(1000)\r\n\r\n// Annotation window\r\n\r\nexport const fetch_metadata = () => {\r\n  return fetch(\"/metadata\")\r\n    .then(x => x.json())\r\n}\r\n\r\nexport async function fetch_data_cache(\r\n  url: string,\r\n  signal: AbortSignal): Promise<Uint8ClampedArray> {\r\n\r\n  if (image_cache.has(url)) {\r\n    const uint8_array = image_cache.get(url)\r\n    if (uint8_array !== undefined) {\r\n      return uint8_array\r\n    }\r\n  }\r\n\r\n  return await fetch(url, { signal })\r\n    .then((x) => x.arrayBuffer())\r\n    .then((x) => {\r\n      const array = new Uint8ClampedArray(x);\r\n      image_cache.set(url, array);\r\n      return array;\r\n    })\r\n    .catch(err => {\r\n      if (err.name === \"AbortError\") {\r\n        // console.log(\"Fetch aborted:\", url)\r\n      }\r\n      else {\r\n        console.error(err)\r\n      }\r\n    }) as Uint8ClampedArray\r\n\r\n}\r\n\r\nexport async function fetch_data(\r\n  url: string,\r\n  signal: AbortSignal): Promise<Uint8ClampedArray> {\r\n\r\n  return await fetch(url, { signal })\r\n    .then((x) => x.arrayBuffer())\r\n    .then((x) => new Uint8ClampedArray(x))\r\n    .catch(err => {\r\n      if (err.name === \"AbortError\") {\r\n        // console.log(\"Fetch aborted:\", url)\r\n      }\r\n      else {\r\n        console.error(err)\r\n      }\r\n    }) as Uint8ClampedArray\r\n\r\n}\r\n\r\n// Annotations\r\n\r\nexport type bare_annotation_t = {\r\n  x: number,\r\n  y: number,\r\n  z: number,\r\n  t_idx: number,\r\n  worldline_id: number\r\n}\r\n\r\nexport const insert_annotation = (annotation: bare_annotation_t) => {\r\n  return fetch(\"/annotations\", {\r\n    method: \"POST\", // or \"PUT\"\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(annotation),\r\n  })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport function fetch_annotations_cache(t: number):\r\n  AnnotationsState_t | undefined {\r\n\r\n  if (annotation_cache.has(t)) {\r\n    const annotations = annotation_cache.get(t)\r\n    if (annotations !== undefined) {\r\n      return annotations\r\n    }\r\n  }\r\n\r\n}\r\n\r\n// export const fetch_annotations = (t: number) =>{\r\n//   return fetch(`/t/${t}/annotations`)\r\n//   .then((response) => response.json())\r\n// }\r\n\r\nexport async function fetch_annotations(t: number, signal: AbortSignal):\r\n  Promise<AnnotationsState_t> {\r\n\r\n  return await fetch(`/t/${t}/annotations`, { signal })\r\n    .then((x) => x.json())\r\n    .then((x) => {\r\n      annotation_cache.set(t, x);\r\n      return x;\r\n    })\r\n    .catch(err => {\r\n      if (err.name === \"AbortError\") {\r\n        // console.log(\"Fetch aborted: Annotations for \", t)\r\n      }\r\n      else {\r\n        console.error(err)\r\n      }\r\n    }) as AnnotationsState_t\r\n}\r\n\r\nexport const update_annotation = (a: Annotation_t) => {\r\n  return fetch(`/annotations/${a.id}`, {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(a),\r\n  })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport const delete_annotation = (id: annotation_id_t) => {\r\n  return fetch(`/annotations/${id}`, { method: \"DELETE\" })\r\n}\r\n\r\n// Worldlines\r\n\r\nexport const create_worldline = () => {\r\n  return fetch(`/worldlines`, { method: \"POST\" })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport const fetch_worldlines = () => {\r\n  return fetch(`/worldlines`, { method: \"GET\" })\r\n    .then((response) => (response.json() as Promise<Worldlines_t>))\r\n}\r\n\r\nexport const update_worldline = (w: Partial<Worldline_t>) => {\r\n  return fetch(`/worldlines/${w.id}`, {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(w),\r\n  })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport const delete_worldline = (id: worldline_id_t) => {\r\n  return fetch(`/worldlines/${id}`, { method: \"DELETE\" })\r\n}\r\n\r\n// Save worldlines and annotations\r\n\r\nexport const save = () => {\r\n  return fetch(\"/save\", {\r\n    method: \"POST\",\r\n  })\r\n    .then((response) => response.json())\r\n    .then((data) => {\r\n      window.alert(`Save successful: ${data.path}`);\r\n      console.log(\"Saved to: \", data)\r\n    })\r\n    .catch((error) => {\r\n      window.alert(\"Save failed. See console.\")\r\n      console.error(\"Error:\", error);\r\n    });\r\n}\r\n\r\n// Load worldlines and annotations\r\n\r\nexport const load = () => {\r\n  return fetch(\"/load\", {\r\n    method: \"POST\",\r\n  })\r\n    .then((response) => response.json())\r\n    .then((data) => {\r\n      window.alert(`Load successful: ${data.path}`);\r\n    })\r\n    .catch((error) => {\r\n      window.alert(\"Load failed. See console.\")\r\n      console.error(\"Error:\", error);\r\n    });\r\n}\r\n\r\n// RPC\r\n\r\nexport const fetch_rpcs = () => {\r\n  return fetch(\"/rpc\")\r\n    .then(x => x.json())\r\n}\r\n\r\nexport const rpc = (method: string, arg: string, state: AnnotationsState_t) => {\r\n\r\n  return fetch(\"/rpc\", {\r\n    method: \"POST\", // or \"PUT\"\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify({ method, arg, state }),\r\n  })\r\n    .then((response) => response.json())\r\n\r\n}","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\n\r\nimport {\r\n  AnnotationsState_t as State_t ,\r\n  Annotation_t,\r\n  annotation_id_t\r\n} from './model'\r\n\r\nexport const initialState: State_t = {}\r\n\r\nconst reducers = {\r\n\r\n  set_state: (state: State_t, action: PayloadAction<State_t>) =>\r\n    action.payload,\r\n\r\n  set_annotation_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Annotation_t>) => {\r\n      state[action.payload.id] = action.payload\r\n    },\r\n\r\n  delete_annotation_local: (\r\n    state: State_t,\r\n    action: PayloadAction<annotation_id_t>) => {\r\n      delete state[action.payload]\r\n    }\r\n\r\n}\r\n\r\nconst annotations_slice = createSlice({\r\n  name: 'annotations',\r\n  initialState,\r\n  reducers\r\n})\r\n\r\nexport const { actions, reducer } = annotations_slice","import { State_t } from './model'\r\n\r\nexport const get_annotation_window_state = (app_state: State_t) =>\r\n    app_state.annotation_window\r\n\r\nexport const get_annotations_state = (app_state: State_t) =>\r\n    app_state.annotations\r\n\r\nexport const get_worldlines_state = (app_state: State_t) =>\r\n    app_state.worldlines\r\n\r\nexport const get_dataset = (app_state: State_t) =>\r\n    app_state.dataset\r\n","// Convert x/y/z to index values using shape. The convention is that images\r\n// go from 0.0 to 1.0, so the center values of each pixel are in (0, 1)\r\n\r\nimport { LUT_t } from \"./model\"\r\n\r\nexport const idx_from_coord = (coord: number, shape: number): number => {\r\n  return Math.max(Math.floor(coord * shape - 1e-6), 0)\r\n}\r\nexport const coord_from_idx = (idx: number, shape: number): number => {\r\n  return (idx + 0.5) / shape\r\n}\r\n\r\n// Apply a LUT to a uint8 array.\r\n\r\nconst LUT_linear = (value: number, lut: [number, number]): number =>\r\n  255 / (lut[1] - lut[0]) * (value - lut[0])\r\n\r\nexport const apply_LUT =\r\n  (data: Uint8ClampedArray, LUT: LUT_t): Uint8ClampedArray =>\r\n\r\n    data.map((val: number, idx: number): number => {\r\n      const offset = idx % 4\r\n      switch (offset) {\r\n        case 0: return LUT_linear(val, LUT.red)\r\n        case 1: return LUT_linear(val, LUT.green)\r\n        case 2: return LUT_linear(val, LUT.blue)\r\n        default: return val\r\n      }\r\n    })\r\n\r\nexport const apply_green_LUT =\r\n  (data: Uint8ClampedArray, LUT: LUT_t): Uint8ClampedArray =>\r\n\r\n  data.map((val: number): number => LUT_linear(val, LUT.green))\r\n","import { createSelector } from 'reselect'\r\n\r\nimport * as app_selectors from '../app/selectors'\r\nimport { idx_from_coord } from './helpers'\r\nimport { State_t } from '../app/model'\r\n\r\nexport const get_state = app_selectors.get_annotation_window_state\r\n\r\n// Top level selectors\r\nexport const get_x = createSelector(get_state, s => s.x)\r\nexport const get_y = createSelector(get_state, s => s.y)\r\nexport const get_z = createSelector(get_state, s => s.z)\r\nexport const get_c_idx = createSelector(get_state, s => s.c_idx)\r\nexport const get_t_idx = createSelector(get_state, s => s.t_idx)\r\nexport const get_shape_x = createSelector(get_state, s => s.shape_x)\r\nexport const get_shape_y = createSelector(get_state, s => s.shape_y)\r\nexport const get_shape_z = createSelector(get_state, s => s.shape_z)\r\nexport const get_shape_t = createSelector(get_state, s => s.shape_t)\r\nexport const get_views = createSelector(get_state, s => s.views)\r\nexport const get_scale_x = createSelector(get_state, s => s.scale_x)\r\nexport const get_scale_y = createSelector(get_state, s => s.scale_y)\r\nexport const get_scale_z = createSelector(get_state, s => s.scale_z)\r\nexport const get_LUT = createSelector(get_state, s => s.LUT)\r\nexport const get_selected_annotation = createSelector(get_state,\r\n  s => s.selected_annotation)\r\nexport const get_visible_worldlines = createSelector(get_state,\r\n  s => s.visible_worldlines)\r\nexport const get_selected_worldline = createSelector(get_state,\r\n  s => s.selected_worldline)\r\nexport const get_active_provenance = createSelector(get_state,\r\n  s => s.active_provenance)\r\nexport const get_fill_circles = createSelector(get_state, s => s.fill_circles)\r\nexport const get_show_all_annotations = createSelector(get_state,\r\n  s => s.show_all_annotations)\r\nexport const get_rpc_list = createSelector(get_state,\r\n  s => s.rpc_list)\r\nexport const get_rpc_keybindings = createSelector(get_state,\r\n  s => s.rpc_keybindings)\r\n\r\n// Convert coordinate in (0, 1) to index in [0, shape-1]\r\nexport const get_x_idx = createSelector([get_x, get_shape_x], idx_from_coord)\r\nexport const get_y_idx = createSelector([get_y, get_shape_y], idx_from_coord)\r\nexport const get_z_idx = createSelector([get_z, get_shape_z], idx_from_coord)\r\n\r\n// Get view information\r\n\r\nexport const get_view = createSelector(\r\n  get_views,\r\n  get_c_idx,\r\n  (views, c_idx) => views[c_idx]\r\n)\r\n\r\nconst get_dim_viewname = (dim: 'x' | 'y' | 'z') => createSelector(\r\n  get_view,\r\n  (view) => {\r\n    switch (view) {\r\n      case \"slice\": return dim\r\n      case \"mip\": return `mip_${dim}`\r\n      default: return dim\r\n    }\r\n  }\r\n)\r\n\r\nconst get_x_viewname = get_dim_viewname('x')\r\nconst get_y_viewname = get_dim_viewname('y')\r\nconst get_z_viewname = get_dim_viewname('z')\r\n\r\nconst get_dim_viewidx = (dim: 'x' | 'y' | 'z',\r\n  bare_getter: (s: State_t) => number) => createSelector(\r\n    get_view,\r\n    bare_getter,\r\n    (view, idx) => {\r\n      switch (view) {\r\n        case \"slice\": return idx\r\n        case \"mip\": return 0\r\n        default: return idx\r\n      }\r\n    }\r\n)\r\n\r\nconst get_x_viewidx = get_dim_viewidx('x', get_x_idx)\r\nconst get_y_viewidx = get_dim_viewidx('y', get_y_idx)\r\nconst get_z_viewidx = get_dim_viewidx('z', get_z_idx)\r\n\r\n// Get image urls (fetching has to be done in components)\r\n\r\nconst make_data_url = (t: number, view: string, x: number) =>\r\n  `/t/${t}/data/${view}/${x}`\r\n\r\nexport const get_x_url = createSelector(\r\n  get_t_idx,\r\n  get_x_viewname,\r\n  get_x_viewidx,\r\n  make_data_url\r\n)\r\nexport const get_y_url = createSelector(\r\n  get_t_idx,\r\n  get_y_viewname,\r\n  get_y_viewidx,\r\n  make_data_url\r\n)\r\nexport const get_z_url = createSelector(\r\n  get_t_idx,\r\n  get_z_viewname,\r\n  get_z_viewidx,\r\n  make_data_url\r\n)\r\n\r\nexport const get_vol_url = createSelector(\r\n  get_t_idx,\r\n  (t) => make_data_url(t, \"gvol\", 1)\r\n)","import { createSelector } from 'reselect'\r\n\r\nimport * as app_selectors from '../app/selectors'\r\n\r\nexport const get_state = app_selectors.get_worldlines_state\r\n\r\nexport const get_worldlines = createSelector(\r\n  get_state,\r\n  (s) => s.worldlines\r\n)\r\n\r\nexport const get_visible_worldlines = createSelector(\r\n  get_worldlines,\r\n  (s) => Object.entries(s)\r\n    .filter((w) => w[1].visible)\r\n    .map((w) => Number(w[0]))\r\n)\r\n","import { createSelector } from 'reselect'\r\nimport fp from 'lodash/fp'\r\nimport { Dictionary } from 'lodash'\r\n\r\nimport { annotation_id_t, Annotation_t } from './model'\r\nimport * as app_selectors from '../app/selectors'\r\nimport * as annotation_window_selectors from '../annotation_window/selectors'\r\nimport * as worldlines_selectors from '../worldlines/selectors'\r\nimport { Worldline_t, WorldlinesState_t } from '../worldlines/model'\r\n\r\nexport const get_state = app_selectors.get_annotations_state\r\n\r\nexport const get_annotation_ids = createSelector(\r\n  get_state,\r\n  fp.keys\r\n)\r\n\r\nexport const get_used_worldline_ids = createSelector(\r\n  get_state,\r\n  (x) => fp.values(fp.mapValues(\"worldline_id\")(x))\r\n)\r\n\r\n// Get annotations\r\n\r\nexport const get_annotations_list = createSelector(\r\n  get_state,\r\n  (annotations) => {\r\n    return Object.entries(annotations).map((a) => a[1])\r\n  }\r\n)\r\n\r\nexport const get_visible_annotations = createSelector(\r\n  get_state,\r\n  worldlines_selectors.get_visible_worldlines,\r\n  (s, w) => fp.pickBy((x: Annotation_t) => w.includes(x.worldline_id))(s)\r\n)\r\n\r\nexport const get_selected_annotation_id = createSelector(\r\n  get_state,\r\n  annotation_window_selectors.get_selected_annotation,\r\n  annotation_window_selectors.get_selected_worldline,\r\n  (all, a, w) => {\r\n    if (a && a > 0) {\r\n      return a\r\n    }\r\n    else if (w && w > 0) {\r\n      return Number(fp.findKey({ worldline_id: w })(all))\r\n    } else {\r\n      return null\r\n    }\r\n  }\r\n)\r\n\r\nexport const get_selected_annotation = createSelector(\r\n  get_state,\r\n  get_selected_annotation_id,\r\n  (all, a) => { return (a ? all[a] : null) }\r\n)\r\n\r\n// Gather information needed to draw annotations in 3D or 2D.\r\n\r\nconst get_worldline_for_annotation = (\r\n  annotation: Annotation_t,\r\n  worldlines: WorldlinesState_t) =>\r\n  worldlines.worldlines[annotation.worldline_id]\r\n\r\nconst get_color = (annotation: Annotation_t, worldline: Worldline_t) => {\r\n  return worldline.color\r\n}\r\n\r\nconst get_annotations_with_all_info = createSelector(\r\n  get_visible_annotations,\r\n  worldlines_selectors.get_state,\r\n  get_selected_annotation_id,\r\n  (a, w, s) => fp.mapValues((x: Annotation_t) => {\r\n    const worldline = get_worldline_for_annotation(x, w)\r\n    return {\r\n      ...x,\r\n      //worldline: worldline,\r\n      color: get_color(x, worldline),\r\n      selected: x.id === s\r\n    }\r\n  }\r\n  )(a)\r\n)\r\n\r\nexport type AnnotationView3D_t = {\r\n  id: annotation_id_t,\r\n  x: number,\r\n  y: number,\r\n  z: number,\r\n  color: string,\r\n  selected: boolean\r\n}\r\nexport const get_annotations_view3D = createSelector(\r\n  get_annotations_with_all_info,\r\n  fp.mapValues(fp.pick(['id', 'x', 'y', 'z', 'color', 'selected']))\r\n)\r\n\r\nexport type AnnotationView2D_t = {\r\n  id: annotation_id_t,\r\n  x: number,\r\n  y: number,\r\n  color: string,\r\n  selected: boolean,\r\n  radius: number\r\n}\r\nconst get_visible_annotations_near = (\r\n  annotations: Dictionary<AnnotationView3D_t>,\r\n  dim: 'x' | 'y' | 'z',\r\n  output_x: 'x' | 'y' | 'z',\r\n  output_y: 'x' | 'y' | 'z',\r\n  coord: number,\r\n  r: number\r\n): Dictionary<AnnotationView2D_t> => {\r\n\r\n  const is_close = (a: AnnotationView3D_t) => {\r\n    return (r - Math.abs(a[dim] - coord)) > 0\r\n  }\r\n\r\n  const project_2D = (a: AnnotationView3D_t): any => {\r\n    return {\r\n      id: a.id,\r\n      x: a[output_x],\r\n      y: a[output_y],\r\n      color: a.color,\r\n      selected: a.selected,\r\n      radius: 4\r\n    }\r\n  }\r\n\r\n  const close_3D = fp.pickBy(is_close)(annotations)\r\n  return fp.mapValues(project_2D)(close_3D)\r\n\r\n}\r\n\r\nconst RADIUS_X = 0.02\r\nconst RADIUS_Y = 0.02\r\nconst RADIUS_Z = 0.07\r\n\r\nexport const get_x_annotations = createSelector(\r\n  get_annotations_view3D,\r\n  annotation_window_selectors.get_x,\r\n  annotation_window_selectors.get_show_all_annotations,\r\n  (a, x, all) => {\r\n    if (all) {\r\n      return get_visible_annotations_near(a, \"x\", \"z\", \"y\", x, 2.0)\r\n    } else {\r\n      return get_visible_annotations_near(a, \"x\", \"z\", \"y\", x, RADIUS_X)\r\n    }\r\n  }\r\n)\r\n\r\nexport const get_y_annotations = createSelector(\r\n  get_annotations_view3D,\r\n  annotation_window_selectors.get_y,\r\n  annotation_window_selectors.get_show_all_annotations,\r\n  (a, y, all) => {\r\n    if (all) {\r\n      return get_visible_annotations_near(a, \"y\", \"x\", \"z\", y, 2.0)\r\n    } else {\r\n      return get_visible_annotations_near(a, \"y\", \"x\", \"z\", y, RADIUS_Y)\r\n    }\r\n  }\r\n)\r\n\r\nexport const get_z_annotations = createSelector(\r\n  get_annotations_view3D,\r\n  annotation_window_selectors.get_z,\r\n  annotation_window_selectors.get_show_all_annotations,\r\n  (a, z, all) => {\r\n    if (all) {\r\n      return get_visible_annotations_near(a, \"z\", \"x\", \"y\", z, 2.0)\r\n    } else {\r\n      return get_visible_annotations_near(a, \"z\", \"x\", \"y\", z, RADIUS_Z)\r\n    }\r\n  }\r\n)","import { call, put, takeEvery, takeLatest, select }\r\n  from 'redux-saga/effects'\r\nimport { createAction, PayloadAction } from '@reduxjs/toolkit'\r\nimport { actions } from './actions'\r\nimport { actions as annotation_window_actions ,\r\n  saga_actions as annotation_window_saga_actions }\r\n  from '../annotation_window'\r\nimport * as annotation_window_selectors from '../annotation_window/selectors'\r\nimport * as annotations_selectors from '../annotations/selectors'\r\nimport { State_t as AppState_t } from '../app/model'\r\n\r\nimport * as api from '../api'\r\nimport { Annotation_t } from './model'\r\n\r\nconst prefix = \"annotations/\"\r\nconst saga_action_types = {\r\n  insert_annotation: prefix + \"insert_annotation\",\r\n  insert_annotation_here: prefix + \"insert_annotation_here\",\r\n  get_annotations: prefix + \"get_annotations\",\r\n  update_annotation: prefix + \"update_annotation\",\r\n  delete_annotation: prefix + \"delete_annotation\",\r\n}\r\n\r\nexport const saga_actions = {\r\n\r\n  insert_annotation: createAction<api.bare_annotation_t>(\r\n    saga_action_types.insert_annotation),\r\n\r\n  insert_annotation_here: createAction(\r\n    saga_action_types.insert_annotation_here),\r\n\r\n  get_annotations: createAction(saga_action_types.get_annotations),\r\n\r\n  update_annotation: createAction<Annotation_t>(\r\n    saga_action_types.update_annotation),\r\n\r\n  delete_annotation: createAction(saga_action_types.delete_annotation)\r\n\r\n}\r\n\r\nfunction* insert_annotation(action: PayloadAction<api.bare_annotation_t>) {\r\n\r\n  const a = yield call(api.insert_annotation, action.payload)\r\n  yield put(actions.set_annotation_local(a))\r\n  yield put(annotation_window_saga_actions.set_selected_annotation(a.id))\r\n\r\n}\r\n\r\nfunction* insert_annotation_here() {\r\n\r\n  const state: AppState_t = yield select()\r\n\r\n  const { x, y, z, t_idx, selected_worldline, active_provenance } =\r\n    state.annotation_window\r\n\r\n  let worldline_id = selected_worldline\r\n  if (worldline_id === null) {\r\n    worldline_id = 0\r\n  }\r\n\r\n  const bare = { x, y, z, t_idx, worldline_id, provenance: active_provenance }\r\n\r\n  yield put(saga_actions.insert_annotation(bare))\r\n\r\n}\r\n\r\nlet abort_controller = new AbortController()\r\nfunction* get_annotations(action:PayloadAction<number>) {\r\n\r\n  const t_idx = yield select(annotation_window_selectors.get_t_idx)\r\n\r\n  const cached_annotations = yield call(api.fetch_annotations_cache, t_idx)\r\n  if (cached_annotations !== undefined) {\r\n    yield put(actions.set_state(cached_annotations))\r\n  }\r\n\r\n  abort_controller.abort()\r\n  abort_controller = new AbortController()\r\n\r\n  const annotations = yield call(api.fetch_annotations, t_idx,\r\n    abort_controller.signal)\r\n  yield put(actions.set_state(annotations))\r\n\r\n  yield put(annotation_window_actions.set_selected_annotation_local(null))\r\n\r\n  const selected_annotation = yield select(\r\n    annotations_selectors.get_selected_annotation)\r\n\r\n  if (selected_annotation) {\r\n    yield put(\r\n      annotation_window_actions.center_on_annotation(selected_annotation))\r\n  }\r\n\r\n}\r\n\r\nfunction* update_annotation(action: PayloadAction<Annotation_t>) {\r\n  const updated_annotation = yield call(api.update_annotation, action.payload)\r\n  yield put(actions.set_annotation_local(updated_annotation))\r\n  yield put(annotation_window_saga_actions\r\n    .set_selected_annotation(updated_annotation.id))\r\n}\r\n\r\nfunction* delete_annotation(action: PayloadAction) {\r\n\r\n  const selected = yield select(\r\n    annotations_selectors.get_selected_annotation_id)\r\n\r\n  const status = yield call(api.delete_annotation, selected)\r\n\r\n  if (status.ok) {\r\n    yield put(actions.delete_annotation_local(selected))\r\n    yield put(annotation_window_actions.set_selected_annotation_local(null))\r\n  }\r\n}\r\n\r\nfunction* watch_insert_annotation() {\r\n  yield takeEvery(saga_action_types.insert_annotation, insert_annotation)\r\n}\r\n\r\nfunction* watch_insert_annotation_here() {\r\n  yield takeEvery(saga_action_types.insert_annotation_here,\r\n    insert_annotation_here)\r\n}\r\n\r\nfunction* watch_get_annotations() {\r\n  yield takeLatest(saga_action_types.get_annotations, get_annotations)\r\n}\r\n\r\nfunction* watch_annotations_on_set_t_idx() {\r\n  yield takeLatest(\"annotation_window/set_t_idx\", get_annotations)\r\n}\r\n\r\nfunction* watch_update_annotation() {\r\n  yield takeEvery(saga_action_types.update_annotation, update_annotation)\r\n}\r\n\r\nfunction* watch_delete_annotation() {\r\n  yield takeEvery(saga_action_types.delete_annotation, delete_annotation)\r\n}\r\nexport const sagas = [\r\n  watch_insert_annotation,\r\n  watch_insert_annotation_here,\r\n  watch_get_annotations,\r\n  watch_annotations_on_set_t_idx,\r\n  watch_update_annotation,\r\n  watch_delete_annotation,\r\n]","import React from 'react'\r\n\r\nimport { AnnotationView2D_t } from '../selectors'\r\nimport { Dictionary } from 'lodash'\r\n\r\ntype AnnotationSVG_props_t = AnnotationView2D_t & {\r\n  size_x: number,\r\n  size_y: number,\r\n  select: (id: number) => any,\r\n  deselect: (id: number) => any,\r\n  fill_circles: boolean,\r\n}\r\n\r\nconst AnnotationSVG = (props: AnnotationSVG_props_t) =>\r\n  <circle\r\n    key={props.id}\r\n    cx={props.x * props.size_x}\r\n    cy={props.y * props.size_y}\r\n    r={props.selected ? 2 * props.radius : props.radius}\r\n    stroke={props.fill_circles? \"white\":  props.color}\r\n    strokeWidth=\"1\"\r\n    fill={props.fill_circles? props.color: \"none\"}\r\n    onClick={(e) => {\r\n      props.selected ? props.deselect(props.id) : props.select(props.id)\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n    }}\r\n    onDoubleClick={(e) => { e.preventDefault(); e.stopPropagation(); }} />\r\n\r\n\r\ntype AnnotationsSVG_props_t = {\r\n  annotations: Dictionary<AnnotationView2D_t>\r\n  size_x: number,\r\n  size_y: number,\r\n  select: (id: number) => any,\r\n  deselect: (id: number) => any,\r\n  fill_circles: boolean,\r\n}\r\n\r\nexport default (props: AnnotationsSVG_props_t) => {\r\n\r\n  const annotation_SVGs = Object.entries(props.annotations).map((a) =>\r\n    AnnotationSVG({\r\n      ...a[1],\r\n      size_x: props.size_x,\r\n      size_y: props.size_y,\r\n      select: props.select,\r\n      deselect: props.deselect,\r\n      fill_circles: props.fill_circles\r\n    }))\r\n\r\n  return <g> {annotation_SVGs} </g>\r\n}","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\nimport { TextField, Card, CardContent } from '@material-ui/core'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport DoneIcon from '@material-ui/icons/Done'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../../index'\r\nimport * as selectors from '../selectors'\r\nimport { saga_actions } from '../sagas'\r\nimport { Annotation_t } from '../model'\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    annotation: selectors.get_selected_annotation(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype AnnotationPanel_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\nconst _AnnotationPanel = (props: AnnotationPanel_props_t) => {\r\n\r\n  const [annotation, setAnnotation] = React.useState(props.annotation)\r\n\r\n  React.useEffect(() => {\r\n    setAnnotation(props.annotation);\r\n  },\r\n    [props.annotation])\r\n\r\n  let textfields = [<div key=\"null\" style={{ position: \"absolute\" }}>\r\n    select an annotation\r\n    </div>,]\r\n\r\n  const handle_change = (key: string, value: number | string) => {\r\n    const new_annotation = { ...(annotation as Annotation_t), [key]: value }\r\n    console.log(key, value, new_annotation)\r\n    setAnnotation(new_annotation)\r\n  }\r\n\r\n  if (annotation != null) {\r\n\r\n    const TF = (field: string, name: string) => {\r\n      const field_key = field as keyof Annotation_t\r\n\r\n      return <TextField\r\n        type=\"string\"\r\n        label={name}\r\n        key={field_key}\r\n        value={annotation[field_key] !== null ? annotation[field_key] : \"\"}\r\n        onChange={(event) => handle_change(field_key, event.target.value)}\r\n        style={{\r\n          position: \"relative\",\r\n          width: \"100px\",\r\n          height: \"30px\",\r\n          margin: \"10px\",\r\n        }}\r\n        InputProps={{ style: { fontFamily: \"monospace\" } }}\r\n      />\r\n    }\r\n\r\n    textfields = [\r\n      [\"x\", \"x\"],\r\n      [\"y\", \"y\"],\r\n      [\"z\", \"z\"],\r\n      [\"t_idx\", \"t\"],\r\n      [\"id\", \"id\"],\r\n      [\"worldline_id\", \"track\"],\r\n      [\"parent_id\", \"parent_id\"],\r\n      [\"provenance\", \"provenance\"]]\r\n      .map((x) => TF(x[0], x[1]))\r\n\r\n  }\r\n\r\n  return (\r\n    <Card\r\n      elevation={3}\r\n      variant=\"outlined\"\r\n      square\r\n      style={{\r\n        position: \"absolute\",\r\n        left: props.left,\r\n        top: props.top,\r\n        width: \"340px\",\r\n        height: \"300px\"\r\n      }}>\r\n      <CardContent>\r\n        <h3>Annotation</h3>\r\n\r\n        <IconButton\r\n          aria-label=\"done\"\r\n          onClick={() =>\r\n            props.saga_actions.update_annotation(annotation as Annotation_t)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"230px\",\r\n            top: \"20px\"\r\n          }}>\r\n          <DoneIcon fontSize=\"small\" />\r\n        </IconButton>\r\n\r\n        <IconButton\r\n          aria-label=\"delete\"\r\n          onClick={props.saga_actions.delete_annotation}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"280px\",\r\n            top: \"20px\"\r\n          }}>\r\n          <DeleteIcon fontSize=\"small\" />\r\n        </IconButton>\r\n\r\n        {textfields}\r\n      </CardContent>\r\n    </Card>)\r\n}\r\n\r\nconst AnnotationPanel = connector(_AnnotationPanel)\r\nexport default AnnotationPanel","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\n\r\nimport {\r\n  worldline_id_t,\r\n  Worldline_t,\r\n  Worldlines_t,\r\n  WorldlinesState_t as State_t,\r\n} from './model'\r\n\r\nexport const initialState: State_t = {\r\n  worldlines: {},\r\n  worldline_lists: null,\r\n  selected_lists: []\r\n}\r\n\r\nconst reducers = {\r\n\r\n  set_state: (state: State_t, action: PayloadAction<State_t>) =>\r\n    action.payload,\r\n\r\n  set_worldlines_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Worldlines_t>) => {\r\n    state.worldlines = action.payload\r\n  },\r\n\r\n  set_worldline_lists_local: (\r\n    state: State_t,\r\n    action: PayloadAction<{ [key: string]: [worldline_id_t] }>) => {\r\n    state.worldline_lists = action.payload\r\n    state.selected_lists = []\r\n  },\r\n\r\n  set_worldline_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Worldline_t>) => {\r\n    state.worldlines[action.payload.id] = action.payload\r\n  },\r\n\r\n  update_worldline_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Partial<Worldline_t>>) => {\r\n    if (action.payload.id !== undefined)\r\n      state.worldlines[action.payload.id] = {\r\n        ...state.worldlines[action.payload.id],\r\n        ...action.payload\r\n      }\r\n  },\r\n\r\n  delete_worldline_local: (\r\n    state: State_t,\r\n    action: PayloadAction<worldline_id_t>) => {\r\n    delete state.worldlines[action.payload]\r\n  },\r\n\r\n}\r\n\r\nconst worldlines_slice = createSlice({\r\n  name: 'worldlines',\r\n  initialState,\r\n  reducers\r\n})\r\n\r\nexport const { actions, reducer } = worldlines_slice","import { createAction, PayloadAction } from '@reduxjs/toolkit'\r\nimport { call, put, takeEvery, select } from 'redux-saga/effects'\r\nimport fp from 'lodash/fp'\r\n\r\nimport * as api from '../api'\r\nimport { actions } from './actions'\r\nimport * as selectors from './selectors'\r\nimport { Worldline_t, worldline_id_t, Worldlines_t } from './model'\r\n\r\nconst prefix = \"worldlines/\"\r\nconst saga_action_types = {\r\n  create_worldline: prefix + \"create_worldline\",\r\n  get_worldlines: prefix + \"get_worldlines\",\r\n  update_worldline: prefix + \"update_worldline\",\r\n  delete_worldline: prefix + \"delete_worldline\",\r\n  set_all_visible: prefix + \"set_all_visible\",\r\n  set_all_invisible: prefix + \"set_all_invisible\",\r\n}\r\n\r\nexport const saga_actions = {\r\n  create_worldline: createAction(saga_action_types.create_worldline),\r\n  get_worldlines: createAction(saga_action_types.get_worldlines),\r\n  update_worldline: createAction<Partial<Worldline_t>>(\r\n    saga_action_types.update_worldline),\r\n  delete_worldline: createAction<worldline_id_t>(\r\n    saga_action_types.delete_worldline),\r\n  set_all_visible: createAction<boolean>(saga_action_types.set_all_visible),\r\n}\r\n\r\nfunction* create_worldline(action: PayloadAction) {\r\n  const new_worldline_raw = yield call(api.create_worldline)\r\n  const new_worldline = {\r\n    ...new_worldline_raw,\r\n    visible: true,\r\n  }\r\n  yield put(actions.set_worldline_local(new_worldline))\r\n}\r\n\r\nfunction* get_worldlines(action: PayloadAction) {\r\n\r\n  const raw_worldlines = (yield call(api.fetch_worldlines)) as Worldlines_t\r\n\r\n  let worldlines: Worldlines_t = {}\r\n  for (let w of Object.values(raw_worldlines)) {\r\n    worldlines[Number(w.id)] = {\r\n      id: Number(w.id),\r\n      name: String(w.name),\r\n      color: String(w.color),\r\n      visible: true\r\n    }\r\n  }\r\n\r\n  yield put(actions.set_worldlines_local(worldlines))\r\n\r\n}\r\n\r\nfunction* update_worldline(action: PayloadAction<Partial<Worldline_t>>) {\r\n  const worldline = yield call(api.update_worldline, action.payload)\r\n  yield put(actions.update_worldline_local(worldline))\r\n}\r\n\r\nfunction* delete_worldline(action: PayloadAction<worldline_id_t>) {\r\n  const removed_id = yield call(api.delete_worldline, action.payload)\r\n  if (removed_id >= 0) yield put(actions.delete_worldline_local(removed_id))\r\n}\r\n\r\nfunction* set_all_visible(action: PayloadAction<boolean>) {\r\n  const worldlines = yield select(selectors.get_worldlines)\r\n  const new_worldlines = fp.mapValues((x: Worldline_t) => {\r\n    return { ...x, visible: action.payload }})(worldlines)\r\n  yield put(actions.set_worldlines_local(new_worldlines))\r\n}\r\n\r\nfunction* watch_create_worldline() {\r\n  yield takeEvery(saga_action_types.create_worldline, create_worldline)\r\n}\r\nfunction* watch_get_worldlines() {\r\n  yield takeEvery(saga_action_types.get_worldlines, get_worldlines)\r\n}\r\nfunction* watch_update_worldline() {\r\n  yield takeEvery(saga_action_types.update_worldline, update_worldline)\r\n}\r\nfunction* watch_delete_worldline() {\r\n  yield takeEvery(saga_action_types.delete_worldline, delete_worldline)\r\n}\r\nfunction* watch_set_all_visible() {\r\n  yield takeEvery(saga_action_types.set_all_visible, set_all_visible)\r\n}\r\n\r\nexport const sagas = [\r\n  watch_create_worldline,\r\n  watch_get_worldlines,\r\n  watch_update_worldline,\r\n  watch_delete_worldline,\r\n  watch_set_all_visible\r\n]","import React, { useState } from 'react'\r\n\r\nimport { Worldline_t } from '../model'\r\n\r\ntype Worldline_props_t = {\r\n  // left: number,\r\n  // top: number,\r\n  worldline: Worldline_t,\r\n  on_check: (state: boolean) => any,\r\n  on_rename: (new_name: string) => any,\r\n  on_recolor: (new_color: string) => any,\r\n}\r\n\r\nconst Worldline = (props: Worldline_props_t) => {\r\n\r\n  const get_name = (x: Worldline_props_t) => {\r\n    const name = x.worldline.name\r\n    if (name && name !== \"null\") {\r\n      return name\r\n    } else {\r\n      return String(x.worldline.id)\r\n    }\r\n  }\r\n\r\n  const [state, setState] = useState(get_name(props))\r\n  React.useEffect(() => {\r\n    setState(get_name(props));\r\n  }, [props])\r\n\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        float: \"left\",\r\n        position: \"relative\",\r\n        height: \"30px\",\r\n        width: \"100px\"\r\n        // left: props.left,\r\n        // top: props.top,\r\n      }}>\r\n      <input type=\"checkbox\"\r\n        checked={props.worldline.visible}\r\n        onChange={(event) => props.on_check(event.target.checked)}\r\n        style={{\r\n          float: \"left\",\r\n          marginTop: \"8px\"\r\n        }} />\r\n      <div\r\n        style={{\r\n          float: \"left\",\r\n          fontFamily: \"monospace\",\r\n          fontSize: \"10px\",\r\n          color: \"#C0C0C0\",\r\n          marginTop: \"8px\",\r\n          border: \"0px\",\r\n          width: \"20px\"\r\n        }}>\r\n          { props.worldline.id }\r\n      </div>\r\n      <input type=\"text\"\r\n        onBlur={(event) => props.on_rename(event.target.value)}\r\n        onChange={(event) => setState(event.target.value)}\r\n        value={state}\r\n        style={{\r\n          float: \"left\",\r\n          marginTop: \"5px\",\r\n          fontFamily: \"monospace\",\r\n          color: \"white\",\r\n          backgroundColor: \"#666\",\r\n          border: \"0px\",\r\n          width: \"40px\"\r\n        }} />\r\n      <div style={{\r\n        backgroundColor: props.worldline.color,\r\n        float: \"left\",\r\n        marginTop: \"5px\",\r\n        border: \"0px\",\r\n        padding: \"0px\",\r\n        width: \"16px\",\r\n        height: \"18px\",\r\n      }} >\r\n        <input type=\"color\"\r\n          value={props.worldline.color}\r\n          onChange={(event) => props.on_recolor(event.target.value)}\r\n          style={{\r\n            float: \"left\",\r\n            opacity: \"0\",\r\n            marginTop: \"5px\",\r\n            border: \"0px\",\r\n            padding: \"0px\",\r\n            width: \"16px\",\r\n            height: \"16px\",\r\n          }} />\r\n      </div>\r\n    </div >)\r\n\r\n}\r\n\r\nexport default Worldline","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\n\r\nimport { Card, CardContent } from '@material-ui/core'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport AddIcon from '@material-ui/icons/Add'\r\nimport Button from '@material-ui/core/Button'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../../index'\r\n\r\nimport { Worldline_t } from '../model'\r\nimport * as selectors from '../selectors'\r\nimport { actions } from '../actions'\r\nimport { saga_actions } from '../sagas'\r\n\r\nimport { saga_actions as annotation_window_saga_actions }\r\n  from '../../annotation_window'\r\n\r\nimport Worldline from './Worldline'\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    state: selectors.get_state(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    actions: bindActionCreators({ ...actions }, dispatch),\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n    set_selected_worldline: bindActionCreators(\r\n      annotation_window_saga_actions.set_selected_worldline, dispatch\r\n    )\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype WorldlinesPanel_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\nconst _WorldlinesPanel = (props: WorldlinesPanel_props_t) => {\r\n\r\n  const worldlines = (Object.values(props.state.worldlines)).map(\r\n    (x: Worldline_t) =>\r\n      <Worldline key={x.id}\r\n        worldline={x}\r\n        on_check={(checked) => {\r\n          props.actions.update_worldline_local({\r\n            id: x.id,\r\n            visible: checked\r\n          })\r\n          if (checked)\r\n            props.set_selected_worldline(x.id)\r\n        }}\r\n        on_rename={(new_name) =>\r\n          props.saga_actions.update_worldline({\r\n            id: x.id,\r\n            name: new_name\r\n          })}\r\n        on_recolor={(new_color) =>\r\n          props.saga_actions.update_worldline({\r\n            id: x.id,\r\n            color: new_color\r\n          })}\r\n      />)\r\n\r\n  return (\r\n    <Card\r\n      elevation={3}\r\n      variant=\"outlined\"\r\n      square\r\n      style={{\r\n        position: \"absolute\",\r\n        left: props.left,\r\n        top: props.top,\r\n        width: \"340px\",\r\n        height: \"auto\"\r\n      }}>\r\n      <CardContent>\r\n        <h3>Tracks:</h3>\r\n\r\n        <Button\r\n          color=\"default\"\r\n          onClick={(event) => props.saga_actions.set_all_visible(true)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"90px\",\r\n            top: \"28px\"\r\n          }}>\r\n          all\r\n        </Button>\r\n        <Button\r\n          color=\"default\"\r\n          onClick={(event) => props.saga_actions.set_all_visible(false)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"160px\",\r\n            top: \"28px\"\r\n          }}>\r\n          none\r\n        </Button>\r\n\r\n        {worldlines}\r\n\r\n        <IconButton\r\n          aria-label=\"add\"\r\n          onClick={() => props.saga_actions.create_worldline()}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"220px\",\r\n            top: \"25px\"\r\n          }}>\r\n          <AddIcon fontSize=\"small\" />\r\n        </IconButton>\r\n\r\n      </CardContent>\r\n    </Card>)\r\n\r\n}\r\n\r\nconst WorldlinesPanel = connector(_WorldlinesPanel)\r\nexport default WorldlinesPanel","import { call, put, putResolve, delay, select, takeEvery, takeLatest }\r\n  from 'redux-saga/effects'\r\nimport { createAction, PayloadAction } from '@reduxjs/toolkit'\r\n\r\nimport { actions, initialState } from './actions'\r\nimport * as api from '../api'\r\nimport { annotation_id_t } from '../annotations/model'\r\nimport { selectors } from './'\r\n\r\nimport { saga_actions as annotations_saga_actions } from '../annotations'\r\nimport { actions as worldlines_actions } from '../worldlines'\r\nimport { saga_actions as worldlines_saga_actions } from '../worldlines'\r\nimport { worldline_id_t } from '../worldlines/model'\r\nimport { selectors as annotations_selectors } from '../annotations'\r\nimport { selectors as worldlines_selectors } from '../worldlines'\r\nimport { get_annotations_state } from '../app/selectors'\r\n\r\nconst prefix = \"annotation_window/\"\r\n\r\nconst saga_action_types = {\r\n  fetch_state: prefix + \"fetch_state\",\r\n  set_selected_annotation: prefix + \"set_selected_annotation\",\r\n  set_selected_worldline: prefix + \"set_selected_worldline\",\r\n  center_on_current_annotation: prefix + \"center_on_current_annotation\",\r\n  adjust_t: prefix + \"adjust_t\",\r\n  click: prefix + \"click\",\r\n  doubleclick: prefix + \"doubleclick\",\r\n  save: prefix + \"save\",\r\n  load: prefix + \"load\",\r\n  rpc: prefix + \"rpc\",\r\n  rpc_from_key: prefix + \"rpc_from_key\",\r\n}\r\n\r\nexport type click_payload_t = {\r\n  x?: number,\r\n  y?: number,\r\n  z?: number,\r\n}\r\n\r\nexport const saga_actions = {\r\n\r\n  fetch_state: createAction(\r\n    saga_action_types.fetch_state),\r\n\r\n  set_selected_annotation: createAction<annotation_id_t | null>(\r\n    saga_action_types.set_selected_annotation),\r\n\r\n  set_selected_worldline: createAction<worldline_id_t | null>(\r\n    saga_action_types.set_selected_worldline),\r\n\r\n  center_on_current_annotation: createAction(\r\n    saga_action_types.center_on_current_annotation),\r\n\r\n  adjust_t: createAction<number>(\r\n    saga_action_types.adjust_t),\r\n\r\n  click: createAction<click_payload_t>(\r\n    saga_action_types.click),\r\n\r\n  doubleclick: createAction<click_payload_t>(\r\n    saga_action_types.doubleclick),\r\n\r\n  save: createAction(saga_action_types.save),\r\n\r\n  load: createAction(saga_action_types.load),\r\n\r\n  rpc: createAction<[number, string]>(saga_action_types.rpc),\r\n\r\n  rpc_from_key: createAction<string>(saga_action_types.rpc_from_key),\r\n\r\n}\r\n\r\nfunction* fetch_state() {\r\n\r\n  const meta = yield call(api.fetch_metadata)\r\n  const rpcs = yield call(api.fetch_rpcs)\r\n\r\n  const new_state = {\r\n    ...initialState,\r\n    shape_x: meta.shape_x,\r\n    shape_y: meta.shape_y,\r\n    shape_z: meta.shape_z,\r\n    shape_t: meta.shape_t,\r\n    scale_x: 700 / meta.shape_x,\r\n    scale_y: 700 / meta.shape_x,\r\n    scale_z: 120 / meta.shape_z,\r\n    rpc_list: rpcs.payload,\r\n  }\r\n\r\n  yield put(actions.set_state(new_state))\r\n}\r\n\r\nfunction* set_selected_annotation(\r\n  action: PayloadAction<annotation_id_t | null>) {\r\n\r\n  if (!action.payload) {\r\n    yield put(actions.set_selected_annotation_local(null))\r\n    yield put(actions.set_selected_worldline_local(null))\r\n  }\r\n\r\n  else {\r\n\r\n    const annotations = yield select(get_annotations_state)\r\n\r\n    const a = annotations[action.payload]\r\n\r\n    if (a === undefined) {\r\n      console.error(`Annotation ${action.payload} not found.`)\r\n      return\r\n    }\r\n\r\n    yield put(actions.set_selected_annotation_local(a.id))\r\n    if (a.worldline_id > 0) {\r\n      yield put(actions.set_selected_worldline_local(a.worldline_id))\r\n    }\r\n\r\n    yield put(saga_actions.center_on_current_annotation())\r\n  }\r\n}\r\n\r\nfunction* set_selected_worldline(\r\n  action: PayloadAction<worldline_id_t | null>) {\r\n\r\n  const new_id = action.payload\r\n\r\n  if (new_id == null) {\r\n    yield put(actions.set_selected_worldline_local(null))\r\n    return\r\n  }\r\n\r\n  const worldlines = yield select(worldlines_selectors.get_worldlines)\r\n\r\n  if (!worldlines[new_id]) {\r\n    window.alert(`Bad track: ${new_id}. Please select an existing one or `\r\n      + `create a new one.`)\r\n    return\r\n  }\r\n\r\n  yield put(actions.set_selected_worldline_local(new_id))\r\n  yield put(actions.set_selected_annotation_local(null))\r\n\r\n  if (new_id !== null)\r\n    yield put(worldlines_actions.update_worldline_local({\r\n      id: new_id,\r\n      visible: true,\r\n    }))\r\n\r\n  yield put(saga_actions.center_on_current_annotation())\r\n\r\n}\r\n\r\nfunction* center_on_current_annotation() {\r\n\r\n  const a = yield select(annotations_selectors.get_selected_annotation)\r\n\r\n  if (a !== null && a !== undefined)\r\n    yield put(actions.center_on_annotation(a))\r\n\r\n}\r\n\r\nfunction* adjust_t(action: PayloadAction<number>) {\r\n  const t_idx = yield select(selectors.get_t_idx)\r\n  yield put(actions.set_t_idx(t_idx + action.payload))\r\n}\r\n\r\nfunction* click(action: PayloadAction<click_payload_t>) {\r\n  if (action.payload.x)\r\n    yield put(actions.set_x(action.payload.x))\r\n  if (action.payload.y)\r\n    yield put(actions.set_y(action.payload.y))\r\n  if (action.payload.z)\r\n    yield put(actions.set_z(action.payload.z))\r\n}\r\n\r\nfunction* doubleclick(action: PayloadAction<click_payload_t>) {\r\n  yield put(saga_actions.click(action.payload))\r\n  yield put(annotations_saga_actions.insert_annotation_here())\r\n}\r\n\r\nfunction* save() {\r\n  yield call(api.save)\r\n}\r\n\r\nfunction* load() {\r\n  yield call(api.load)\r\n  yield put(annotations_saga_actions.get_annotations())\r\n  yield put(worldlines_saga_actions.get_worldlines())\r\n}\r\n\r\nfunction* rpc(action: PayloadAction<[number, string]>) {\r\n\r\n  const state = yield select(selectors.get_state)\r\n\r\n  const rpc = state.rpc_list[action.payload[0]]\r\n  const method = rpc.name\r\n  const arg = action.payload[1]\r\n\r\n  const result = yield call(api.rpc, method, arg, state)\r\n\r\n  console.log(result)\r\n\r\n  if (result.status === \"ok\") {\r\n    for (let action of result.callbacks) {\r\n      const try_int_payload = parseInt(action.payload)\r\n      if (String(try_int_payload) === action.payload)\r\n        action.payload = try_int_payload\r\n      yield putResolve(action)\r\n      yield delay(100)\r\n    }\r\n  }\r\n  else if (result.status === \"error\") {\r\n    window.alert(result.exception)\r\n    console.error(result.traceback)\r\n  }\r\n\r\n}\r\n\r\nfunction* rpc_from_key(action: PayloadAction<string>) {\r\n\r\n  const state = yield select(selectors.get_state)\r\n  const method_idx = state.rpc_keybindings[action.payload]\r\n  const arg = state.rpc_args[action.payload]\r\n\r\n  yield put(saga_actions.rpc([method_idx, arg]))\r\n}\r\n\r\n\r\nfunction* watch_fetch_state() {\r\n  yield takeLatest(saga_action_types.fetch_state, fetch_state)\r\n}\r\n\r\nfunction* watch_set_selected_annotation() {\r\n  yield takeLatest(saga_action_types.set_selected_annotation,\r\n    set_selected_annotation)\r\n}\r\n\r\nfunction* watch_set_selected_worldline() {\r\n  yield takeLatest(saga_action_types.set_selected_worldline,\r\n    set_selected_worldline)\r\n}\r\n\r\nfunction* watch_center_on_current_annotation() {\r\n  yield takeLatest(saga_action_types.center_on_current_annotation,\r\n    center_on_current_annotation)\r\n}\r\n\r\nfunction* watch_adjust_t() {\r\n  yield takeLatest(saga_action_types.adjust_t, adjust_t)\r\n}\r\n\r\n\r\nfunction* watch_click() {\r\n  yield takeLatest(saga_action_types.click, click)\r\n}\r\n\r\nfunction* watch_doubleclick() {\r\n  yield takeLatest(saga_action_types.doubleclick, doubleclick)\r\n}\r\n\r\nfunction* watch_save() {\r\n  yield takeLatest(saga_action_types.save, save)\r\n}\r\n\r\nfunction* watch_load() {\r\n  yield takeLatest(saga_action_types.load, load)\r\n}\r\n\r\nfunction* watch_rpc() {\r\n  yield takeEvery(saga_action_types.rpc, rpc)\r\n}\r\n\r\nfunction* watch_rpc_from_key() {\r\n  yield takeEvery(saga_action_types.rpc_from_key, rpc_from_key)\r\n}\r\n\r\n// These are the exported sagas.\r\nexport const sagas = [\r\n  watch_fetch_state,\r\n  watch_set_selected_annotation,\r\n  watch_set_selected_worldline,\r\n  watch_center_on_current_annotation,\r\n  watch_adjust_t,\r\n  watch_click,\r\n  watch_doubleclick,\r\n  watch_save,\r\n  watch_load,\r\n  watch_rpc,\r\n  watch_rpc_from_key,\r\n]","\r\nimport React from 'react'\r\n\r\ntype SimpleFormProps = {\r\n  name: string,\r\n  action: Function\r\n}\r\n\r\ntype ActionFormProps = SimpleFormProps & { input_parser: Function }\r\n\r\ntype ActionFormState = { value: string }\r\n\r\nexport class ActionForm extends\r\n  React.Component<ActionFormProps, ActionFormState>\r\n{\r\n\r\n  constructor(props: ActionFormProps) {\r\n    super(props);\r\n    this.state = { value: \"0\" }\r\n\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n\r\n  handleChange(event: any) {\r\n    this.setState({ value: event.target.value });\r\n  }\r\n\r\n  handleSubmit(event: any) {\r\n    this.props.action(this.props.input_parser(this.state.value))\r\n    event.preventDefault()\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <form onSubmit={this.handleSubmit}>\r\n        <input type=\"submit\" value={this.props.name} />\r\n        <input type=\"text\"\r\n          defaultValue={this.state.value}\r\n          onChange={this.handleChange} />\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\nexport const FloatForm = (props: SimpleFormProps) =>\r\n  <ActionForm {...props} input_parser={parseFloat} />","/* This file should provide an interface to visualize the state and dispatch\r\nactions. UI and styling should be minimal. */\r\n\r\nimport React from 'react'\r\nimport { connect } from \"react-redux\"\r\n//import { TextField, Button}  from '@material-ui/core';\r\n\r\nimport * as selectors from '../selectors'\r\nimport { actions } from '../actions'\r\nimport { saga_actions } from '../sagas'\r\nimport { State_t } from '../../app/model'\r\nimport { FloatForm } from '../../test_components/ActionForm'\r\n\r\nconst _Test = ({ state, x_idx, ...A }: any) => {\r\n\r\n  const derived_state = { x_idx }\r\n\r\n  const full_state = { bare_state: state, derived_state }\r\n\r\n  const state_json = JSON.stringify(full_state, null, 4);\r\n\r\n  return (\r\n    <div>\r\n      <pre><code>annotation_window: {state_json}</code></pre>\r\n\r\n      <br />\r\n\r\n      Simple Actions:\r\n      <FloatForm name=\"set_shape_x\" action={A.set_shape_x} />\r\n      <FloatForm name=\"set_x\" action={A.set_x} />\r\n      <FloatForm name=\"adjust_x\" action={A.adjust_x} />\r\n      <FloatForm name=\"set_scale_x\" action={A.set_scale_x} />\r\n\r\n      <br />\r\n\r\n      Async Actions:\r\n      <br />\r\n      <button onClick={() => A.fetch_state()}>fetch_state</button>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    state: selectors.get_state(state),\r\n    x_idx: selectors.get_x_idx(state)\r\n  }\r\n}\r\n\r\nconst AnnotationWindowTest =\r\n  connect(mapStateToProps, { ...actions, ...saga_actions })(_Test)\r\n\r\nexport default AnnotationWindowTest","import React, { Component } from 'react'\r\nimport { connect, ConnectedProps } from 'react-redux'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../..'\r\nimport { fetch_data_cache } from '../../api'\r\n\r\nimport { selectors } from '../'\r\nimport { apply_LUT } from '../helpers'\r\nimport { saga_actions, click_payload_t } from '../sagas'\r\nimport { AnnotationsSVG } from '../../annotations'\r\n\r\nimport { selectors as annotations_selectors } from '../../annotations'\r\n\r\nconst mapStateToProps_X = (state: State_t) => {\r\n  return {\r\n    height: selectors.get_shape_y(state),\r\n    width: selectors.get_shape_z(state),\r\n    height_scale: selectors.get_scale_y(state),\r\n    width_scale: selectors.get_scale_z(state),\r\n    data_url: selectors.get_x_url(state),\r\n    x: selectors.get_z(state),\r\n    y: selectors.get_y(state),\r\n    x_dim: \"z\",\r\n    y_dim: \"y\",\r\n    annotations: annotations_selectors.get_x_annotations(state),\r\n    fill_circles: selectors.get_fill_circles(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst mapStateToProps_Y = (state: State_t) => {\r\n  return {\r\n    height: selectors.get_shape_z(state),\r\n    width: selectors.get_shape_x(state),\r\n    height_scale: selectors.get_scale_z(state),\r\n    width_scale: selectors.get_scale_x(state),\r\n    data_url: selectors.get_y_url(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_z(state),\r\n    x_dim: \"x\",\r\n    y_dim: \"z\",\r\n    annotations: annotations_selectors.get_y_annotations(state),\r\n    fill_circles: selectors.get_fill_circles(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst mapStateToProps_Z = (state: State_t) => {\r\n  return {\r\n    height: selectors.get_shape_y(state),\r\n    width: selectors.get_shape_x(state),\r\n    height_scale: selectors.get_scale_y(state),\r\n    width_scale: selectors.get_scale_x(state),\r\n    data_url: selectors.get_z_url(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_y(state),\r\n    x_dim: \"x\",\r\n    y_dim: \"y\",\r\n    annotations: annotations_selectors.get_z_annotations(state),\r\n    fill_circles: selectors.get_fill_circles(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    select: (x: number) => dispatch(saga_actions.set_selected_annotation(x)),\r\n    deselect: () => dispatch(saga_actions.set_selected_annotation(null)),\r\n    click: (x: click_payload_t) => dispatch(saga_actions.click(x)),\r\n    doubleclick: (x: click_payload_t) =>\r\n      dispatch(saga_actions.doubleclick(x))\r\n  }\r\n}\r\n\r\nconst connector_X = connect(mapStateToProps_X, mapDispatchToProps)\r\nconst connector_Y = connect(mapStateToProps_Y, mapDispatchToProps)\r\nconst connector_Z = connect(mapStateToProps_Z, mapDispatchToProps)\r\n\r\ntype ReduxProps_t = ConnectedProps<typeof connector_X>\r\ntype AnnotationView_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\ntype AnnotationView_state_t = {\r\n  data: Uint8ClampedArray | null\r\n}\r\n\r\nclass AnnotationView\r\n  extends Component<AnnotationView_props_t, AnnotationView_state_t> {\r\n\r\n  state: AnnotationView_state_t\r\n  abort_controller: AbortController\r\n\r\n  constructor(props: AnnotationView_props_t) {\r\n    super(props)\r\n    this.abort_controller = new AbortController()\r\n    this.state = {\r\n      data: null,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetch_and_draw()\r\n  }\r\n\r\n  componentDidUpdate(prev_props: AnnotationView_props_t) {\r\n    if (this.props.data_url !== prev_props.data_url)\r\n      this.fetch_and_draw()\r\n    else if (this.props.LUT !== prev_props.LUT)\r\n      this.draw_to_canvas()\r\n  }\r\n\r\n  fetch_and_draw = () => {\r\n\r\n    this.abort_controller.abort()\r\n    this.abort_controller = new AbortController()\r\n\r\n    fetch_data_cache(this.props.data_url, this.abort_controller.signal)\r\n      .then(data => this.setState({ data }))\r\n      .then(this.draw_to_canvas)\r\n  }\r\n\r\n  draw_to_canvas = () => {\r\n\r\n    if ((this.state.data != null) &&\r\n      (this.props.width > 0) &&\r\n      (this.props.height > 0)) {\r\n\r\n      const LUTdata = apply_LUT(this.state.data, this.props.LUT)\r\n\r\n      const cvs = this.refs.canvas as HTMLCanvasElement\r\n      const ctx = cvs.getContext(\"2d\")\r\n\r\n      const iData = new ImageData(\r\n        LUTdata,\r\n        this.props.width,\r\n        this.props.height);\r\n\r\n      ctx?.putImageData(iData, 0, 0)\r\n\r\n    }\r\n  }\r\n\r\n  make_click_handler = (click_fn: any) => (event: React.MouseEvent) => {\r\n    const target = event.target as HTMLElement;\r\n    const dim = target.getBoundingClientRect();\r\n    const x_pixels = event.clientX - dim.left;\r\n    const y_pixels = event.clientY - dim.top;\r\n\r\n    const svg_width = this.props.width * this.props.width_scale\r\n    const svg_height = this.props.height * this.props.height_scale\r\n\r\n    const x_local = x_pixels / svg_width\r\n    const y_local = y_pixels / svg_height\r\n\r\n    click_fn({\r\n      [this.props.x_dim]: x_local,\r\n      [this.props.y_dim]: y_local\r\n    })\r\n\r\n  }\r\n\r\n  handle_click = this.make_click_handler(this.props.click)\r\n  handle_doubleclick = this.make_click_handler(this.props.doubleclick)\r\n\r\n  render() {\r\n\r\n    const svg_width = this.props.width * this.props.width_scale\r\n    const svg_height = this.props.height * this.props.height_scale\r\n\r\n    const hline =\r\n      <line\r\n        x1={0}\r\n        y1={this.props.y * svg_height}\r\n        x2={svg_width}\r\n        y2={this.props.y * svg_height}\r\n        strokeWidth=\"0.4\" stroke=\"grey\" />\r\n    const vline =\r\n      <line\r\n        x1={this.props.x * svg_width}\r\n        y1={0}\r\n        x2={this.props.x * svg_width}\r\n        y2={svg_height}\r\n        strokeWidth=\"0.4\" stroke=\"grey\" />\r\n\r\n    return (\r\n      <div style={{\r\n        position: \"relative\",\r\n        left: this.props.left,\r\n        top: this.props.top,\r\n        right: \"0px\",\r\n      }}>\r\n\r\n        <canvas ref=\"canvas\"\r\n          width={this.props.width}\r\n          height={this.props.height}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            top: \"0px\",\r\n            zIndex: 1,\r\n            width: this.props.width * this.props.width_scale,\r\n            height: this.props.height * this.props.height_scale\r\n          }}>\r\n        </canvas>\r\n\r\n        <svg ref=\"svg\"\r\n          width={this.props.width * this.props.width_scale}\r\n          height={this.props.height * this.props.height_scale}\r\n          onClick={this.handle_click}\r\n          onDoubleClick={this.handle_doubleclick}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            top: \"0px\",\r\n            zIndex: 2,\r\n          }}>\r\n          <AnnotationsSVG\r\n            annotations={this.props.annotations}\r\n            size_x={this.props.width * this.props.width_scale}\r\n            size_y={this.props.height * this.props.height_scale}\r\n            select={this.props.select}\r\n            deselect={this.props.deselect}\r\n            fill_circles={this.props.fill_circles} />\r\n          {hline}\r\n          {vline}\r\n        </svg>\r\n      </div>)\r\n  }\r\n}\r\n\r\nexport const AnnotationViewX = connector_X(AnnotationView)\r\nexport const AnnotationViewY = connector_Y(AnnotationView)\r\nexport const AnnotationViewZ = connector_Z(AnnotationView)\r\n","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { createNextState } from '@reduxjs/toolkit'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\nimport { get } from 'lodash'\r\n\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Card from '@material-ui/core/Card'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport SaveIcon from '@material-ui/icons/Save'\r\nimport GetApp from '@material-ui/icons/GetApp'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport Select from '@material-ui/core/Select'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../../index'\r\nimport { AnnotationWindowState_t } from '../model'\r\nimport { actions, saga_actions, selectors } from '../'\r\n\r\nconst DocstringTooltip = withStyles({\r\n  tooltip: {\r\n    maxWidth: 600,\r\n    margin: 10,\r\n    padding: 10,\r\n    position: \"absolute\",\r\n    top: -50\r\n  }\r\n})(Tooltip)\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    window_state: selectors.get_state(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    actions: bindActionCreators({ ...actions }, dispatch),\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype WindowPanel_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\nconst _WindowPanel = (props: WindowPanel_props_t) => {\r\n\r\n  const [window_state, set_window_state] = React.useState(props.window_state)\r\n\r\n  React.useEffect(() => {\r\n    set_window_state({\r\n      ...props.window_state,\r\n      x: parseFloat(props.window_state.x.toFixed(3)),\r\n      y: parseFloat(props.window_state.y.toFixed(3)),\r\n      z: parseFloat(props.window_state.z.toFixed(3)),\r\n    });\r\n  },\r\n    [props.window_state])\r\n\r\n  const handle_change = (key: string, value: string) => {\r\n    const new_state = { ...(window_state), [key]: value }\r\n    set_window_state(new_state)\r\n  }\r\n\r\n  const handle_new_rpc_keybinding = (key: string, rpc_idx: number) => {\r\n\r\n    props.actions.set_rpc_keybinding([key, rpc_idx])\r\n\r\n    props.actions.set_rpc_arg([key,\r\n      window_state.rpc_list[rpc_idx].default_args])\r\n  }\r\n\r\n  const handle_rpc_arg_change = (key: string, value: string) => {\r\n\r\n    const rpc_idx = window_state.rpc_keybindings[key]\r\n\r\n    const nextState = createNextState(window_state, draft => {\r\n      draft.rpc_args[key] = value\r\n      draft.rpc_list[rpc_idx].default_args = value\r\n    })\r\n\r\n    set_window_state(nextState)\r\n  }\r\n\r\n\r\n  const update = () => {\r\n    props.actions.set_x(window_state.x)\r\n    props.actions.set_y(window_state.y)\r\n    props.actions.set_z(window_state.z)\r\n    props.actions.set_t_idx(window_state.t_idx)\r\n\r\n    const a = window_state.selected_annotation\r\n    if ((a === null) || String(a) === \"\") {\r\n      props.saga_actions.set_selected_annotation(null)\r\n    } else {\r\n      props.saga_actions.set_selected_annotation(Number(a))\r\n    }\r\n\r\n    const w = window_state.selected_worldline\r\n    if ((w === null) || String(w) === \"\") {\r\n      props.saga_actions.set_selected_worldline(null)\r\n    } else {\r\n      props.saga_actions.set_selected_worldline(Number(w))\r\n    }\r\n\r\n    props.actions.set_active_provenance(window_state.active_provenance)\r\n\r\n    props.actions.set_rpc_args(window_state.rpc_args)\r\n    props.actions.set_rpc_list(window_state.rpc_list)\r\n\r\n  }\r\n\r\n  const TF = (field: string, name: string) => {\r\n    const field_key = field as keyof AnnotationWindowState_t\r\n\r\n    return <TextField\r\n      type=\"string\"\r\n      label={name}\r\n      key={field_key}\r\n      value={window_state[field_key] !== null ? window_state[field_key] : \"\"}\r\n      onChange={(event) => handle_change(field_key, event.target.value)}\r\n      onBlur={update}\r\n      style={{\r\n        position: \"relative\",\r\n        width: \"80px\",\r\n        margin: \"10px\",\r\n      }}\r\n      InputLabelProps= {{style: { fontSize: 14 }}}\r\n      InputProps={{ style: { fontFamily: \"monospace\" } }}\r\n    />\r\n  }\r\n\r\n  const textfields = [\r\n    [\"x\", \"x\"],\r\n    [\"y\", \"y\"],\r\n    [\"z\", \"z\"],\r\n    [\"t_idx\", \"t\"],\r\n    [\"selected_annotation\", \"anno.\"],\r\n    [\"selected_worldline\", \"track\"],\r\n    [\"active_provenance\", \"prov\"]]\r\n    .map((x) => TF(x[0], x[1]))\r\n\r\n  const RPCKeyConfig = (keyname: string) => {\r\n\r\n    const rpc_idx = get(window_state.rpc_keybindings, keyname, 0)\r\n    const rpc = get(window_state.rpc_list, rpc_idx)\r\n    let docstring\r\n    if (rpc) {\r\n      docstring = get(rpc, \"docstring\", \"\")\r\n    } else {\r\n      docstring = \"\"\r\n    }\r\n\r\n    return (\r\n      <React.Fragment key={keyname}>\r\n        <DocstringTooltip\r\n          interactive\r\n          title={\r\n            <pre style={{ fontSize: 14 }} >\r\n              {docstring}\r\n            </pre>}\r\n          placement=\"right\"\r\n        >\r\n          <FormControl style={{\r\n            width: 810, margin: 10, top: 10, marginBottom: 50\r\n          }}>\r\n            <InputLabel id={`action-${keyname}-select-label`}>Key {keyname}\r\n            </InputLabel>\r\n            <Select\r\n              labelId={`action-${keyname}-select-label`}\r\n              id={`action-${keyname}-select`}\r\n              value={rpc_idx}\r\n              onChange={(event) => handle_new_rpc_keybinding(\r\n                keyname, Number(event.target.value))}\r\n              style={{\r\n                width: 250,\r\n                position: \"absolute\",\r\n                fontFamily: \"monospace\"\r\n              }}\r\n            >\r\n              {props.window_state.rpc_list.map((x, idx) =>\r\n                <MenuItem\r\n                  style={{ fontFamily: \"monospace\" }}\r\n                  value={idx}\r\n                  key={idx}>\r\n                  {x.name}\r\n                </MenuItem>\r\n              )}\r\n            </Select>\r\n            <TextField\r\n              type=\"string\"\r\n              label={\"arg\"}\r\n              value={window_state.rpc_args[keyname]}\r\n              onChange={(event) => handle_rpc_arg_change(\r\n                keyname, event.target.value)}\r\n              onBlur={update}\r\n              style={{\r\n                position: \"absolute\",\r\n                left: 300,\r\n                width: 400,\r\n              }}\r\n              InputProps={{ style: { fontFamily: \"monospace\" } }}\r\n            />\r\n          </FormControl>\r\n        </DocstringTooltip>\r\n      </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rpc_keys = \"1234567890\".split(\"\").map(RPCKeyConfig)\r\n\r\n  return (\r\n    <Card\r\n      elevation={3}\r\n      variant=\"outlined\"\r\n      square\r\n      style={{\r\n        position: \"absolute\",\r\n        left: props.left,\r\n        top: props.top,\r\n        width: \"840px\",\r\n        height: \"1000px\"\r\n      }}>\r\n      <CardContent>\r\n        <h3>Annotation Window</h3>\r\n\r\n        <Tooltip title=\"Load from disk\">\r\n          <IconButton\r\n            aria-label=\"load\"\r\n            onClick={() => props.saga_actions.load()}\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"650px\",\r\n              top: \"5px\"\r\n            }}>\r\n            <GetApp fontSize=\"small\" />\r\n          </IconButton>\r\n        </Tooltip>\r\n\r\n        <Tooltip title=\"Save to disk\">\r\n          <IconButton\r\n            aria-label=\"save\"\r\n            onClick={() => props.saga_actions.save()}\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"700px\",\r\n              top: \"5px\"\r\n            }}>\r\n            <SaveIcon fontSize=\"small\" />\r\n          </IconButton>\r\n        </Tooltip>\r\n\r\n        {textfields}\r\n\r\n        <Tooltip title=\"Keyboard shortcut: o\">\r\n          <div style={{width:150, float: \"left\"}}>\r\n            <input type=\"checkbox\"\r\n              checked={props.window_state.fill_circles}\r\n              id=\"fill-circles-cb\"\r\n              onChange={(event) =>\r\n                props.actions.set_fill_circles(event.target.checked)}\r\n              style={{\r\n                // float: \"left\",\r\n                marginTop: \"30px\"\r\n              }} />\r\n            <label>Fill circles</label>\r\n          </div>\r\n        </Tooltip>\r\n\r\n        <Tooltip title=\"Keyboard shortcut: a\">\r\n          <div style={{width:150, float: \"left\"}}>\r\n            <input type=\"checkbox\"\r\n              checked={props.window_state.show_all_annotations}\r\n              id=\"all-annotations-cb\"\r\n              onChange={(event) =>\r\n                props.actions.set_show_all_annotations(event.target.checked)}\r\n              style={{\r\n                // float: \"left\",\r\n                marginTop: \"30px\"\r\n              }} />\r\n            <label>Show all</label>\r\n          </div>\r\n        </Tooltip>\r\n\r\n\r\n        {rpc_keys}\r\n\r\n      </CardContent>\r\n    </Card>)\r\n}\r\n\r\nconst WindowPanel = connector(_WindowPanel)\r\nexport default WindowPanel","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\r\n\r\n// Configuration Constants\r\nexport const EPSILON = 0.000001;\r\nexport let ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\r\nexport const RANDOM = Math.random;\r\n\r\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\r\nexport function setMatrixArrayType(type) {\r\n  ARRAY_TYPE = type;\r\n}\r\n\r\nconst degree = Math.PI / 180;\r\n\r\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\r\nexport function toRadian(a) {\r\n  return a * degree;\r\n}\r\n\r\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  return Math.abs(a - b) <= EPSILON*Math.max(1.0, Math.abs(a), Math.abs(b));\r\n}\r\n\r\nif (!Math.hypot) Math.hypot = function() {\r\n  var y = 0, i = arguments.length;\r\n  while (i--) y += arguments[i] * arguments[i];\r\n  return Math.sqrt(y);\r\n};\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\r\n\r\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[5] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[4] = 1;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\r\nexport function fromMat4(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[4];\r\n  out[4] = a[5];\r\n  out[5] = a[6];\r\n  out[6] = a[8];\r\n  out[7] = a[9];\r\n  out[8] = a[10];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\r\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m10;\r\n  out[4] = m11;\r\n  out[5] = m12;\r\n  out[6] = m20;\r\n  out[7] = m21;\r\n  out[8] = m22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\r\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m10;\r\n  out[4] = m11;\r\n  out[5] = m12;\r\n  out[6] = m20;\r\n  out[7] = m21;\r\n  out[8] = m22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 1;\r\n  out[5] = 0;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function transpose(out, a) {\r\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n  if (out === a) {\r\n    let a01 = a[1],\r\n      a02 = a[2],\r\n      a12 = a[5];\r\n    out[1] = a[3];\r\n    out[2] = a[6];\r\n    out[3] = a01;\r\n    out[5] = a[7];\r\n    out[6] = a02;\r\n    out[7] = a12;\r\n  } else {\r\n    out[0] = a[0];\r\n    out[1] = a[3];\r\n    out[2] = a[6];\r\n    out[3] = a[1];\r\n    out[4] = a[4];\r\n    out[5] = a[7];\r\n    out[6] = a[2];\r\n    out[7] = a[5];\r\n    out[8] = a[8];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function invert(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  let b01 = a22 * a11 - a12 * a21;\r\n  let b11 = -a22 * a10 + a12 * a20;\r\n  let b21 = a21 * a10 - a11 * a20;\r\n\r\n  // Calculate the determinant\r\n  let det = a00 * b01 + a01 * b11 + a02 * b21;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = b01 * det;\r\n  out[1] = (-a22 * a01 + a02 * a21) * det;\r\n  out[2] = (a12 * a01 - a02 * a11) * det;\r\n  out[3] = b11 * det;\r\n  out[4] = (a22 * a00 - a02 * a20) * det;\r\n  out[5] = (-a12 * a00 + a02 * a10) * det;\r\n  out[6] = b21 * det;\r\n  out[7] = (-a21 * a00 + a01 * a20) * det;\r\n  out[8] = (a11 * a00 - a01 * a10) * det;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function adjoint(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  out[0] = a11 * a22 - a12 * a21;\r\n  out[1] = a02 * a21 - a01 * a22;\r\n  out[2] = a01 * a12 - a02 * a11;\r\n  out[3] = a12 * a20 - a10 * a22;\r\n  out[4] = a00 * a22 - a02 * a20;\r\n  out[5] = a02 * a10 - a00 * a12;\r\n  out[6] = a10 * a21 - a11 * a20;\r\n  out[7] = a01 * a20 - a00 * a21;\r\n  out[8] = a00 * a11 - a01 * a10;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  return (\r\n    a00 * (a22 * a11 - a12 * a21) +\r\n    a01 * (-a22 * a10 + a12 * a20) +\r\n    a02 * (a21 * a10 - a11 * a20)\r\n  );\r\n}\r\n\r\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  let b00 = b[0],\r\n    b01 = b[1],\r\n    b02 = b[2];\r\n  let b10 = b[3],\r\n    b11 = b[4],\r\n    b12 = b[5];\r\n  let b20 = b[6],\r\n    b21 = b[7],\r\n    b22 = b[8];\r\n\r\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\r\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\r\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\r\n\r\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\r\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\r\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\r\n\r\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\r\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\r\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\r\nexport function translate(out, a, v) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5],\r\n    a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8],\r\n    x = v[0],\r\n    y = v[1];\r\n\r\n  out[0] = a00;\r\n  out[1] = a01;\r\n  out[2] = a02;\r\n\r\n  out[3] = a10;\r\n  out[4] = a11;\r\n  out[5] = a12;\r\n\r\n  out[6] = x * a00 + y * a10 + a20;\r\n  out[7] = x * a01 + y * a11 + a21;\r\n  out[8] = x * a02 + y * a12 + a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\r\nexport function rotate(out, a, rad) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5],\r\n    a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8],\r\n    s = Math.sin(rad),\r\n    c = Math.cos(rad);\r\n\r\n  out[0] = c * a00 + s * a10;\r\n  out[1] = c * a01 + s * a11;\r\n  out[2] = c * a02 + s * a12;\r\n\r\n  out[3] = c * a10 - s * a00;\r\n  out[4] = c * a11 - s * a01;\r\n  out[5] = c * a12 - s * a02;\r\n\r\n  out[6] = a20;\r\n  out[7] = a21;\r\n  out[8] = a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let x = v[0],\r\n    y = v[1];\r\n\r\n  out[0] = x * a[0];\r\n  out[1] = x * a[1];\r\n  out[2] = x * a[2];\r\n\r\n  out[3] = y * a[3];\r\n  out[4] = y * a[4];\r\n  out[5] = y * a[5];\r\n\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\r\nexport function fromTranslation(out, v) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 1;\r\n  out[5] = 0;\r\n  out[6] = v[0];\r\n  out[7] = v[1];\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\r\nexport function fromRotation(out, rad) {\r\n  let s = Math.sin(rad),\r\n    c = Math.cos(rad);\r\n\r\n  out[0] = c;\r\n  out[1] = s;\r\n  out[2] = 0;\r\n\r\n  out[3] = -s;\r\n  out[4] = c;\r\n  out[5] = 0;\r\n\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n\r\n  out[3] = 0;\r\n  out[4] = v[1];\r\n  out[5] = 0;\r\n\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\r\nexport function fromMat2d(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = 0;\r\n\r\n  out[3] = a[2];\r\n  out[4] = a[3];\r\n  out[5] = 0;\r\n\r\n  out[6] = a[4];\r\n  out[7] = a[5];\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\r\nexport function fromQuat(out, q) {\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let yx = y * x2;\r\n  let yy = y * y2;\r\n  let zx = z * x2;\r\n  let zy = z * y2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - yy - zz;\r\n  out[3] = yx - wz;\r\n  out[6] = zx + wy;\r\n\r\n  out[1] = yx + wz;\r\n  out[4] = 1 - xx - zz;\r\n  out[7] = zy - wx;\r\n\r\n  out[2] = zx - wy;\r\n  out[5] = zy + wx;\r\n  out[8] = 1 - xx - yy;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\r\nexport function normalFromMat4(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  // Calculate the determinant\r\n  let det =\r\n    b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n\r\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n\r\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\r\nexport function projection(out, width, height) {\r\n  out[0] = 2 / width;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = -2 / height;\r\n  out[5] = 0;\r\n  out[6] = -1;\r\n  out[7] = 1;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return (\r\n    \"mat3(\" +\r\n    a[0] +\r\n    \", \" +\r\n    a[1] +\r\n    \", \" +\r\n    a[2] +\r\n    \", \" +\r\n    a[3] +\r\n    \", \" +\r\n    a[4] +\r\n    \", \" +\r\n    a[5] +\r\n    \", \" +\r\n    a[6] +\r\n    \", \" +\r\n    a[7] +\r\n    \", \" +\r\n    a[8] +\r\n    \")\"\r\n  );\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\r\n}\r\n\r\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  out[6] = a[6] + b[6];\r\n  out[7] = a[7] + b[7];\r\n  out[8] = a[8] + b[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  out[4] = a[4] - b[4];\r\n  out[5] = a[5] - b[5];\r\n  out[6] = a[6] - b[6];\r\n  out[7] = a[7] - b[7];\r\n  out[8] = a[8] - b[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  out[6] = a[6] * b;\r\n  out[7] = a[7] * b;\r\n  out[8] = a[8] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  out[3] = a[3] + b[3] * scale;\r\n  out[4] = a[4] + b[4] * scale;\r\n  out[5] = a[5] + b[5] * scale;\r\n  out[6] = a[6] + b[6] * scale;\r\n  out[7] = a[7] + b[7] * scale;\r\n  out[8] = a[8] + b[8] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return (\r\n    a[0] === b[0] &&\r\n    a[1] === b[1] &&\r\n    a[2] === b[2] &&\r\n    a[3] === b[3] &&\r\n    a[4] === b[4] &&\r\n    a[5] === b[5] &&\r\n    a[6] === b[6] &&\r\n    a[7] === b[7] &&\r\n    a[8] === b[8]\r\n  );\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3],\r\n    a4 = a[4],\r\n    a5 = a[5],\r\n    a6 = a[6],\r\n    a7 = a[7],\r\n    a8 = a[8];\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3],\r\n    b4 = b[4],\r\n    b5 = b[5],\r\n    b6 = b[6],\r\n    b7 = b[7],\r\n    b8 = b[8];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n    Math.abs(a3 - b3) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n    Math.abs(a4 - b4) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n    Math.abs(a5 - b5) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\r\n    Math.abs(a6 - b6) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\r\n    Math.abs(a7 - b7) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\r\n    Math.abs(a8 - b8) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\r\n\r\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[11] = 0;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[5] = 1;\r\n  out[10] = 1;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  out[9] = a[9];\r\n  out[10] = a[10];\r\n  out[11] = a[11];\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  out[9] = a[9];\r\n  out[10] = a[10];\r\n  out[11] = a[11];\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\r\nexport function fromValues(\r\n  m00,\r\n  m01,\r\n  m02,\r\n  m03,\r\n  m10,\r\n  m11,\r\n  m12,\r\n  m13,\r\n  m20,\r\n  m21,\r\n  m22,\r\n  m23,\r\n  m30,\r\n  m31,\r\n  m32,\r\n  m33\r\n) {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m03;\r\n  out[4] = m10;\r\n  out[5] = m11;\r\n  out[6] = m12;\r\n  out[7] = m13;\r\n  out[8] = m20;\r\n  out[9] = m21;\r\n  out[10] = m22;\r\n  out[11] = m23;\r\n  out[12] = m30;\r\n  out[13] = m31;\r\n  out[14] = m32;\r\n  out[15] = m33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\r\nexport function set(\r\n  out,\r\n  m00,\r\n  m01,\r\n  m02,\r\n  m03,\r\n  m10,\r\n  m11,\r\n  m12,\r\n  m13,\r\n  m20,\r\n  m21,\r\n  m22,\r\n  m23,\r\n  m30,\r\n  m31,\r\n  m32,\r\n  m33\r\n) {\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m03;\r\n  out[4] = m10;\r\n  out[5] = m11;\r\n  out[6] = m12;\r\n  out[7] = m13;\r\n  out[8] = m20;\r\n  out[9] = m21;\r\n  out[10] = m22;\r\n  out[11] = m23;\r\n  out[12] = m30;\r\n  out[13] = m31;\r\n  out[14] = m32;\r\n  out[15] = m33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function transpose(out, a) {\r\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n  if (out === a) {\r\n    let a01 = a[1],\r\n      a02 = a[2],\r\n      a03 = a[3];\r\n    let a12 = a[6],\r\n      a13 = a[7];\r\n    let a23 = a[11];\r\n\r\n    out[1] = a[4];\r\n    out[2] = a[8];\r\n    out[3] = a[12];\r\n    out[4] = a01;\r\n    out[6] = a[9];\r\n    out[7] = a[13];\r\n    out[8] = a02;\r\n    out[9] = a12;\r\n    out[11] = a[14];\r\n    out[12] = a03;\r\n    out[13] = a13;\r\n    out[14] = a23;\r\n  } else {\r\n    out[0] = a[0];\r\n    out[1] = a[4];\r\n    out[2] = a[8];\r\n    out[3] = a[12];\r\n    out[4] = a[1];\r\n    out[5] = a[5];\r\n    out[6] = a[9];\r\n    out[7] = a[13];\r\n    out[8] = a[2];\r\n    out[9] = a[6];\r\n    out[10] = a[10];\r\n    out[11] = a[14];\r\n    out[12] = a[3];\r\n    out[13] = a[7];\r\n    out[14] = a[11];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function invert(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  // Calculate the determinant\r\n  let det =\r\n    b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\r\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\r\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\r\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\r\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\r\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\r\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function adjoint(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  out[0] = a11 * b11 - a12 * b10 + a13 * b09;\r\n  out[1] = a02 * b10 - a01 * b11 - a03 * b09;\r\n  out[2] = a31 * b05 - a32 * b04 + a33 * b03;\r\n  out[3] = a22 * b04 - a21 * b05 - a23 * b03;\r\n  out[4] = a12 * b08 - a10 * b11 - a13 * b07;\r\n  out[5] = a00 * b11 - a02 * b08 + a03 * b07;\r\n  out[6] = a32 * b02 - a30 * b05 - a33 * b01;\r\n  out[7] = a20 * b05 - a22 * b02 + a23 * b01;\r\n  out[8] = a10 * b10 - a11 * b08 + a13 * b06;\r\n  out[9] = a01 * b08 - a00 * b10 - a03 * b06;\r\n  out[10] = a30 * b04 - a31 * b02 + a33 * b00;\r\n  out[11] = a21 * b02 - a20 * b04 - a23 * b00;\r\n  out[12] = a11 * b07 - a10 * b09 - a12 * b06;\r\n  out[13] = a00 * b09 - a01 * b07 + a02 * b06;\r\n  out[14] = a31 * b01 - a30 * b03 - a32 * b00;\r\n  out[15] = a20 * b03 - a21 * b01 + a22 * b00;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b0 = a00 * a11 - a01 * a10;\r\n  let b1 = a00 * a12 - a02 * a10;\r\n  let b2 = a01 * a12 - a02 * a11;\r\n  let b3 = a20 * a31 - a21 * a30;\r\n  let b4 = a20 * a32 - a22 * a30;\r\n  let b5 = a21 * a32 - a22 * a31;\r\n  let b6 = a00 * b5 - a01 * b4 + a02 * b3;\r\n  let b7 = a10 * b5 - a11 * b4 + a12 * b3;\r\n  let b8 = a20 * b2 - a21 * b1 + a22 * b0;\r\n  let b9 = a30 * b2 - a31 * b1 + a32 * b0;\r\n\r\n  // Calculate the determinant\r\n  return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\r\n}\r\n\r\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  // Cache only the current line of the second matrix\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3];\r\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n\r\n  b0 = b[4];\r\n  b1 = b[5];\r\n  b2 = b[6];\r\n  b3 = b[7];\r\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n\r\n  b0 = b[8];\r\n  b1 = b[9];\r\n  b2 = b[10];\r\n  b3 = b[11];\r\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n\r\n  b0 = b[12];\r\n  b1 = b[13];\r\n  b2 = b[14];\r\n  b3 = b[15];\r\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\r\nexport function translate(out, a, v) {\r\n  let x = v[0],\r\n    y = v[1],\r\n    z = v[2];\r\n  let a00, a01, a02, a03;\r\n  let a10, a11, a12, a13;\r\n  let a20, a21, a22, a23;\r\n\r\n  if (a === out) {\r\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\r\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\r\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\r\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\r\n  } else {\r\n    a00 = a[0];\r\n    a01 = a[1];\r\n    a02 = a[2];\r\n    a03 = a[3];\r\n    a10 = a[4];\r\n    a11 = a[5];\r\n    a12 = a[6];\r\n    a13 = a[7];\r\n    a20 = a[8];\r\n    a21 = a[9];\r\n    a22 = a[10];\r\n    a23 = a[11];\r\n\r\n    out[0] = a00;\r\n    out[1] = a01;\r\n    out[2] = a02;\r\n    out[3] = a03;\r\n    out[4] = a10;\r\n    out[5] = a11;\r\n    out[6] = a12;\r\n    out[7] = a13;\r\n    out[8] = a20;\r\n    out[9] = a21;\r\n    out[10] = a22;\r\n    out[11] = a23;\r\n\r\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\r\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\r\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\r\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let x = v[0],\r\n    y = v[1],\r\n    z = v[2];\r\n\r\n  out[0] = a[0] * x;\r\n  out[1] = a[1] * x;\r\n  out[2] = a[2] * x;\r\n  out[3] = a[3] * x;\r\n  out[4] = a[4] * y;\r\n  out[5] = a[5] * y;\r\n  out[6] = a[6] * y;\r\n  out[7] = a[7] * y;\r\n  out[8] = a[8] * z;\r\n  out[9] = a[9] * z;\r\n  out[10] = a[10] * z;\r\n  out[11] = a[11] * z;\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\r\nexport function rotate(out, a, rad, axis) {\r\n  let x = axis[0],\r\n    y = axis[1],\r\n    z = axis[2];\r\n  let len = Math.hypot(x, y, z);\r\n  let s, c, t;\r\n  let a00, a01, a02, a03;\r\n  let a10, a11, a12, a13;\r\n  let a20, a21, a22, a23;\r\n  let b00, b01, b02;\r\n  let b10, b11, b12;\r\n  let b20, b21, b22;\r\n\r\n  if (len < glMatrix.EPSILON) {\r\n    return null;\r\n  }\r\n\r\n  len = 1 / len;\r\n  x *= len;\r\n  y *= len;\r\n  z *= len;\r\n\r\n  s = Math.sin(rad);\r\n  c = Math.cos(rad);\r\n  t = 1 - c;\r\n\r\n  a00 = a[0];\r\n  a01 = a[1];\r\n  a02 = a[2];\r\n  a03 = a[3];\r\n  a10 = a[4];\r\n  a11 = a[5];\r\n  a12 = a[6];\r\n  a13 = a[7];\r\n  a20 = a[8];\r\n  a21 = a[9];\r\n  a22 = a[10];\r\n  a23 = a[11];\r\n\r\n  // Construct the elements of the rotation matrix\r\n  b00 = x * x * t + c;\r\n  b01 = y * x * t + z * s;\r\n  b02 = z * x * t - y * s;\r\n  b10 = x * y * t - z * s;\r\n  b11 = y * y * t + c;\r\n  b12 = z * y * t + x * s;\r\n  b20 = x * z * t + y * s;\r\n  b21 = y * z * t - x * s;\r\n  b22 = z * z * t + c;\r\n\r\n  // Perform rotation-specific matrix multiplication\r\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\r\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\r\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\r\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\r\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\r\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\r\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\r\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\r\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\r\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\r\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\r\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged last row\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateX(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a10 = a[4];\r\n  let a11 = a[5];\r\n  let a12 = a[6];\r\n  let a13 = a[7];\r\n  let a20 = a[8];\r\n  let a21 = a[9];\r\n  let a22 = a[10];\r\n  let a23 = a[11];\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged rows\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[4] = a10 * c + a20 * s;\r\n  out[5] = a11 * c + a21 * s;\r\n  out[6] = a12 * c + a22 * s;\r\n  out[7] = a13 * c + a23 * s;\r\n  out[8] = a20 * c - a10 * s;\r\n  out[9] = a21 * c - a11 * s;\r\n  out[10] = a22 * c - a12 * s;\r\n  out[11] = a23 * c - a13 * s;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateY(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a00 = a[0];\r\n  let a01 = a[1];\r\n  let a02 = a[2];\r\n  let a03 = a[3];\r\n  let a20 = a[8];\r\n  let a21 = a[9];\r\n  let a22 = a[10];\r\n  let a23 = a[11];\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged rows\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    out[6] = a[6];\r\n    out[7] = a[7];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = a00 * c - a20 * s;\r\n  out[1] = a01 * c - a21 * s;\r\n  out[2] = a02 * c - a22 * s;\r\n  out[3] = a03 * c - a23 * s;\r\n  out[8] = a00 * s + a20 * c;\r\n  out[9] = a01 * s + a21 * c;\r\n  out[10] = a02 * s + a22 * c;\r\n  out[11] = a03 * s + a23 * c;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateZ(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a00 = a[0];\r\n  let a01 = a[1];\r\n  let a02 = a[2];\r\n  let a03 = a[3];\r\n  let a10 = a[4];\r\n  let a11 = a[5];\r\n  let a12 = a[6];\r\n  let a13 = a[7];\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged last row\r\n    out[8] = a[8];\r\n    out[9] = a[9];\r\n    out[10] = a[10];\r\n    out[11] = a[11];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = a00 * c + a10 * s;\r\n  out[1] = a01 * c + a11 * s;\r\n  out[2] = a02 * c + a12 * s;\r\n  out[3] = a03 * c + a13 * s;\r\n  out[4] = a10 * c - a00 * s;\r\n  out[5] = a11 * c - a01 * s;\r\n  out[6] = a12 * c - a02 * s;\r\n  out[7] = a13 * c - a03 * s;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromTranslation(out, v) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = v[1];\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = v[2];\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotation(out, rad, axis) {\r\n  let x = axis[0],\r\n    y = axis[1],\r\n    z = axis[2];\r\n  let len = Math.hypot(x, y, z);\r\n  let s, c, t;\r\n\r\n  if (len < glMatrix.EPSILON) {\r\n    return null;\r\n  }\r\n\r\n  len = 1 / len;\r\n  x *= len;\r\n  y *= len;\r\n  z *= len;\r\n\r\n  s = Math.sin(rad);\r\n  c = Math.cos(rad);\r\n  t = 1 - c;\r\n\r\n  // Perform rotation-specific matrix multiplication\r\n  out[0] = x * x * t + c;\r\n  out[1] = y * x * t + z * s;\r\n  out[2] = z * x * t - y * s;\r\n  out[3] = 0;\r\n  out[4] = x * y * t - z * s;\r\n  out[5] = y * y * t + c;\r\n  out[6] = z * y * t + x * s;\r\n  out[7] = 0;\r\n  out[8] = x * z * t + y * s;\r\n  out[9] = y * z * t - x * s;\r\n  out[10] = z * z * t + c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromXRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = c;\r\n  out[6] = s;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = -s;\r\n  out[10] = c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromYRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = c;\r\n  out[1] = 0;\r\n  out[2] = -s;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = s;\r\n  out[9] = 0;\r\n  out[10] = c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromZRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = c;\r\n  out[1] = s;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = -s;\r\n  out[5] = c;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslation(out, q, v) {\r\n  // Quaternion math\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - (yy + zz);\r\n  out[1] = xy + wz;\r\n  out[2] = xz - wy;\r\n  out[3] = 0;\r\n  out[4] = xy - wz;\r\n  out[5] = 1 - (xx + zz);\r\n  out[6] = yz + wx;\r\n  out[7] = 0;\r\n  out[8] = xz + wy;\r\n  out[9] = yz - wx;\r\n  out[10] = 1 - (xx + yy);\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\r\nexport function fromQuat2(out, a) {\r\n  let translation = new glMatrix.ARRAY_TYPE(3);\r\n  let bx = -a[0],\r\n    by = -a[1],\r\n    bz = -a[2],\r\n    bw = a[3],\r\n    ax = a[4],\r\n    ay = a[5],\r\n    az = a[6],\r\n    aw = a[7];\r\n\r\n  let magnitude = bx * bx + by * by + bz * bz + bw * bw;\r\n  //Only scale if it makes sense\r\n  if (magnitude > 0) {\r\n    translation[0] = ((ax * bw + aw * bx + ay * bz - az * by) * 2) / magnitude;\r\n    translation[1] = ((ay * bw + aw * by + az * bx - ax * bz) * 2) / magnitude;\r\n    translation[2] = ((az * bw + aw * bz + ax * by - ay * bx) * 2) / magnitude;\r\n  } else {\r\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\r\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\r\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\r\n  }\r\n  fromRotationTranslation(out, a, translation);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\r\nexport function getTranslation(out, mat) {\r\n  out[0] = mat[12];\r\n  out[1] = mat[13];\r\n  out[2] = mat[14];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\r\nexport function getScaling(out, mat) {\r\n  let m11 = mat[0];\r\n  let m12 = mat[1];\r\n  let m13 = mat[2];\r\n  let m21 = mat[4];\r\n  let m22 = mat[5];\r\n  let m23 = mat[6];\r\n  let m31 = mat[8];\r\n  let m32 = mat[9];\r\n  let m33 = mat[10];\r\n\r\n  out[0] = Math.hypot(m11, m12, m13);\r\n  out[1] = Math.hypot(m21, m22, m23);\r\n  out[2] = Math.hypot(m31, m32, m33);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\r\nexport function getRotation(out, mat) {\r\n  let scaling = new glMatrix.ARRAY_TYPE(3);\r\n  getScaling(scaling, mat);\r\n\r\n  let is1 = 1 / scaling[0];\r\n  let is2 = 1 / scaling[1];\r\n  let is3 = 1 / scaling[2];\r\n\r\n  let sm11 = mat[0] * is1;\r\n  let sm12 = mat[1] * is2;\r\n  let sm13 = mat[2] * is3;\r\n  let sm21 = mat[4] * is1;\r\n  let sm22 = mat[5] * is2;\r\n  let sm23 = mat[6] * is3;\r\n  let sm31 = mat[8] * is1;\r\n  let sm32 = mat[9] * is2;\r\n  let sm33 = mat[10] * is3;\r\n\r\n  let trace = sm11 + sm22 + sm33;\r\n  let S = 0;\r\n\r\n  if (trace > 0) {\r\n    S = Math.sqrt(trace + 1.0) * 2;\r\n    out[3] = 0.25 * S;\r\n    out[0] = (sm23 - sm32) / S;\r\n    out[1] = (sm31 - sm13) / S;\r\n    out[2] = (sm12 - sm21) / S;\r\n  } else if (sm11 > sm22 && sm11 > sm33) {\r\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\r\n    out[3] = (sm23 - sm32) / S;\r\n    out[0] = 0.25 * S;\r\n    out[1] = (sm12 + sm21) / S;\r\n    out[2] = (sm31 + sm13) / S;\r\n  } else if (sm22 > sm33) {\r\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\r\n    out[3] = (sm31 - sm13) / S;\r\n    out[0] = (sm12 + sm21) / S;\r\n    out[1] = 0.25 * S;\r\n    out[2] = (sm23 + sm32) / S;\r\n  } else {\r\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\r\n    out[3] = (sm12 - sm21) / S;\r\n    out[0] = (sm31 + sm13) / S;\r\n    out[1] = (sm23 + sm32) / S;\r\n    out[2] = 0.25 * S;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslationScale(out, q, v, s) {\r\n  // Quaternion math\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n  let sx = s[0];\r\n  let sy = s[1];\r\n  let sz = s[2];\r\n\r\n  out[0] = (1 - (yy + zz)) * sx;\r\n  out[1] = (xy + wz) * sx;\r\n  out[2] = (xz - wy) * sx;\r\n  out[3] = 0;\r\n  out[4] = (xy - wz) * sy;\r\n  out[5] = (1 - (xx + zz)) * sy;\r\n  out[6] = (yz + wx) * sy;\r\n  out[7] = 0;\r\n  out[8] = (xz + wy) * sz;\r\n  out[9] = (yz - wx) * sz;\r\n  out[10] = (1 - (xx + yy)) * sz;\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\r\n  // Quaternion math\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  let sx = s[0];\r\n  let sy = s[1];\r\n  let sz = s[2];\r\n\r\n  let ox = o[0];\r\n  let oy = o[1];\r\n  let oz = o[2];\r\n\r\n  let out0 = (1 - (yy + zz)) * sx;\r\n  let out1 = (xy + wz) * sx;\r\n  let out2 = (xz - wy) * sx;\r\n  let out4 = (xy - wz) * sy;\r\n  let out5 = (1 - (xx + zz)) * sy;\r\n  let out6 = (yz + wx) * sy;\r\n  let out8 = (xz + wy) * sz;\r\n  let out9 = (yz - wx) * sz;\r\n  let out10 = (1 - (xx + yy)) * sz;\r\n\r\n  out[0] = out0;\r\n  out[1] = out1;\r\n  out[2] = out2;\r\n  out[3] = 0;\r\n  out[4] = out4;\r\n  out[5] = out5;\r\n  out[6] = out6;\r\n  out[7] = 0;\r\n  out[8] = out8;\r\n  out[9] = out9;\r\n  out[10] = out10;\r\n  out[11] = 0;\r\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\r\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\r\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\r\nexport function fromQuat(out, q) {\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let yx = y * x2;\r\n  let yy = y * y2;\r\n  let zx = z * x2;\r\n  let zy = z * y2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - yy - zz;\r\n  out[1] = yx + wz;\r\n  out[2] = zx - wy;\r\n  out[3] = 0;\r\n\r\n  out[4] = yx - wz;\r\n  out[5] = 1 - xx - zz;\r\n  out[6] = zy + wx;\r\n  out[7] = 0;\r\n\r\n  out[8] = zx + wy;\r\n  out[9] = zy - wx;\r\n  out[10] = 1 - xx - yy;\r\n  out[11] = 0;\r\n\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function frustum(out, left, right, bottom, top, near, far) {\r\n  let rl = 1 / (right - left);\r\n  let tb = 1 / (top - bottom);\r\n  let nf = 1 / (near - far);\r\n  out[0] = near * 2 * rl;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = near * 2 * tb;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = (right + left) * rl;\r\n  out[9] = (top + bottom) * tb;\r\n  out[10] = (far + near) * nf;\r\n  out[11] = -1;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = far * near * 2 * nf;\r\n  out[15] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\r\nexport function perspective(out, fovy, aspect, near, far) {\r\n  let f = 1.0 / Math.tan(fovy / 2),\r\n    nf;\r\n  out[0] = f / aspect;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = f;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[11] = -1;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[15] = 0;\r\n  if (far != null && far !== Infinity) {\r\n    nf = 1 / (near - far);\r\n    out[10] = (far + near) * nf;\r\n    out[14] = 2 * far * near * nf;\r\n  } else {\r\n    out[10] = -1;\r\n    out[14] = -2 * near;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\r\n  let upTan = Math.tan((fov.upDegrees * Math.PI) / 180.0);\r\n  let downTan = Math.tan((fov.downDegrees * Math.PI) / 180.0);\r\n  let leftTan = Math.tan((fov.leftDegrees * Math.PI) / 180.0);\r\n  let rightTan = Math.tan((fov.rightDegrees * Math.PI) / 180.0);\r\n  let xScale = 2.0 / (leftTan + rightTan);\r\n  let yScale = 2.0 / (upTan + downTan);\r\n\r\n  out[0] = xScale;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  out[3] = 0.0;\r\n  out[4] = 0.0;\r\n  out[5] = yScale;\r\n  out[6] = 0.0;\r\n  out[7] = 0.0;\r\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\r\n  out[9] = (upTan - downTan) * yScale * 0.5;\r\n  out[10] = far / (near - far);\r\n  out[11] = -1.0;\r\n  out[12] = 0.0;\r\n  out[13] = 0.0;\r\n  out[14] = (far * near) / (near - far);\r\n  out[15] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function ortho(out, left, right, bottom, top, near, far) {\r\n  let lr = 1 / (left - right);\r\n  let bt = 1 / (bottom - top);\r\n  let nf = 1 / (near - far);\r\n  out[0] = -2 * lr;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = -2 * bt;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 2 * nf;\r\n  out[11] = 0;\r\n  out[12] = (left + right) * lr;\r\n  out[13] = (top + bottom) * bt;\r\n  out[14] = (far + near) * nf;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\r\nexport function lookAt(out, eye, center, up) {\r\n  let x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\r\n  let eyex = eye[0];\r\n  let eyey = eye[1];\r\n  let eyez = eye[2];\r\n  let upx = up[0];\r\n  let upy = up[1];\r\n  let upz = up[2];\r\n  let centerx = center[0];\r\n  let centery = center[1];\r\n  let centerz = center[2];\r\n\r\n  if (\r\n    Math.abs(eyex - centerx) < glMatrix.EPSILON &&\r\n    Math.abs(eyey - centery) < glMatrix.EPSILON &&\r\n    Math.abs(eyez - centerz) < glMatrix.EPSILON\r\n  ) {\r\n    return identity(out);\r\n  }\r\n\r\n  z0 = eyex - centerx;\r\n  z1 = eyey - centery;\r\n  z2 = eyez - centerz;\r\n\r\n  len = 1 / Math.hypot(z0, z1, z2);\r\n  z0 *= len;\r\n  z1 *= len;\r\n  z2 *= len;\r\n\r\n  x0 = upy * z2 - upz * z1;\r\n  x1 = upz * z0 - upx * z2;\r\n  x2 = upx * z1 - upy * z0;\r\n  len = Math.hypot(x0, x1, x2);\r\n  if (!len) {\r\n    x0 = 0;\r\n    x1 = 0;\r\n    x2 = 0;\r\n  } else {\r\n    len = 1 / len;\r\n    x0 *= len;\r\n    x1 *= len;\r\n    x2 *= len;\r\n  }\r\n\r\n  y0 = z1 * x2 - z2 * x1;\r\n  y1 = z2 * x0 - z0 * x2;\r\n  y2 = z0 * x1 - z1 * x0;\r\n\r\n  len = Math.hypot(y0, y1, y2);\r\n  if (!len) {\r\n    y0 = 0;\r\n    y1 = 0;\r\n    y2 = 0;\r\n  } else {\r\n    len = 1 / len;\r\n    y0 *= len;\r\n    y1 *= len;\r\n    y2 *= len;\r\n  }\r\n\r\n  out[0] = x0;\r\n  out[1] = y0;\r\n  out[2] = z0;\r\n  out[3] = 0;\r\n  out[4] = x1;\r\n  out[5] = y1;\r\n  out[6] = z1;\r\n  out[7] = 0;\r\n  out[8] = x2;\r\n  out[9] = y2;\r\n  out[10] = z2;\r\n  out[11] = 0;\r\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\r\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\r\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\r\nexport function targetTo(out, eye, target, up) {\r\n  let eyex = eye[0],\r\n    eyey = eye[1],\r\n    eyez = eye[2],\r\n    upx = up[0],\r\n    upy = up[1],\r\n    upz = up[2];\r\n\r\n  let z0 = eyex - target[0],\r\n    z1 = eyey - target[1],\r\n    z2 = eyez - target[2];\r\n\r\n  let len = z0 * z0 + z1 * z1 + z2 * z2;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n    z0 *= len;\r\n    z1 *= len;\r\n    z2 *= len;\r\n  }\r\n\r\n  let x0 = upy * z2 - upz * z1,\r\n    x1 = upz * z0 - upx * z2,\r\n    x2 = upx * z1 - upy * z0;\r\n\r\n  len = x0 * x0 + x1 * x1 + x2 * x2;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n    x0 *= len;\r\n    x1 *= len;\r\n    x2 *= len;\r\n  }\r\n\r\n  out[0] = x0;\r\n  out[1] = x1;\r\n  out[2] = x2;\r\n  out[3] = 0;\r\n  out[4] = z1 * x2 - z2 * x1;\r\n  out[5] = z2 * x0 - z0 * x2;\r\n  out[6] = z0 * x1 - z1 * x0;\r\n  out[7] = 0;\r\n  out[8] = z0;\r\n  out[9] = z1;\r\n  out[10] = z2;\r\n  out[11] = 0;\r\n  out[12] = eyex;\r\n  out[13] = eyey;\r\n  out[14] = eyez;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return (\r\n    \"mat4(\" +\r\n    a[0] +\r\n    \", \" +\r\n    a[1] +\r\n    \", \" +\r\n    a[2] +\r\n    \", \" +\r\n    a[3] +\r\n    \", \" +\r\n    a[4] +\r\n    \", \" +\r\n    a[5] +\r\n    \", \" +\r\n    a[6] +\r\n    \", \" +\r\n    a[7] +\r\n    \", \" +\r\n    a[8] +\r\n    \", \" +\r\n    a[9] +\r\n    \", \" +\r\n    a[10] +\r\n    \", \" +\r\n    a[11] +\r\n    \", \" +\r\n    a[12] +\r\n    \", \" +\r\n    a[13] +\r\n    \", \" +\r\n    a[14] +\r\n    \", \" +\r\n    a[15] +\r\n    \")\"\r\n  );\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return Math.hypot(\r\n    a[0],\r\n    a[1],\r\n    a[2],\r\n    a[3],\r\n    a[4],\r\n    a[5],\r\n    a[6],\r\n    a[7],\r\n    a[8],\r\n    a[9],\r\n    a[10],\r\n    a[11],\r\n    a[12],\r\n    a[13],\r\n    a[14],\r\n    a[15]\r\n  );\r\n}\r\n\r\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  out[6] = a[6] + b[6];\r\n  out[7] = a[7] + b[7];\r\n  out[8] = a[8] + b[8];\r\n  out[9] = a[9] + b[9];\r\n  out[10] = a[10] + b[10];\r\n  out[11] = a[11] + b[11];\r\n  out[12] = a[12] + b[12];\r\n  out[13] = a[13] + b[13];\r\n  out[14] = a[14] + b[14];\r\n  out[15] = a[15] + b[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  out[4] = a[4] - b[4];\r\n  out[5] = a[5] - b[5];\r\n  out[6] = a[6] - b[6];\r\n  out[7] = a[7] - b[7];\r\n  out[8] = a[8] - b[8];\r\n  out[9] = a[9] - b[9];\r\n  out[10] = a[10] - b[10];\r\n  out[11] = a[11] - b[11];\r\n  out[12] = a[12] - b[12];\r\n  out[13] = a[13] - b[13];\r\n  out[14] = a[14] - b[14];\r\n  out[15] = a[15] - b[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  out[6] = a[6] * b;\r\n  out[7] = a[7] * b;\r\n  out[8] = a[8] * b;\r\n  out[9] = a[9] * b;\r\n  out[10] = a[10] * b;\r\n  out[11] = a[11] * b;\r\n  out[12] = a[12] * b;\r\n  out[13] = a[13] * b;\r\n  out[14] = a[14] * b;\r\n  out[15] = a[15] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  out[3] = a[3] + b[3] * scale;\r\n  out[4] = a[4] + b[4] * scale;\r\n  out[5] = a[5] + b[5] * scale;\r\n  out[6] = a[6] + b[6] * scale;\r\n  out[7] = a[7] + b[7] * scale;\r\n  out[8] = a[8] + b[8] * scale;\r\n  out[9] = a[9] + b[9] * scale;\r\n  out[10] = a[10] + b[10] * scale;\r\n  out[11] = a[11] + b[11] * scale;\r\n  out[12] = a[12] + b[12] * scale;\r\n  out[13] = a[13] + b[13] * scale;\r\n  out[14] = a[14] + b[14] * scale;\r\n  out[15] = a[15] + b[15] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return (\r\n    a[0] === b[0] &&\r\n    a[1] === b[1] &&\r\n    a[2] === b[2] &&\r\n    a[3] === b[3] &&\r\n    a[4] === b[4] &&\r\n    a[5] === b[5] &&\r\n    a[6] === b[6] &&\r\n    a[7] === b[7] &&\r\n    a[8] === b[8] &&\r\n    a[9] === b[9] &&\r\n    a[10] === b[10] &&\r\n    a[11] === b[11] &&\r\n    a[12] === b[12] &&\r\n    a[13] === b[13] &&\r\n    a[14] === b[14] &&\r\n    a[15] === b[15]\r\n  );\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3];\r\n  let a4 = a[4],\r\n    a5 = a[5],\r\n    a6 = a[6],\r\n    a7 = a[7];\r\n  let a8 = a[8],\r\n    a9 = a[9],\r\n    a10 = a[10],\r\n    a11 = a[11];\r\n  let a12 = a[12],\r\n    a13 = a[13],\r\n    a14 = a[14],\r\n    a15 = a[15];\r\n\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3];\r\n  let b4 = b[4],\r\n    b5 = b[5],\r\n    b6 = b[6],\r\n    b7 = b[7];\r\n  let b8 = b[8],\r\n    b9 = b[9],\r\n    b10 = b[10],\r\n    b11 = b[11];\r\n  let b12 = b[12],\r\n    b13 = b[13],\r\n    b14 = b[14],\r\n    b15 = b[15];\r\n\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n    Math.abs(a3 - b3) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n    Math.abs(a4 - b4) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n    Math.abs(a5 - b5) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\r\n    Math.abs(a6 - b6) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\r\n    Math.abs(a7 - b7) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\r\n    Math.abs(a8 - b8) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) &&\r\n    Math.abs(a9 - b9) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) &&\r\n    Math.abs(a10 - b10) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) &&\r\n    Math.abs(a11 - b11) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) &&\r\n    Math.abs(a12 - b12) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) &&\r\n    Math.abs(a13 - b13) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) &&\r\n    Math.abs(a14 - b14) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) &&\r\n    Math.abs(a15 - b15) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(3);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function clone(a) {\r\n  var out = new glMatrix.ARRAY_TYPE(3);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  return Math.hypot(x, y, z);\r\n}\r\n\r\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function fromValues(x, y, z) {\r\n  let out = new glMatrix.ARRAY_TYPE(3);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\r\nexport function set(out, x, y, z) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  out[2] = a[2] * b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  out[2] = a[2] / b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  out[2] = Math.ceil(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  out[2] = Math.floor(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  out[2] = Math.min(a[2], b[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  out[2] = Math.max(a[2], b[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  out[2] = Math.round(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  return Math.hypot(x, y, z);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  return x * x + y * y + z * z;\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  return x * x + y * y + z * z;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\r\nexport function normalize(out, a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let len = x * x + y * y + z * z;\r\n  if (len > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = a[0] * len;\r\n  out[1] = a[1] * len;\r\n  out[2] = a[2] * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\r\n}\r\n\r\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function cross(out, a, b) {\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2];\r\n  let bx = b[0],\r\n    by = b[1],\r\n    bz = b[2];\r\n\r\n  out[0] = ay * bz - az * by;\r\n  out[1] = az * bx - ax * bz;\r\n  out[2] = ax * by - ay * bx;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  let ax = a[0];\r\n  let ay = a[1];\r\n  let az = a[2];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  out[2] = az + t * (b[2] - az);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function hermite(out, a, b, c, d, t) {\r\n  let factorTimes2 = t * t;\r\n  let factor1 = factorTimes2 * (2 * t - 3) + 1;\r\n  let factor2 = factorTimes2 * (t - 2) + t;\r\n  let factor3 = factorTimes2 * (t - 1);\r\n  let factor4 = factorTimes2 * (3 - 2 * t);\r\n\r\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\r\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\r\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function bezier(out, a, b, c, d, t) {\r\n  let inverseFactor = 1 - t;\r\n  let inverseFactorTimesTwo = inverseFactor * inverseFactor;\r\n  let factorTimes2 = t * t;\r\n  let factor1 = inverseFactorTimesTwo * inverseFactor;\r\n  let factor2 = 3 * t * inverseFactorTimesTwo;\r\n  let factor3 = 3 * factorTimes2 * inverseFactor;\r\n  let factor4 = factorTimes2 * t;\r\n\r\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\r\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\r\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n\r\n  let r = glMatrix.RANDOM() * 2.0 * Math.PI;\r\n  let z = glMatrix.RANDOM() * 2.0 - 1.0;\r\n  let zScale = Math.sqrt(1.0 - z * z) * scale;\r\n\r\n  out[0] = Math.cos(r) * zScale;\r\n  out[1] = Math.sin(r) * zScale;\r\n  out[2] = z * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  let w = m[3] * x + m[7] * y + m[11] * z + m[15];\r\n  w = w || 1.0;\r\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\r\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\r\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformMat3(out, a, m) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  out[0] = x * m[0] + y * m[3] + z * m[6];\r\n  out[1] = x * m[1] + y * m[4] + z * m[7];\r\n  out[2] = x * m[2] + y * m[5] + z * m[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformQuat(out, a, q) {\r\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\r\n  let qx = q[0],\r\n    qy = q[1],\r\n    qz = q[2],\r\n    qw = q[3];\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  // var qvec = [qx, qy, qz];\r\n  // var uv = vec3.cross([], qvec, a);\r\n  let uvx = qy * z - qz * y,\r\n    uvy = qz * x - qx * z,\r\n    uvz = qx * y - qy * x;\r\n  // var uuv = vec3.cross([], qvec, uv);\r\n  let uuvx = qy * uvz - qz * uvy,\r\n    uuvy = qz * uvx - qx * uvz,\r\n    uuvz = qx * uvy - qy * uvx;\r\n  // vec3.scale(uv, uv, 2 * w);\r\n  let w2 = qw * 2;\r\n  uvx *= w2;\r\n  uvy *= w2;\r\n  uvz *= w2;\r\n  // vec3.scale(uuv, uuv, 2);\r\n  uuvx *= 2;\r\n  uuvy *= 2;\r\n  uuvz *= 2;\r\n  // return vec3.add(out, a, vec3.add(out, uv, uuv));\r\n  out[0] = x + uvx + uuvx;\r\n  out[1] = y + uvy + uuvy;\r\n  out[2] = z + uvz + uuvz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateX(out, a, b, rad) {\r\n  let p = [],\r\n    r = [];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[0];\r\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\r\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad);\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateY(out, a, b, rad) {\r\n  let p = [],\r\n    r = [];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\r\n  r[1] = p[1];\r\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad);\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateZ(out, a, b, rad) {\r\n  let p = [],\r\n    r = [];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\r\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\r\n  r[2] = p[2];\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\r\nexport function angle(a, b) {\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    bx = b[0],\r\n    by = b[1],\r\n    bz = b[2],\r\n    mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\r\n    mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\r\n    mag = mag1 * mag2,\r\n    cosine = mag && dot(a, b) / mag;\r\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\r\n}\r\n\r\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2];\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if (!stride) {\r\n      stride = 3;\r\n    }\r\n\r\n    if (!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if (count) {\r\n      l = Math.min(count * stride + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for (i = offset; i < l; i += stride) {\r\n      vec[0] = a[i];\r\n      vec[1] = a[i + 1];\r\n      vec[2] = a[i + 2];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0];\r\n      a[i + 1] = vec[1];\r\n      a[i + 2] = vec[2];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function fromValues(x, y, z, w) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\r\nexport function set(out, x, y, z, w) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  out[2] = a[2] * b[2];\r\n  out[3] = a[3] * b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  out[2] = a[2] / b[2];\r\n  out[3] = a[3] / b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  out[2] = Math.ceil(a[2]);\r\n  out[3] = Math.ceil(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  out[2] = Math.floor(a[2]);\r\n  out[3] = Math.floor(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  out[2] = Math.min(a[2], b[2]);\r\n  out[3] = Math.min(a[3], b[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  out[2] = Math.max(a[2], b[2]);\r\n  out[3] = Math.max(a[3], b[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  out[2] = Math.round(a[2]);\r\n  out[3] = Math.round(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  out[3] = a[3] + b[3] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  let w = b[3] - a[3];\r\n  return Math.hypot(x, y, z, w);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  let w = b[3] - a[3];\r\n  return x * x + y * y + z * z + w * w;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  return Math.hypot(x, y, z, w);\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  return x * x + y * y + z * z + w * w;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] = -a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  out[3] = 1.0 / a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\r\nexport function normalize(out, a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  let len = x * x + y * y + z * z + w * w;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = x * len;\r\n  out[1] = y * len;\r\n  out[2] = z * len;\r\n  out[3] = w * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\r\n}\r\n\r\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\r\nexport function cross(out, u, v, w) {\r\n  let A = v[0] * w[1] - v[1] * w[0],\r\n    B = v[0] * w[2] - v[2] * w[0],\r\n    C = v[0] * w[3] - v[3] * w[0],\r\n    D = v[1] * w[2] - v[2] * w[1],\r\n    E = v[1] * w[3] - v[3] * w[1],\r\n    F = v[2] * w[3] - v[3] * w[2];\r\n  let G = u[0];\r\n  let H = u[1];\r\n  let I = u[2];\r\n  let J = u[3];\r\n\r\n  out[0] = H * F - I * E + J * D;\r\n  out[1] = -(G * F) + I * C - J * B;\r\n  out[2] = G * E - H * C + J * A;\r\n  out[3] = -(G * D) + H * B - I * A;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  let ax = a[0];\r\n  let ay = a[1];\r\n  let az = a[2];\r\n  let aw = a[3];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  out[2] = az + t * (b[2] - az);\r\n  out[3] = aw + t * (b[3] - aw);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n\r\n  // Marsaglia, George. Choosing a Point from the Surface of a\r\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\r\n  // http://projecteuclid.org/euclid.aoms/1177692644;\r\n  var v1, v2, v3, v4;\r\n  var s1, s2;\r\n  do {\r\n    v1 = glMatrix.RANDOM() * 2 - 1;\r\n    v2 = glMatrix.RANDOM() * 2 - 1;\r\n    s1 = v1 * v1 + v2 * v2;\r\n  } while (s1 >= 1);\r\n  do {\r\n    v3 = glMatrix.RANDOM() * 2 - 1;\r\n    v4 = glMatrix.RANDOM() * 2 - 1;\r\n    s2 = v3 * v3 + v4 * v4;\r\n  } while (s2 >= 1);\r\n\r\n  var d = Math.sqrt((1 - s1) / s2);\r\n  out[0] = scale * v1;\r\n  out[1] = scale * v2;\r\n  out[2] = scale * v3 * d;\r\n  out[3] = scale * v4 * d;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2],\r\n    w = a[3];\r\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\r\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\r\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\r\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\r\nexport function transformQuat(out, a, q) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  let qx = q[0],\r\n    qy = q[1],\r\n    qz = q[2],\r\n    qw = q[3];\r\n\r\n  // calculate quat * vec\r\n  let ix = qw * x + qy * z - qz * y;\r\n  let iy = qw * y + qz * x - qx * z;\r\n  let iz = qw * z + qx * y - qy * x;\r\n  let iw = -qx * x - qy * y - qz * z;\r\n\r\n  // calculate result * inverse quat\r\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  out[3] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3];\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n    Math.abs(a3 - b3) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if (!stride) {\r\n      stride = 4;\r\n    }\r\n\r\n    if (!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if (count) {\r\n      l = Math.min(count * stride + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for (i = offset; i < l; i += stride) {\r\n      vec[0] = a[i];\r\n      vec[1] = a[i + 1];\r\n      vec[2] = a[i + 2];\r\n      vec[3] = a[i + 3];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0];\r\n      a[i + 1] = vec[1];\r\n      a[i + 2] = vec[2];\r\n      a[i + 3] = vec[3];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\nimport * as mat3 from \"./mat3.js\";\r\nimport * as vec3 from \"./vec3.js\";\r\nimport * as vec4 from \"./vec4.js\";\r\n\r\n/**\r\n * Quaternion\r\n * @module quat\r\n */\r\n\r\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n  }\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 0;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\r\nexport function setAxisAngle(out, axis, rad) {\r\n  rad = rad * 0.5;\r\n  let s = Math.sin(rad);\r\n  out[0] = s * axis[0];\r\n  out[1] = s * axis[1];\r\n  out[2] = s * axis[2];\r\n  out[3] = Math.cos(rad);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\r\nexport function getAxisAngle(out_axis, q) {\r\n  let rad = Math.acos(q[3]) * 2.0;\r\n  let s = Math.sin(rad / 2.0);\r\n  if (s > glMatrix.EPSILON) {\r\n    out_axis[0] = q[0] / s;\r\n    out_axis[1] = q[1] / s;\r\n    out_axis[2] = q[2] / s;\r\n  } else {\r\n    // If s is zero, return any axis (no rotation - axis does not matter)\r\n    out_axis[0] = 1;\r\n    out_axis[1] = 0;\r\n    out_axis[2] = 0;\r\n  }\r\n  return rad;\r\n}\r\n\r\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\r\nexport function getAngle(a, b) {\r\n  let dotproduct = dot(a, b);\r\n\r\n  return Math.acos(2 * dotproduct * dotproduct - 1);\r\n}\r\n\r\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bx = b[0],\r\n    by = b[1],\r\n    bz = b[2],\r\n    bw = b[3];\r\n\r\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\r\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\r\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\r\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateX(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bx = Math.sin(rad),\r\n    bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw + aw * bx;\r\n  out[1] = ay * bw + az * bx;\r\n  out[2] = az * bw - ay * bx;\r\n  out[3] = aw * bw - ax * bx;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateY(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let by = Math.sin(rad),\r\n    bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw - az * by;\r\n  out[1] = ay * bw + aw * by;\r\n  out[2] = az * bw + ax * by;\r\n  out[3] = aw * bw - ay * by;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateZ(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bz = Math.sin(rad),\r\n    bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw + ay * bz;\r\n  out[1] = ay * bw - ax * bz;\r\n  out[2] = az * bw + aw * bz;\r\n  out[3] = aw * bw - az * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\r\nexport function calculateW(out, a) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\r\nexport function exp(out, a) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2],\r\n    w = a[3];\r\n\r\n  let r = Math.sqrt(x * x + y * y + z * z);\r\n  let et = Math.exp(w);\r\n  let s = r > 0 ? (et * Math.sin(r)) / r : 0;\r\n\r\n  out[0] = x * s;\r\n  out[1] = y * s;\r\n  out[2] = z * s;\r\n  out[3] = et * Math.cos(r);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\r\nexport function ln(out, a) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2],\r\n    w = a[3];\r\n\r\n  let r = Math.sqrt(x * x + y * y + z * z);\r\n  let t = r > 0 ? Math.atan2(r, w) / r : 0;\r\n\r\n  out[0] = x * t;\r\n  out[1] = y * t;\r\n  out[2] = z * t;\r\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\r\nexport function pow(out, a, b) {\r\n  ln(out, a);\r\n  scale(out, out, b);\r\n  exp(out, out);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\r\nexport function slerp(out, a, b, t) {\r\n  // benchmarks:\r\n  //    http://jsperf.com/quaternion-slerp-implementations\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bx = b[0],\r\n    by = b[1],\r\n    bz = b[2],\r\n    bw = b[3];\r\n\r\n  let omega, cosom, sinom, scale0, scale1;\r\n\r\n  // calc cosine\r\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\r\n  // adjust signs (if necessary)\r\n  if (cosom < 0.0) {\r\n    cosom = -cosom;\r\n    bx = -bx;\r\n    by = -by;\r\n    bz = -bz;\r\n    bw = -bw;\r\n  }\r\n  // calculate coefficients\r\n  if (1.0 - cosom > glMatrix.EPSILON) {\r\n    // standard case (slerp)\r\n    omega = Math.acos(cosom);\r\n    sinom = Math.sin(omega);\r\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\r\n    scale1 = Math.sin(t * omega) / sinom;\r\n  } else {\r\n    // \"from\" and \"to\" quaternions are very close\r\n    //  ... so we can do a linear interpolation\r\n    scale0 = 1.0 - t;\r\n    scale1 = t;\r\n  }\r\n  // calculate final values\r\n  out[0] = scale0 * ax + scale1 * bx;\r\n  out[1] = scale0 * ay + scale1 * by;\r\n  out[2] = scale0 * az + scale1 * bz;\r\n  out[3] = scale0 * aw + scale1 * bw;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\r\nexport function random(out) {\r\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\r\n  // TODO: Calling random 3 times is probably not the fastest solution\r\n  let u1 = glMatrix.RANDOM();\r\n  let u2 = glMatrix.RANDOM();\r\n  let u3 = glMatrix.RANDOM();\r\n\r\n  let sqrt1MinusU1 = Math.sqrt(1 - u1);\r\n  let sqrtU1 = Math.sqrt(u1);\r\n\r\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\r\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\r\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\r\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\r\nexport function invert(out, a) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3];\r\n  let dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\r\n  let invDot = dot ? 1.0 / dot : 0;\r\n\r\n  // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\r\n\r\n  out[0] = -a0 * invDot;\r\n  out[1] = -a1 * invDot;\r\n  out[2] = -a2 * invDot;\r\n  out[3] = a3 * invDot;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\r\nexport function conjugate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport function fromMat3(out, m) {\r\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\r\n  // article \"Quaternion Calculus and Fast Animation\".\r\n  let fTrace = m[0] + m[4] + m[8];\r\n  let fRoot;\r\n\r\n  if (fTrace > 0.0) {\r\n    // |w| > 1/2, may as well choose w > 1/2\r\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\r\n    out[3] = 0.5 * fRoot;\r\n    fRoot = 0.5 / fRoot; // 1/(4w)\r\n    out[0] = (m[5] - m[7]) * fRoot;\r\n    out[1] = (m[6] - m[2]) * fRoot;\r\n    out[2] = (m[1] - m[3]) * fRoot;\r\n  } else {\r\n    // |w| <= 1/2\r\n    let i = 0;\r\n    if (m[4] > m[0]) i = 1;\r\n    if (m[8] > m[i * 3 + i]) i = 2;\r\n    let j = (i + 1) % 3;\r\n    let k = (i + 2) % 3;\r\n\r\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\r\n    out[i] = 0.5 * fRoot;\r\n    fRoot = 0.5 / fRoot;\r\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\r\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\r\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport function fromEuler(out, x, y, z) {\r\n  let halfToRad = (0.5 * Math.PI) / 180.0;\r\n  x *= halfToRad;\r\n  y *= halfToRad;\r\n  z *= halfToRad;\r\n\r\n  let sx = Math.sin(x);\r\n  let cx = Math.cos(x);\r\n  let sy = Math.sin(y);\r\n  let cy = Math.cos(y);\r\n  let sz = Math.sin(z);\r\n  let cz = Math.cos(z);\r\n\r\n  out[0] = sx * cy * cz - cx * sy * sz;\r\n  out[1] = cx * sy * cz + sx * cy * sz;\r\n  out[2] = cx * cy * sz - sx * sy * cz;\r\n  out[3] = cx * cy * cz + sx * sy * sz;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\r\n}\r\n\r\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nexport const clone = vec4.clone;\r\n\r\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nexport const fromValues = vec4.fromValues;\r\n\r\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const copy = vec4.copy;\r\n\r\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const set = vec4.set;\r\n\r\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const add = vec4.add;\r\n\r\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const scale = vec4.scale;\r\n\r\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\r\nexport const dot = vec4.dot;\r\n\r\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const lerp = vec4.lerp;\r\n\r\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport const length = vec4.length;\r\n\r\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\r\nexport const squaredLength = vec4.squaredLength;\r\n\r\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const normalize = vec4.normalize;\r\n\r\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport const exactEquals = vec4.exactEquals;\r\n\r\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport const equals = vec4.equals;\r\n\r\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\r\nexport const rotationTo = (function() {\r\n  let tmpvec3 = vec3.create();\r\n  let xUnitVec3 = vec3.fromValues(1, 0, 0);\r\n  let yUnitVec3 = vec3.fromValues(0, 1, 0);\r\n\r\n  return function(out, a, b) {\r\n    let dot = vec3.dot(a, b);\r\n    if (dot < -0.999999) {\r\n      vec3.cross(tmpvec3, xUnitVec3, a);\r\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\r\n      vec3.normalize(tmpvec3, tmpvec3);\r\n      setAxisAngle(out, tmpvec3, Math.PI);\r\n      return out;\r\n    } else if (dot > 0.999999) {\r\n      out[0] = 0;\r\n      out[1] = 0;\r\n      out[2] = 0;\r\n      out[3] = 1;\r\n      return out;\r\n    } else {\r\n      vec3.cross(tmpvec3, a, b);\r\n      out[0] = tmpvec3[0];\r\n      out[1] = tmpvec3[1];\r\n      out[2] = tmpvec3[2];\r\n      out[3] = 1 + dot;\r\n      return normalize(out, out);\r\n    }\r\n  };\r\n})();\r\n\r\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\r\nexport const sqlerp = (function() {\r\n  let temp1 = create();\r\n  let temp2 = create();\r\n\r\n  return function(out, a, b, c, d, t) {\r\n    slerp(temp1, a, d, t);\r\n    slerp(temp2, b, c, t);\r\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\r\n\r\n    return out;\r\n  };\r\n})();\r\n\r\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\r\nexport const setAxes = (function() {\r\n  let matr = mat3.create();\r\n\r\n  return function(out, view, right, up) {\r\n    matr[0] = right[0];\r\n    matr[3] = right[1];\r\n    matr[6] = right[2];\r\n\r\n    matr[1] = up[0];\r\n    matr[4] = up[1];\r\n    matr[7] = up[2];\r\n\r\n    matr[2] = -view[0];\r\n    matr[5] = -view[1];\r\n    matr[8] = -view[2];\r\n\r\n    return normalize(out, fromMat3(out, matr));\r\n  };\r\n})();\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function fromValues(x, y) {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\r\nexport function set(out, x, y) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  var x = b[0] - a[0],\r\n    y = b[1] - a[1];\r\n  return Math.hypot(x, y);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  var x = b[0] - a[0],\r\n    y = b[1] - a[1];\r\n  return x * x + y * y;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  return Math.hypot(x, y);\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  return x * x + y * y;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\r\nexport function normalize(out, a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  var len = x * x + y * y;\r\n  if (len > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = a[0] * len;\r\n  out[1] = a[1] * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1];\r\n}\r\n\r\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function cross(out, a, b) {\r\n  var z = a[0] * b[1] - a[1] * b[0];\r\n  out[0] = out[1] = 0;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  var ax = a[0],\r\n    ay = a[1];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\r\n  out[0] = Math.cos(r) * scale;\r\n  out[1] = Math.sin(r) * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat2(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[2] * y;\r\n  out[1] = m[1] * x + m[3] * y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat2d(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[2] * y + m[4];\r\n  out[1] = m[1] * x + m[3] * y + m[5];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat3(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[3] * y + m[6];\r\n  out[1] = m[1] * x + m[4] * y + m[7];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  out[0] = m[0] * x + m[4] * y + m[12];\r\n  out[1] = m[1] * x + m[5] * y + m[13];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\r\nexport function rotate(out, a, b, rad) {\r\n  //Translate point to the origin\r\n  let p0 = a[0] - b[0],\r\n    p1 = a[1] - b[1],\r\n    sinC = Math.sin(rad),\r\n    cosC = Math.cos(rad);\r\n\r\n  //perform rotation and translate to correct position\r\n  out[0] = p0 * cosC - p1 * sinC + b[0];\r\n  out[1] = p0 * sinC + p1 * cosC + b[1];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\r\nexport function angle(a, b) {\r\n  let x1 = a[0],\r\n    y1 = a[1],\r\n    x2 = b[0],\r\n    y2 = b[1],\r\n    // mag is the product of the magnitudes of a and b\r\n    mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\r\n    // mag &&.. short circuits if mag == 0\r\n    cosine = mag && (x1 * x2 + y1 * y2) / mag;\r\n  // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\r\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\r\n}\r\n\r\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1];\r\n  let b0 = b[0],\r\n    b1 = b[1];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if (!stride) {\r\n      stride = 2;\r\n    }\r\n\r\n    if (!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if (count) {\r\n      l = Math.min(count * stride + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for (i = offset; i < l; i += stride) {\r\n      vec[0] = a[i];\r\n      vec[1] = a[i + 1];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0];\r\n      a[i + 1] = vec[1];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\n// Code from https://github.com/Twinklebear/webgl-volume-raycaster\r\n\r\nimport {\r\n    vec2, vec3, vec4, mat3, mat4, quat\r\n} from './gl-matrix'\r\n\r\n// Compute the view frustum in world space from the provided\r\n// column major projection * view matrix\r\nvar Frustum = function(projView) {\r\n    var rows = [vec4.create(), vec4.create(), vec4.create(), vec4.create()];\r\n    for (var i = 0; i < rows.length; ++i) {\r\n        rows[i] = vec4.set(rows[i], projView[i], projView[4 + i],\r\n            projView[8 + i], projView[12 + i]);\r\n    }\r\n\r\n    this.planes = [\r\n        // -x plane\r\n        vec4.add(vec4.create(), rows[3], rows[0]),\r\n        // +x plane\r\n        vec4.sub(vec4.create(), rows[3], rows[0]),\r\n        // -y plane\r\n        vec4.add(vec4.create(), rows[3], rows[1]),\r\n        // +y plane\r\n        vec4.sub(vec4.create(), rows[3], rows[1]),\r\n        // -z plane\r\n        vec4.add(vec4.create(), rows[3], rows[2]),\r\n        // +z plane\r\n        vec4.sub(vec4.create(), rows[3], rows[2])\r\n    ];\r\n\r\n    // Normalize the planes\r\n    for (var i = 0; i < this.planes.length; ++i) {\r\n        var s = 1.0 / Math.sqrt(this.planes[i][0] * this.planes[i][0] +\r\n            this.planes[i][1] * this.planes[i][1] + this.planes[i][2] * this.planes[i][2]);\r\n        this.planes[i][0] *= s;\r\n        this.planes[i][1] *= s;\r\n        this.planes[i][2] *= s;\r\n        this.planes[i][3] *= s;\r\n    }\r\n\r\n    // Compute the frustum points as well\r\n    var invProjView = mat4.invert(mat4.create(), projView);\r\n    this.points = [\r\n        // x_l, y_l, z_l\r\n        vec4.set(vec4.create(), -1, -1, -1, 1),\r\n        // x_h, y_l, z_l\r\n        vec4.set(vec4.create(), 1, -1, -1, 1),\r\n        // x_l, y_h, z_l\r\n        vec4.set(vec4.create(), -1, 1, -1, 1),\r\n        // x_h, y_h, z_l\r\n        vec4.set(vec4.create(), 1, 1, -1, 1),\r\n        // x_l, y_l, z_h\r\n        vec4.set(vec4.create(), -1, -1, 1, 1),\r\n        // x_h, y_l, z_h\r\n        vec4.set(vec4.create(), 1, -1, 1, 1),\r\n        // x_l, y_h, z_h\r\n        vec4.set(vec4.create(), -1, 1, 1, 1),\r\n        // x_h, y_h, z_h\r\n        vec4.set(vec4.create(), 1, 1, 1, 1)\r\n    ];\r\n    for (var i = 0; i < 8; ++i) {\r\n        this.points[i] = vec4.transformMat4(this.points[i], this.points[i], invProjView);\r\n        this.points[i][0] /= this.points[i][3];\r\n        this.points[i][1] /= this.points[i][3];\r\n        this.points[i][2] /= this.points[i][3];\r\n        this.points[i][3] = 1.0;\r\n    }\r\n}\r\n\r\n// Check if the box is contained in the Frustum\r\n// The box should be [x_lower, y_lower, z_lower, x_upper, y_upper, z_upper]\r\n// This is done using Inigo Quilez's approach to help with large\r\n// bounds: https://www.iquilezles.org/www/articles/frustumcorrect/frustumcorrect.htm\r\nFrustum.prototype.containsBox = function(box) {\r\n    // Test the box against each plane\r\n    var vec = vec4.create();\r\n    var out = 0;\r\n    for (var i = 0; i < this.planes.length; ++i) {\r\n        out = 0;\r\n        // x_l, y_l, z_l\r\n        vec4.set(vec, box[0], box[1], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_l, z_l\r\n        vec4.set(vec, box[3], box[1], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_l, y_h, z_l\r\n        vec4.set(vec, box[0], box[4], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_h, z_l\r\n        vec4.set(vec, box[3], box[4], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_l, y_l, z_h\r\n        vec4.set(vec, box[0], box[1], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_l, z_h\r\n        vec4.set(vec, box[3], box[1], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_l, y_h, z_h\r\n        vec4.set(vec, box[0], box[4], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_h, z_h\r\n        vec4.set(vec, box[3], box[4], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n\r\n        if (out == 8) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Test the frustum against the box\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][0] > box[3] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][0] < box[0] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][1] > box[4] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][1] < box[1] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][2] > box[5] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][2] < box[2] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\nvar Shader = function(gl, vertexSrc, fragmentSrc) {\r\n    var self = this;\r\n    this.program = compileShader(gl, vertexSrc, fragmentSrc);\r\n\r\n    var regexUniform = /uniform[^;]+[ ](\\w+);/g\r\n    var matchUniformName = /uniform[^;]+[ ](\\w+);/\r\n\r\n    this.uniforms = {};\r\n\r\n    var vertexUnifs = vertexSrc.match(regexUniform);\r\n    var fragUnifs = fragmentSrc.match(regexUniform);\r\n\r\n    if (vertexUnifs) {\r\n        vertexUnifs.forEach(function(unif) {\r\n            var m = unif.match(matchUniformName);\r\n            self.uniforms[m[1]] = -1;\r\n        });\r\n    }\r\n    if (fragUnifs) {\r\n        fragUnifs.forEach(function(unif) {\r\n            var m = unif.match(matchUniformName);\r\n            self.uniforms[m[1]] = -1;\r\n        });\r\n    }\r\n\r\n    for (var unif in this.uniforms) {\r\n        this.uniforms[unif] = gl.getUniformLocation(this.program, unif);\r\n    }\r\n}\r\n\r\nShader.prototype.use = function(gl) {\r\n    gl.useProgram(this.program);\r\n}\r\n\r\n// Compile and link the shaders vert and frag. vert and frag should contain\r\n// the shader source code for the vertex and fragment shaders respectively\r\n// Returns the compiled and linked program, or null if compilation or linking failed\r\nvar compileShader = function(gl, vert, frag){\r\n    var vs = gl.createShader(gl.VERTEX_SHADER);\r\n    gl.shaderSource(vs, vert);\r\n    gl.compileShader(vs);\r\n    if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS)){\r\n        alert(\"Vertex shader failed to compile, see console for log\");\r\n        console.log(gl.getShaderInfoLog(vs));\r\n        return null;\r\n    }\r\n\r\n    var fs = gl.createShader(gl.FRAGMENT_SHADER);\r\n    gl.shaderSource(fs, frag);\r\n    gl.compileShader(fs);\r\n    if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)){\r\n        alert(\"Fragment shader failed to compile, see console for log\");\r\n        console.log(gl.getShaderInfoLog(fs));\r\n        return null;\r\n    }\r\n\r\n    var program = gl.createProgram();\r\n    gl.attachShader(program, vs);\r\n    gl.attachShader(program, fs);\r\n    gl.linkProgram(program);\r\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)){\r\n        alert(\"Shader failed to link, see console for log\");\r\n        console.log(gl.getProgramInfoLog(program));\r\n        return null;\r\n    }\r\n    return program;\r\n}\r\n\r\n// var getGLExtension = function(ext) {\r\n//     if (!gl.getExtension(ext)) {\r\n//         alert(\"Missing \" + ext + \" WebGL extension\");\r\n//         return false;\r\n//     }\r\n//     return true;\r\n// }\r\n\r\n/* The arcball camera will be placed at the position 'eye', rotating\r\n * around the point 'center', with the up vector 'up'. 'screenDims'\r\n * should be the dimensions of the canvas or region taking mouse input\r\n * so the mouse positions can be normalized into [-1, 1] from the pixel\r\n * coordinates.\r\n */\r\nvar ArcballCamera = function(eye, center, up, zoomSpeed, screenDims) {\r\n\r\n    var veye = vec3.set(vec3.create(), eye[0], eye[1], eye[2]);\r\n    var vcenter = vec3.set(vec3.create(), center[0], center[1], center[2]);\r\n    var vup = vec3.set(vec3.create(), up[0], up[1], up[2]);\r\n    vec3.normalize(vup, vup);\r\n\r\n    var zAxis = vec3.sub(vec3.create(), vcenter, veye);\r\n    var viewDist = vec3.len(zAxis);\r\n    vec3.normalize(zAxis, zAxis);\r\n\r\n    var xAxis = vec3.cross(vec3.create(), zAxis, vup);\r\n    vec3.normalize(xAxis, xAxis);\r\n\r\n    var yAxis = vec3.cross(vec3.create(), xAxis, zAxis);\r\n    vec3.normalize(yAxis, yAxis);\r\n\r\n    vec3.cross(xAxis, zAxis, yAxis);\r\n    vec3.normalize(xAxis, xAxis);\r\n\r\n    this.zoomSpeed = zoomSpeed;\r\n    this.invScreen = [1.0 / screenDims[0], 1.0 / screenDims[1]];\r\n\r\n    this.centerTranslation = mat4.fromTranslation(mat4.create(), center);\r\n    mat4.invert(this.centerTranslation, this.centerTranslation);\r\n\r\n    var vt = vec3.set(vec3.create(), 0, 0, -1.0 * viewDist);\r\n    this.translation = mat4.fromTranslation(mat4.create(), vt);\r\n\r\n    var rotMat = mat3.fromValues(xAxis[0], xAxis[1], xAxis[2],\r\n        yAxis[0], yAxis[1], yAxis[2],\r\n        -zAxis[0], -zAxis[1], -zAxis[2]);\r\n    mat3.transpose(rotMat, rotMat);\r\n    this.rotation = quat.fromMat3(quat.create(), rotMat);\r\n    quat.normalize(this.rotation, this.rotation);\r\n\r\n    this.camera = mat4.create();\r\n    this.invCamera = mat4.create();\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.rotate = function(prevMouse, curMouse) {\r\n    var mPrev = vec2.set(vec2.create(),\r\n        clamp(prevMouse[0] * 2.0 * this.invScreen[0] - 1.0, -1.0, 1.0),\r\n        clamp(1.0 - prevMouse[1] * 2.0 * this.invScreen[1], -1.0, 1.0));\r\n\r\n    var mCur = vec2.set(vec2.create(),\r\n        clamp(curMouse[0] * 2.0 * this.invScreen[0] - 1.0, -1.0, 1.0),\r\n        clamp(1.0 - curMouse[1] * 2.0 * this.invScreen[1], -1.0, 1.0));\r\n\r\n    var mPrevBall = screenToArcball(mPrev);\r\n    var mCurBall = screenToArcball(mCur);\r\n    // rotation = curBall * prevBall * rotation\r\n    this.rotation = quat.mul(this.rotation, mPrevBall, this.rotation);\r\n    this.rotation = quat.mul(this.rotation, mCurBall, this.rotation);\r\n\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.zoom = function(amount) {\r\n    var vt = vec3.set(vec3.create(), 0.0, 0.0, amount * this.invScreen[1] * this.zoomSpeed);\r\n    var t = mat4.fromTranslation(mat4.create(), vt);\r\n    this.translation = mat4.mul(this.translation, t, this.translation);\r\n    if (this.translation[14] >= -0.2) {\r\n        this.translation[14] = -0.2;\r\n    }\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.pan = function(mouseDelta) {\r\n    var delta = vec4.set(vec4.create(), mouseDelta[0] * this.invScreen[0] * Math.abs(this.translation[14]),\r\n        mouseDelta[1] * this.invScreen[1] * Math.abs(this.translation[14]), 0, 0);\r\n    var worldDelta = vec4.transformMat4(vec4.create(), delta, this.invCamera);\r\n    var translation = mat4.fromTranslation(mat4.create(), worldDelta);\r\n    this.centerTranslation = mat4.mul(this.centerTranslation, translation, this.centerTranslation);\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.updateCameraMatrix = function() {\r\n    // camera = translation * rotation * centerTranslation\r\n    var rotMat = mat4.fromQuat(mat4.create(), this.rotation);\r\n    this.camera = mat4.mul(this.camera, rotMat, this.centerTranslation);\r\n    this.camera = mat4.mul(this.camera, this.translation, this.camera);\r\n    this.invCamera = mat4.invert(this.invCamera, this.camera);\r\n}\r\n\r\nArcballCamera.prototype.eyePos = function() {\r\n    return [this.invCamera[12], this.invCamera[13], this.invCamera[14]];\r\n}\r\n\r\nArcballCamera.prototype.eyeDir = function() {\r\n    var dir = vec4.set(vec4.create(), 0.0, 0.0, -1.0, 0.0);\r\n    dir = vec4.transformMat4(dir, dir, this.invCamera);\r\n    dir = vec4.normalize(dir, dir);\r\n    return [dir[0], dir[1], dir[2]];\r\n}\r\n\r\nArcballCamera.prototype.upDir = function() {\r\n    var dir = vec4.set(vec4.create(), 0.0, 1.0, 0.0, 0.0);\r\n    dir = vec4.transformMat4(dir, dir, this.invCamera);\r\n    dir = vec4.normalize(dir, dir);\r\n    return [dir[0], dir[1], dir[2]];\r\n}\r\n\r\nvar screenToArcball = function(p) {\r\n    var dist = vec2.dot(p, p);\r\n    if (dist <= 1.0) {\r\n        return quat.set(quat.create(), p[0], p[1], Math.sqrt(1.0 - dist), 0);\r\n    } else {\r\n        var unitP = vec2.normalize(vec2.create(), p);\r\n        // cgmath is w, x, y, z\r\n        // glmatrix is x, y, z, w\r\n        return quat.set(quat.create(), unitP[0], unitP[1], 0, 0);\r\n    }\r\n}\r\nvar clamp = function(a, min, max) {\r\n    return a < min ? min : a > max ? max : a;\r\n}\r\n\r\nvar pointDist = function(a, b) {\r\n    var v = [b[0] - a[0], b[1] - a[1]];\r\n    return Math.sqrt(Math.pow(v[0], 2.0) + Math.pow(v[1], 2.0));\r\n}\r\n\r\nvar Buffer = function(capacity, dtype) {\r\n    this.len = 0;\r\n    this.capacity = capacity;\r\n    if (dtype == \"uint8\") {\r\n        this.buffer = new Uint8Array(capacity);\r\n    } else if (dtype == \"int8\") {\r\n        this.buffer = new Int8Array(capacity);\r\n    } else if (dtype == \"uint16\") {\r\n        this.buffer = new Uint16Array(capacity);\r\n    } else if (dtype == \"int16\") {\r\n        this.buffer = new Int16Array(capacity);\r\n    } else if (dtype == \"uint32\") {\r\n        this.buffer = new Uint32Array(capacity);\r\n    } else if (dtype == \"int32\") {\r\n        this.buffer = new Int32Array(capacity);\r\n    } else if (dtype == \"float32\") {\r\n        this.buffer = new Float32Array(capacity);\r\n    } else if (dtype == \"float64\") {\r\n        this.buffer = new Float64Array(capacity);\r\n    } else {\r\n        console.log(\"ERROR: unsupported type \" + dtype);\r\n    }\r\n}\r\n\r\nBuffer.prototype.append = function(buf) {\r\n    if (this.len + buf.length >= this.capacity) {\r\n        var newCap = Math.floor(this.capacity * 1.5);\r\n        var tmp = new (this.buffer.constructor)(newCap);\r\n        tmp.set(this.buffer);\r\n\r\n        this.capacity = newCap;\r\n        this.buffer = tmp;\r\n    }\r\n    this.buffer.set(buf, this.len);\r\n    this.len += buf.length;\r\n}\r\n\r\nBuffer.prototype.clear = function() {\r\n    this.len = 0;\r\n}\r\n\r\nBuffer.prototype.stride = function() {\r\n    return this.buffer.BYTES_PER_ELEMENT;\r\n}\r\n\r\nBuffer.prototype.view = function(offset, length) {\r\n    return new (this.buffer.constructor)(this.buffer.buffer, offset, length);\r\n}\r\n\r\n// Various utilities that don't really fit anywhere else\r\n\r\n// Parse the hex string to RGB values in [0, 255]\r\nvar hexToRGB = function(hex) {\r\n    var val = parseInt(hex.substr(1), 16);\r\n    var r = (val >> 16) & 255;\r\n    var g = (val >> 8) & 255;\r\n    var b = val & 255;\r\n    return [r, g, b];\r\n}\r\n\r\n// Parse the hex string to RGB values in [0, 1]\r\nvar hexToRGBf = function(hex) {\r\n    var c = hexToRGB(hex);\r\n    return [c[0] / 255.0, c[1] / 255.0, c[2] / 255.0];\r\n}\r\n\r\n/* The controller can register callbacks for various events on a canvas:\r\n *\r\n * mousemove: function(prevMouse, curMouse, evt)\r\n *     receives both regular mouse events, and single-finger drags (sent as a left-click),\r\n *\r\n * press: function(curMouse, evt)\r\n *     receives mouse click and touch start events\r\n *\r\n * wheel: function(amount)\r\n *     mouse wheel scrolling\r\n *\r\n * pinch: function(amount)\r\n *     two finger pinch, receives the distance change between the fingers\r\n *\r\n * twoFingerDrag: function(dragVector)\r\n *     two finger drag, receives the drag movement amount\r\n */\r\nvar Controller = function(camera) {\r\n    this.camera = camera;\r\n    this.mousemove = null;\r\n    this.press = null;\r\n    this.wheel = null;\r\n    this.twoFingerDrag = null;\r\n    this.pinch = null;\r\n}\r\n\r\nController.prototype.registerForCanvas = function(canvas) {\r\n    var prevMouse = null;\r\n    var mouseState = [false, false];\r\n    var self = this;\r\n    canvas.addEventListener(\"mousemove\", function(evt) {\r\n        evt.preventDefault();\r\n        var rect = canvas.getBoundingClientRect();\r\n        var curMouse = [evt.clientX - rect.left, evt.clientY - rect.top];\r\n        if (!prevMouse) {\r\n            prevMouse = [evt.clientX - rect.left, evt.clientY - rect.top];\r\n        } else if (self.mousemove) {\r\n            self.mousemove(prevMouse, curMouse, evt);\r\n        }\r\n        prevMouse = curMouse;\r\n    });\r\n\r\n    canvas.addEventListener(\"mousedown\", function(evt) {\r\n        evt.preventDefault();\r\n        var rect = canvas.getBoundingClientRect();\r\n        var curMouse = [evt.clientX - rect.left, evt.clientY - rect.top];\r\n        if (self.press) {\r\n            self.press(curMouse, evt);\r\n        }\r\n    });\r\n\r\n    canvas.addEventListener(\"wheel\", function(evt) {\r\n        evt.preventDefault();\r\n        if (self.wheel) {\r\n            self.wheel(-evt.deltaY);\r\n        }\r\n    });\r\n\r\n    canvas.oncontextmenu = function (evt) {\r\n        evt.preventDefault();\r\n    };\r\n\r\n    var touches = {};\r\n    canvas.addEventListener(\"touchstart\", function(evt) {\r\n        var rect = canvas.getBoundingClientRect();\r\n        evt.preventDefault();\r\n        for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n            var t = evt.changedTouches[i];\r\n            touches[t.identifier] = [t.clientX - rect.left, t.clientY - rect.top];\r\n            if (evt.changedTouches.length == 1 && self.press) {\r\n                self.press(touches[t.identifier], evt);\r\n            }\r\n        }\r\n    });\r\n\r\n    canvas.addEventListener(\"touchmove\", function(evt) {\r\n        evt.preventDefault();\r\n        var rect = canvas.getBoundingClientRect();\r\n        var numTouches = Object.keys(touches).length;\r\n        // Single finger to rotate the camera\r\n        if (numTouches == 1) {\r\n            if (self.mousemove) {\r\n                var t = evt.changedTouches[0];\r\n                var prevTouch = touches[t.identifier];\r\n                var curTouch = [t.clientX - rect.left, t.clientY - rect.top];\r\n                evt.buttons = 1;\r\n                self.mousemove(prevTouch, curTouch, evt);\r\n            }\r\n        } else {\r\n            var curTouches = {};\r\n            for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n                var t = evt.changedTouches[i];\r\n                curTouches[t.identifier] = [t.clientX - rect.left, t.clientY - rect.top];\r\n            }\r\n\r\n            // If some touches didn't change make sure we have them in\r\n            // our curTouches list to compute the pinch distance\r\n            // Also get the old touch points to compute the distance here\r\n            var oldTouches = [];\r\n            for (t in touches) {\r\n                if (!(t in curTouches)) {\r\n                    curTouches[t] = touches[t];\r\n                }\r\n                oldTouches.push(touches[t]);\r\n            }\r\n\r\n            var newTouches = [];\r\n            for (t in curTouches) {\r\n                newTouches.push(curTouches[t]);\r\n            }\r\n\r\n            // Determine if the user is pinching or panning\r\n            var motionVectors = [\r\n                vec2.set(vec2.create(), newTouches[0][0] - oldTouches[0][0],\r\n                    newTouches[0][1] - oldTouches[0][1]),\r\n                vec2.set(vec2.create(), newTouches[1][0] - oldTouches[1][0],\r\n                    newTouches[1][1] - oldTouches[1][1])\r\n            ];\r\n            var motionDirs = [vec2.create(), vec2.create()];\r\n            vec2.normalize(motionDirs[0], motionVectors[0]);\r\n            vec2.normalize(motionDirs[1], motionVectors[1]);\r\n\r\n            var pinchAxis = vec2.set(vec2.create(), oldTouches[1][0] - oldTouches[0][0],\r\n                oldTouches[1][1] - oldTouches[0][1]);\r\n            vec2.normalize(pinchAxis, pinchAxis);\r\n\r\n            var panAxis = vec2.lerp(vec2.create(), motionVectors[0], motionVectors[1], 0.5);\r\n            vec2.normalize(panAxis, panAxis);\r\n\r\n            var pinchMotion = [\r\n                vec2.dot(pinchAxis, motionDirs[0]),\r\n                vec2.dot(pinchAxis, motionDirs[1])\r\n            ];\r\n            var panMotion = [\r\n                vec2.dot(panAxis, motionDirs[0]),\r\n                vec2.dot(panAxis, motionDirs[1])\r\n            ];\r\n\r\n            // If we're primarily moving along the pinching axis and in the opposite direction with\r\n            // the fingers, then the user is zooming.\r\n            // Otherwise, if the fingers are moving along the same direction they're panning\r\n            if (self.pinch && Math.abs(pinchMotion[0]) > 0.5 && Math.abs(pinchMotion[1]) > 0.5\r\n                && Math.sign(pinchMotion[0]) != Math.sign(pinchMotion[1]))\r\n            {\r\n                // Pinch distance change for zooming\r\n                var oldDist = pointDist(oldTouches[0], oldTouches[1]);\r\n                var newDist = pointDist(newTouches[0], newTouches[1]);\r\n                self.pinch(newDist - oldDist);\r\n            } else if (self.twoFingerDrag && Math.abs(panMotion[0]) > 0.5 && Math.abs(panMotion[1]) > 0.5\r\n                && Math.sign(panMotion[0]) == Math.sign(panMotion[1]))\r\n            {\r\n                // Pan by the average motion of the two fingers\r\n                var panAmount = vec2.lerp(vec2.create(), motionVectors[0], motionVectors[1], 0.5);\r\n                panAmount[1] = -panAmount[1];\r\n                self.twoFingerDrag(panAmount);\r\n            }\r\n        }\r\n\r\n        // Update the existing list of touches with the current positions\r\n        for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n            var t = evt.changedTouches[i];\r\n            touches[t.identifier] = [t.clientX - rect.left, t.clientY - rect.top];\r\n        }\r\n    });\r\n\r\n    var touchEnd = function(evt) {\r\n        evt.preventDefault();\r\n        for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n            var t = evt.changedTouches[i];\r\n            delete touches[t.identifier];\r\n        }\r\n    }\r\n    canvas.addEventListener(\"touchcancel\", touchEnd);\r\n    canvas.addEventListener(\"touchend\", touchEnd);\r\n}\r\n\r\nexport {\r\n    Frustum,\r\n    Shader,\r\n    ArcballCamera,\r\n    Controller,\r\n}","// Code from https://github.com/Twinklebear/webgl-volume-raycaster\r\n// blog: https://www.willusher.io/webgl/2019/01/13/volume-rendering-with-webgl\r\n\r\nexport const vertShader =\r\n`#version 300 es\r\n#line 4\r\nlayout(location=0) in vec3 pos;\r\nuniform mat4 proj_view;\r\nuniform vec3 eye_pos;\r\nuniform vec3 volume_scale;\r\n\r\nout vec3 vray_dir;\r\nflat out vec3 transformed_eye;\r\n\r\nvoid main(void) {\r\n\t// TODO: For non-uniform size volumes we need to transform them differently as well\r\n\t// to center them properly\r\n\tvec3 volume_translation = vec3(0.5) - volume_scale * 0.5;\r\n\tgl_Position = proj_view * vec4(pos * volume_scale + volume_translation, 1);\r\n\ttransformed_eye = (eye_pos - volume_translation) / volume_scale;\r\n\tvray_dir = pos - transformed_eye;\r\n}`;\r\n\r\nexport const fragShader =\r\n`#version 300 es\r\n#line 24\r\nprecision highp int;\r\nprecision highp float;\r\nuniform highp sampler3D volume;\r\nuniform highp sampler2D colormap;\r\nuniform ivec3 volume_dims;\r\nuniform float dt_scale;\r\n\r\nin vec3 vray_dir;\r\nflat in vec3 transformed_eye;\r\nout vec4 color;\r\n\r\nvec2 intersect_box(vec3 orig, vec3 dir) {\r\n\tconst vec3 box_min = vec3(0);\r\n\tconst vec3 box_max = vec3(1);\r\n\tvec3 inv_dir = 1.0 / dir;\r\n\tvec3 tmin_tmp = (box_min - orig) * inv_dir;\r\n\tvec3 tmax_tmp = (box_max - orig) * inv_dir;\r\n\tvec3 tmin = min(tmin_tmp, tmax_tmp);\r\n\tvec3 tmax = max(tmin_tmp, tmax_tmp);\r\n\tfloat t0 = max(tmin.x, max(tmin.y, tmin.z));\r\n\tfloat t1 = min(tmax.x, min(tmax.y, tmax.z));\r\n\treturn vec2(t0, t1);\r\n}\r\n\r\n// Pseudo-random number gen from\r\n// http://www.reedbeta.com/blog/quick-and-easy-gpu-random-numbers-in-d3d11/\r\n// with some tweaks for the range of values\r\nfloat wang_hash(int seed) {\r\n\tseed = (seed ^ 61) ^ (seed >> 16);\r\n\tseed *= 9;\r\n\tseed = seed ^ (seed >> 4);\r\n\tseed *= 0x27d4eb2d;\r\n\tseed = seed ^ (seed >> 15);\r\n\treturn float(seed % 2147483647) / float(2147483647);\r\n}\r\n\r\nfloat linear_to_srgb(float x) {\r\n\tif (x <= 0.0031308f) {\r\n\t\treturn 12.92f * x;\r\n\t}\r\n\treturn 1.055f * pow(x, 1.f / 2.4f) - 0.055f;\r\n}\r\n\r\nvoid main(void) {\r\n\tvec3 ray_dir = normalize(vray_dir);\r\n\tvec2 t_hit = intersect_box(transformed_eye, ray_dir);\r\n\tif (t_hit.x > t_hit.y) {\r\n\t\tdiscard;\r\n\t}\r\n\tt_hit.x = max(t_hit.x, 0.0);\r\n\tvec3 dt_vec = 1.0 / (vec3(volume_dims) * abs(ray_dir));\r\n\tfloat dt = dt_scale * min(dt_vec.x, min(dt_vec.y, dt_vec.z));\r\n\tfloat offset = wang_hash(int(gl_FragCoord.x + 640.0 * gl_FragCoord.y));\r\n\tvec3 p = transformed_eye + (t_hit.x + offset * dt) * ray_dir;\r\n\tfor (float t = t_hit.x; t < t_hit.y; t += dt) {\r\n\t\tfloat val = texture(volume, p).r;\r\n\t\tvec4 val_color = vec4(texture(colormap, vec2(val, 0.5)).rgb, val);\r\n\t\t// Opacity correction\r\n\t\tval_color.a = 1.0 - pow(1.0 - val_color.a, dt_scale);\r\n\t\tcolor.rgb += (1.0 - color.a) * val_color.a * val_color.rgb;\r\n\t\tcolor.a += (1.0 - color.a) * val_color.a;\r\n\t\tif (color.a >= 0.95) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tp += ray_dir * dt;\r\n\t}\r\n    color.r = linear_to_srgb(color.r);\r\n    color.g = linear_to_srgb(color.g);\r\n    color.b = linear_to_srgb(color.b);\r\n}`;\r\n\r\n","// Fenced code from: https://github.com/Twinklebear/webgl-volume-raycaster\r\n\r\nimport React, { Component } from 'react'\r\nimport { connect, ConnectedProps } from 'react-redux'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { fetch_data_cache } from '../../api'\r\n\r\nimport { selectors } from '../'\r\nimport { apply_green_LUT } from '../helpers'\r\n\r\nimport { mat4, vec3 } from '../webgl/gl-matrix'\r\nimport { ArcballCamera, Shader, Controller } from '../webgl/webgl-util'\r\nimport { fragShader, vertShader } from '../webgl/shader-srcs'\r\n\r\nconst cubeStrip = [\r\n  1, 1, 0,\r\n  0, 1, 0,\r\n  1, 1, 1,\r\n  0, 1, 1,\r\n  0, 0, 1,\r\n  0, 1, 0,\r\n  0, 0, 0,\r\n  1, 1, 0,\r\n  1, 0, 0,\r\n  1, 1, 1,\r\n  1, 0, 1,\r\n  0, 0, 1,\r\n  1, 0, 0,\r\n  0, 0, 0\r\n];\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    shape_x: selectors.get_shape_x(state),\r\n    shape_y: selectors.get_shape_y(state),\r\n    shape_z: selectors.get_shape_z(state),\r\n    scale_x: selectors.get_scale_x(state),\r\n    scale_y: selectors.get_scale_y(state),\r\n    scale_z: selectors.get_scale_z(state),\r\n    height: (selectors.get_shape_y(state) * selectors.get_scale_y(state)\r\n      + selectors.get_shape_z(state) * selectors.get_scale_z(state)),\r\n    width: (selectors.get_shape_x(state) * selectors.get_scale_x(state)\r\n      + selectors.get_shape_z(state) * selectors.get_scale_z(state)),\r\n    data_url: selectors.get_vol_url(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_y(state),\r\n    z: selectors.get_z(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps)\r\n\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\ntype VolumeView_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\ntype VolumeView_state_t = {\r\n  data: Uint8ClampedArray | null\r\n}\r\n\r\nclass _VolumeView\r\n  extends Component<VolumeView_props_t, VolumeView_state_t> {\r\n\r\n  state: VolumeView_state_t\r\n  abort_controller: AbortController\r\n\r\n  // Begin from volume-raycaster.js\r\n\r\n  canvas: HTMLCanvasElement | null = null\r\n  gl: WebGL2RenderingContext | null = null\r\n  shader: Shader | null = null\r\n  volumeTexture: WebGLTexture | null = null\r\n  proj: mat4 = mat4.create()\r\n  camera = new ArcballCamera(vec3.create(), vec3.create(), vec3.create(), 2,\r\n    [500, 500])\r\n  projView = mat4.create()\r\n  targetFrameTime = 50\r\n  samplingRate = 1.0\r\n  WIDTH = 640\r\n  HEIGHT = 480\r\n\r\n  static readonly defaultEye = vec3.set(vec3.create(), 0.5, 0.5, 1.5)\r\n  static readonly center = vec3.set(vec3.create(), 0.5, 0.5, 0.5)\r\n  static readonly up = vec3.set(vec3.create(), 0.0, 1.0, 0.0)\r\n\r\n  // End from volume-raycaster.js\r\n\r\n  constructor(props: VolumeView_props_t) {\r\n    super(props)\r\n    this.abort_controller = new AbortController()\r\n    this.state = {\r\n      data: null,\r\n    }\r\n\r\n    // Begin from volume-raycaster.js\r\n\r\n    this.WIDTH = props.width\r\n    this.HEIGHT = props.height\r\n    this.proj = mat4.perspective(mat4.create(), 60 * Math.PI / 180.0,\r\n      this.WIDTH / this.HEIGHT, 0.1, 100)\r\n\r\n    this.camera = new ArcballCamera(\r\n      _VolumeView.defaultEye, _VolumeView.center, _VolumeView.up,\r\n      2,\r\n      [this.WIDTH, this.HEIGHT])\r\n\r\n    // End from volume-raycaster.js\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    this.canvas = this.refs.canvas as HTMLCanvasElement\r\n    this.gl = this.canvas.getContext(\"webgl2\") as WebGL2RenderingContext\r\n\r\n    const gl = this.gl\r\n\r\n    const controller = new Controller(this.camera);\r\n    controller.mousemove = function (prev: number[], cur: number[],\r\n      evt: MouseEvent) {\r\n\r\n      if (evt.buttons === 1) {\r\n        this.camera.rotate(prev, cur);\r\n\r\n      } else if (evt.buttons === 2) {\r\n        this.camera.pan([cur[0] - prev[0], prev[1] - cur[1]]);\r\n      }\r\n    };\r\n    controller.wheel = function (amt: number) { this.camera.zoom(amt); };\r\n    controller.pinch = controller.wheel;\r\n    controller.twoFingerDrag = function (drag: number) {\r\n      this.camera.pan(drag);\r\n    }\r\n    controller.registerForCanvas(this.canvas);\r\n\r\n    const vao = gl.createVertexArray();\r\n    gl.bindVertexArray(vao);\r\n\r\n    var vbo = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\r\n    gl.bufferData(gl.ARRAY_BUFFER,\r\n      new Float32Array(cubeStrip), gl.STATIC_DRAW);\r\n\r\n    gl.enableVertexAttribArray(0);\r\n    gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 0, 0);\r\n\r\n    this.shader = new Shader(gl, vertShader, fragShader);\r\n    this.shader.use(gl);\r\n\r\n    // @ts-ignore Property 'volume' does not exist on type '{}'\r\n    gl.uniform1i(this.shader.uniforms[\"volume\"], 0);\r\n    // @ts-ignore\r\n    gl.uniform1i(this.shader.uniforms[\"colormap\"], 1);\r\n    // @ts-ignore\r\n    gl.uniform1f(this.shader.uniforms[\"dt_scale\"], this.samplingRate);\r\n\r\n    // Setup required OpenGL state for drawing the back faces and\r\n    // composting with the background color\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.cullFace(gl.FRONT);\r\n    gl.enable(gl.BLEND);\r\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    // Load the default colormap and upload it, then draw the volume.\r\n    const colormapImage = new Image();\r\n    colormapImage.onload = ((gl, draw) => function () {\r\n      var colormap = gl.createTexture();\r\n      gl.activeTexture(gl.TEXTURE1);\r\n      gl.bindTexture(gl.TEXTURE_2D, colormap);\r\n      gl.texStorage2D(gl.TEXTURE_2D, 1, gl.SRGB8_ALPHA8, 180, 1);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_R, gl.CLAMP_TO_EDGE);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n      gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, 180, 1,\r\n        gl.RGBA, gl.UNSIGNED_BYTE, colormapImage);\r\n\r\n      draw();\r\n    })(gl, this.draw_to_canvas)\r\n    colormapImage.src = \"webgl_colormaps/samsel-linear-green.png\";\r\n\r\n    // End from volume-raycaster.js\r\n\r\n    this.fetch_and_draw()\r\n\r\n  }\r\n\r\n  componentDidUpdate(prev_props: VolumeView_props_t) {\r\n    if (this.props.data_url !== prev_props.data_url)\r\n      this.fetch_and_draw()\r\n    else if (this.props.LUT !== prev_props.LUT)\r\n      this.draw_to_canvas()\r\n  }\r\n\r\n  fetch_and_draw = () => {\r\n\r\n    this.abort_controller.abort()\r\n    this.abort_controller = new AbortController()\r\n\r\n    fetch_data_cache(this.props.data_url, this.abort_controller.signal)\r\n      .then(data => this.setState({ data }))\r\n      .then(this.draw_to_canvas)\r\n  }\r\n\r\n  draw_to_canvas = () => {\r\n\r\n    if ((this.state.data === null) ||\r\n      (this.state.data === undefined) ||\r\n      (this.props.width === 0) ||\r\n      (this.props.height === 0) ||\r\n      (this.gl === null) ||\r\n      (this.camera === null)) {\r\n\r\n      return\r\n    }\r\n\r\n    const gl = this.gl\r\n    const volDims = [\r\n      this.props.shape_x,\r\n      this.props.shape_y,\r\n      this.props.shape_z\r\n    ]\r\n\r\n    const LUTdata = apply_green_LUT(this.state.data, this.props.LUT)\r\n\r\n    const tex = gl.createTexture();\r\n\r\n    gl.activeTexture(gl.TEXTURE0);\r\n    gl.bindTexture(gl.TEXTURE_3D, tex);\r\n    gl.texStorage3D(gl.TEXTURE_3D, 1, gl.R8, volDims[0], volDims[1], volDims[2]);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_R, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texSubImage3D(gl.TEXTURE_3D, 0, 0, 0, 0,\r\n      volDims[0], volDims[1], volDims[2],\r\n      gl.RED, gl.UNSIGNED_BYTE, LUTdata);\r\n\r\n    var longestAxis = Math.max(volDims[0], Math.max(volDims[1], volDims[2]));\r\n    var volScale = [\r\n      volDims[0] / longestAxis * this.props.scale_x,\r\n      volDims[1] / longestAxis * this.props.scale_y,\r\n      volDims[2] / longestAxis * this.props.scale_z,\r\n    ]\r\n\r\n    // @ts-ignore Property 'volume_dims' does not exist on type '{}'\r\n    gl.uniform3iv(this.shader.uniforms[\"volume_dims\"], volDims)\r\n    // @ts-ignore Property 'volume_scale' does not exist on type '{}'\r\n    gl.uniform3fv(this.shader.uniforms[\"volume_scale\"], volScale)\r\n\r\n    if (!this.volumeTexture) {\r\n      this.volumeTexture = tex;\r\n      setInterval(() => {\r\n\r\n        // Save them some battery if they're not viewing the tab\r\n        if (document.hidden) {\r\n          return;\r\n        }\r\n        const startTime = new Date()\r\n        gl.clearColor(0.0, 0.0, 0.0, 1.0)\r\n        gl.clear(gl.COLOR_BUFFER_BIT)\r\n\r\n        this.projView = mat4.mul(this.projView as mat4, this.proj,\r\n          this.camera.camera);\r\n\r\n        // @ts-ignore Property 'proj_view' does not exist on type '{}'\r\n        gl.uniformMatrix4fv(this.shader.uniforms[\"proj_view\"],\r\n          false,\r\n          this.projView)\r\n\r\n        var eye = [this.camera.invCamera[12],\r\n        this.camera.invCamera[13],\r\n        this.camera.invCamera[14]]\r\n\r\n        // @ts-ignore Property 'eye_pos' does not exist on type '{}'\r\n        gl.uniform3fv(this.shader.uniforms[\"eye_pos\"], eye);\r\n\r\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, cubeStrip.length / 3);\r\n        // Wait for rendering to actually finish\r\n        gl.finish()\r\n\r\n        const endTime = new Date();\r\n        const renderTime = (endTime.getTime() - startTime.getTime())\r\n        const targetSamplingRate = renderTime / this.targetFrameTime\r\n        if (this.samplingRate < targetSamplingRate) {\r\n          this.samplingRate = (\r\n            0.8 * this.samplingRate +\r\n            0.2 * targetSamplingRate)\r\n          // @ts-ignore\r\n          gl.uniform1f(this.shader.uniforms[\"dt_scale\"], this.samplingRate);\r\n        }\r\n\r\n      }, this.targetFrameTime)\r\n    }\r\n    else {\r\n      gl.deleteTexture(this.volumeTexture);\r\n      this.volumeTexture = tex;\r\n    }\r\n\r\n  }\r\n\r\n  render() {\r\n\r\n    return (\r\n      <div style={{\r\n        position: \"relative\",\r\n        left: this.props.left,\r\n        top: this.props.top,\r\n        right: \"0px\",\r\n      }}>\r\n\r\n        <canvas ref=\"canvas\"\r\n          width={this.props.width}\r\n          height={this.props.height}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            top: \"0px\",\r\n            zIndex: 1,\r\n          }}>\r\n        </canvas>\r\n\r\n      </div>)\r\n  }\r\n}\r\n\r\nexport const VolumeView = connector(_VolumeView)\r\n","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\n\r\nimport { Slider } from '@material-ui/core';\r\n\r\nimport { AppDispatch_t } from '../../index'\r\nimport { actions } from '../actions'\r\nimport * as selectors from '../selectors'\r\nimport { saga_actions as annotations_saga_actions } from '../../annotations'\r\nimport { selectors as annotations_selectors } from '../../annotations'\r\nimport { State_t } from '../../app/model'\r\nimport { AnnotationViewZ, AnnotationViewX, AnnotationViewY }\r\n  from './AnnovationView'\r\nimport { AnnotationPanel } from '../../annotations'\r\nimport { saga_actions } from '../sagas'\r\nimport WindowPanel from './WindowPanel'\r\nimport { WorldlinesPanel } from '../../worldlines'\r\nimport { VolumeView } from './VolumeView';\r\n\r\nconst XYZSliderBase = (props: {\r\n  left: number,\r\n  top: number,\r\n  length: number,\r\n  flip: boolean,\r\n  orientation: \"horizontal\" | \"vertical\",\r\n  val: number,\r\n  handler: (x: number) => any\r\n}) => {\r\n\r\n  return <Slider\r\n    style={{\r\n      position: \"absolute\",\r\n      left: props.left,\r\n      top: props.top,\r\n      width: (props.orientation === \"horizontal\") ? props.length : 0,\r\n      height: (props.orientation === \"vertical\") ? props.length : 0\r\n    }}\r\n    color=\"primary\"\r\n    orientation={props.orientation}\r\n    defaultValue={0.5}\r\n    value={props.flip ? (1 - props.val) : props.val}\r\n    min={0}\r\n    max={1}\r\n    step={0.0001}\r\n    track={false}\r\n    scale={props.flip ? (x) => (1 - x) : (x) => x}\r\n    onChange={(e, v) => props.handler(props.flip ?\r\n      1 - (v as number) : (v as number))} />\r\n}\r\n\r\nconst TSliderBase = (props: {\r\n  left: number,\r\n  top: number,\r\n  length: number,\r\n  val: number,\r\n  max_val: number,\r\n  handler: (x: number) => any\r\n}) => {\r\n\r\n  return <Slider\r\n    style={{\r\n      position: \"absolute\",\r\n      left: props.left,\r\n      top: props.top,\r\n      width: props.length,\r\n    }}\r\n    color=\"secondary\"\r\n    orientation=\"horizontal\"\r\n    defaultValue={0}\r\n    value={props.val}\r\n    min={0}\r\n    max={props.max_val}\r\n    track={false}\r\n    step={1}\r\n    onChange={(e, v) => props.handler(v as number)} />\r\n}\r\n\r\nconst LUTSliderBase = (props: {\r\n  left: number,\r\n  top: number,\r\n  length: number,\r\n  color: string,\r\n  val: [number, number],\r\n  handler: (x: [number, number]) => any\r\n}) => {\r\n  const [value, setValue] = React.useState<number[]>([0, 255]);\r\n\r\n  const handleChange = (event: any, newValue: number | number[]) => {\r\n    setValue(newValue as number[]);\r\n    props.handler(newValue as [number, number])\r\n  };\r\n\r\n  return (\r\n\r\n    <Slider\r\n      style={{\r\n        position: \"absolute\",\r\n        left: props.left,\r\n        top: props.top,\r\n        width: props.length,\r\n        color: props.color,\r\n      }}\r\n      value={value}\r\n      min={0}\r\n      max={255}\r\n      onChange={handleChange}\r\n      valueLabelDisplay=\"auto\"\r\n    />\r\n\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    window_state: selectors.get_state(state),\r\n    annotations_z: annotations_selectors.get_z_annotations(state),\r\n    annotations_3D: annotations_selectors.get_annotations_view3D(state),\r\n    size_x: selectors.get_shape_x(state) * selectors.get_scale_x(state),\r\n    size_y: selectors.get_shape_y(state) * selectors.get_scale_y(state),\r\n    size_z: selectors.get_shape_z(state) * selectors.get_scale_z(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_y(state),\r\n    z: selectors.get_z(state),\r\n    t_idx: selectors.get_t_idx(state),\r\n    shape_t: selectors.get_shape_t(state),\r\n    LUT: selectors.get_LUT(state),\r\n    view: selectors.get_view(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    actions: bindActionCreators({ ...actions }, dispatch),\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n    delete_annotation: () => dispatch(\r\n      annotations_saga_actions.delete_annotation()),\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype AnnotationWindow_props_t = ReduxProps_t & {\r\n}\r\n\r\nconst _AnnotationWindow = (props: AnnotationWindow_props_t) => {\r\n\r\n  const origin_left = 20;\r\n  const origin_top = 20;\r\n  const padding_1 = 10;\r\n\r\n  const x_image_left = origin_left + props.size_x + padding_1;\r\n  const x_image_top = origin_top;\r\n\r\n  const y_image_left = origin_left;\r\n  const y_image_top = origin_top + props.size_y + padding_1;\r\n\r\n  const x_slider_left = origin_left;\r\n  const x_slider_top = y_image_top + props.size_z;\r\n\r\n  const y_slider_left = x_image_left + props.size_z + 2 * padding_1;\r\n  const y_slider_top = origin_top;\r\n\r\n  const z_slider_1_left = x_image_left;\r\n  const z_slider_1_top = x_slider_top;\r\n\r\n  const z_slider_2_left = y_slider_left;\r\n  const z_slider_2_top = y_slider_top + y_image_top - origin_top;\r\n\r\n  const t_slider_left = origin_left\r\n  const t_slider_top = x_slider_top + 2 * padding_1\r\n  const t_slider_length = props.size_x + props.size_z + padding_1\r\n\r\n  const annotation_panel_top = origin_top\r\n  const annotation_panel_left = y_slider_left + 5 * padding_1\r\n\r\n  const LUT_slider_length = t_slider_length / 3 - 2 * padding_1\r\n  const LUT_top = t_slider_top + 5 * padding_1\r\n  const LUT_R_left = origin_left\r\n  const LUT_G_left = LUT_R_left + LUT_slider_length + 5 * padding_1\r\n  const LUT_B_left = LUT_G_left + LUT_slider_length + 5 * padding_1\r\n\r\n  const window_panel_left = origin_left\r\n  const window_panel_top = LUT_top + 5 * padding_1\r\n\r\n  const worldlines_panel_left = annotation_panel_left\r\n  const worldlines_panel_top = annotation_panel_top + 330\r\n\r\n  let views\r\n  if (props.view === \"vol\") {\r\n    views = (\r\n      <VolumeView\r\n        left={origin_left}\r\n        top={origin_top} />\r\n    )\r\n  }\r\n  else {\r\n    views = (\r\n      <React.Fragment>\r\n        <AnnotationViewZ left={origin_left} top={origin_top} />\r\n        <AnnotationViewX left={x_image_left} top={x_image_top} />\r\n        <AnnotationViewY left={y_image_left} top={y_image_top} />\r\n      </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const XSlider =\r\n    <XYZSliderBase\r\n      left={x_slider_left}\r\n      top={x_slider_top}\r\n      length={props.size_x}\r\n      orientation=\"horizontal\"\r\n      flip={false}\r\n      val={props.x}\r\n      handler={props.actions.set_x} />\r\n\r\n  const YSlider =\r\n    <XYZSliderBase\r\n      left={y_slider_left}\r\n      top={y_slider_top}\r\n      length={props.size_y}\r\n      orientation=\"vertical\"\r\n      flip={true}\r\n      val={props.y}\r\n      handler={props.actions.set_y} />\r\n\r\n  const ZSlider1 =\r\n    <XYZSliderBase\r\n      left={z_slider_1_left}\r\n      top={z_slider_1_top}\r\n      length={props.size_z}\r\n      orientation=\"horizontal\"\r\n      flip={false}\r\n      val={props.z}\r\n      handler={props.actions.set_z} />\r\n\r\n  const ZSlider2 =\r\n    <XYZSliderBase\r\n      left={z_slider_2_left}\r\n      top={z_slider_2_top}\r\n      length={props.size_z}\r\n      orientation=\"vertical\"\r\n      flip={true}\r\n      val={props.z}\r\n      handler={props.actions.set_z} />\r\n\r\n  const TSlider =\r\n    <TSliderBase\r\n      left={t_slider_left}\r\n      top={t_slider_top}\r\n      length={t_slider_length}\r\n      val={props.t_idx}\r\n      max_val={props.shape_t - 1}\r\n      handler={props.actions.set_t_idx} />\r\n\r\n  const LUTSliderRed =\r\n    <LUTSliderBase\r\n      left={LUT_R_left}\r\n      top={LUT_top}\r\n      length={LUT_slider_length}\r\n      val={props.LUT.red}\r\n      color=\"red\"\r\n      handler={([l, h]) => props.actions.set_LUT_color([\"red\", l, h])} />\r\n  const LUTSliderGreen =\r\n    <LUTSliderBase\r\n      left={LUT_G_left}\r\n      top={LUT_top}\r\n      length={LUT_slider_length}\r\n      val={props.LUT.green}\r\n      color=\"green\"\r\n      handler={([l, h]) => props.actions.set_LUT_color([\"green\", l, h])} />\r\n  const LUTSliderBlue =\r\n    <LUTSliderBase\r\n      left={LUT_B_left}\r\n      top={LUT_top}\r\n      length={LUT_slider_length}\r\n      val={props.LUT.blue}\r\n      color=\"blue\"\r\n      handler={([l, h]) => props.actions.set_LUT_color([\"blue\", l, h])} />\r\n\r\n\r\n  const keydown_handler = (event: React.KeyboardEvent) => {\r\n\r\n    const key = String.fromCharCode(event.which)\r\n    const ctrl = event.ctrlKey\r\n    const shift = event.shiftKey\r\n\r\n    switch (key) {\r\n      case \"F\": {\r\n        if (shift) props.saga_actions.adjust_t(10)\r\n        else props.saga_actions.adjust_t(1)\r\n        break;\r\n      }\r\n      case \"D\": {\r\n        if (shift) props.saga_actions.adjust_t(-10)\r\n        else props.saga_actions.adjust_t(-1)\r\n        break;\r\n      }\r\n      case \"V\": {\r\n        if (shift) props.actions.set_z(props.z + 0.2)\r\n        else if (ctrl) props.actions.set_z(props.z + 0.02)\r\n        else props.actions.set_z(props.z + 0.05)\r\n        break;\r\n      }\r\n      case \"C\": {\r\n        if (shift) props.actions.set_z(props.z - 0.2)\r\n        else if (ctrl) props.actions.set_z(props.z - 0.01)\r\n        else props.actions.set_z(props.z - 0.05)\r\n        break;\r\n      }\r\n      case \"R\": {\r\n        props.actions.adjust_c_idx(1)\r\n        break\r\n      }\r\n      case \"E\": {\r\n        props.actions.adjust_c_idx(-1)\r\n        break\r\n      }\r\n      case \".\": {\r\n        props.delete_annotation()\r\n        break\r\n      }\r\n      case \"S\": {\r\n        if (ctrl) props.saga_actions.save()\r\n        break\r\n      }\r\n      case \"O\": {\r\n        props.actions.toggle_fill_circles()\r\n        break\r\n      }\r\n      case \"A\": {\r\n        props.actions.toggle_all_annotations()\r\n        break\r\n      }\r\n      case \"1\":\r\n      case \"2\":\r\n      case \"3\":\r\n      case \"4\":\r\n      case \"5\":\r\n      case \"6\":\r\n      case \"7\":\r\n      case \"8\":\r\n      case \"9\":\r\n      case \"0\":\r\n        if (!ctrl && !shift) props.saga_actions.rpc_from_key(key)\r\n        break\r\n    }\r\n\r\n    event.preventDefault()\r\n  }\r\n\r\n  const keyup_handler = (event: React.KeyboardEvent) => {\r\n    //const key = String.fromCharCode(event.which)\r\n  }\r\n\r\n  return (\r\n    <div style={{ position: \"absolute\" }}>\r\n      <div tabIndex={0}\r\n        onKeyDown={keydown_handler}\r\n        onKeyUp={keyup_handler}>\r\n\r\n        {views}\r\n\r\n        {XSlider}\r\n        {YSlider}\r\n        {ZSlider1}\r\n        {ZSlider2}\r\n        {TSlider}\r\n\r\n        {LUTSliderRed}\r\n        {LUTSliderGreen}\r\n        {LUTSliderBlue}\r\n\r\n      </div>\r\n\r\n      <AnnotationPanel\r\n        left={annotation_panel_left}\r\n        top={annotation_panel_top} />\r\n\r\n      <WindowPanel\r\n        left={window_panel_left}\r\n        top={window_panel_top} />\r\n\r\n      <WorldlinesPanel\r\n        left={worldlines_panel_left}\r\n        top={worldlines_panel_top} />\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nconst AnnotationWindow = connector(_AnnotationWindow)\r\n\r\nexport default AnnotationWindow","import React from 'react'\n\nimport { AnnotationWindow } from '../../annotation_window'\n\n\nconst App = () => {\n  return (\n    <div>\n      <AnnotationWindow />\n    </div>\n  );\n}\n\nexport default App","import { combineReducers } from 'redux'\r\n\r\nimport {\r\n  actions as annotation_window_actions,\r\n  reducer as annotation_window_reducer\r\n} from '../annotation_window'\r\n\r\nimport {\r\n  actions as annotations_actions,\r\n  reducer as annotations_reducer\r\n} from '../annotations'\r\n\r\nimport {\r\n  actions as worldlines_actions,\r\n  reducer as worldlines_reducer\r\n} from '../worldlines'\r\n\r\nexport const actions = {\r\n  annotation_window: annotation_window_actions,\r\n  annotations: annotations_actions,\r\n  worldlines: worldlines_actions,\r\n}\r\n\r\nexport const reducer = combineReducers({\r\n  annotation_window: annotation_window_reducer,\r\n  annotations: annotations_reducer,\r\n  worldlines: worldlines_reducer,\r\n});","import { all } from 'redux-saga/effects'\r\n\r\nimport {\r\n    sagas as annotation_window_sagas,\r\n    saga_actions as annotation_window_saga_actions,\r\n } from '../annotation_window'\r\n\r\n import {\r\n    sagas as annotations_sagas,\r\n    saga_actions as annotations_saga_actions,\r\n } from '../annotations'\r\n\r\n import {\r\n    sagas as worldlines_sagas,\r\n    saga_actions as worldlines_saga_actions,\r\n } from '../worldlines'\r\n\r\nexport function* saga() {\r\n    yield all([\r\n        ...annotation_window_sagas,\r\n        ...annotations_sagas,\r\n        ...worldlines_sagas,\r\n    ].map(f => f()))\r\n  }\r\n\r\nexport const saga_actions = {\r\n    annotation_window: annotation_window_saga_actions,\r\n    annotations: annotations_saga_actions,\r\n    worldlines: worldlines_saga_actions,\r\n}","/* This file should provide an interface to visualize the state and dispatch\r\nactions. UI and styling should be minimal. */\r\n\r\nimport React from 'react'\r\nimport { connect } from \"react-redux\"\r\nimport ReactJson from 'react-json-view'\r\n\r\nimport { actions } from '../actions'\r\nimport { saga_actions } from '../sagas'\r\nimport { State_t } from '../../app/model'\r\nimport { FloatForm } from '../../test_components/ActionForm'\r\n\r\nimport * as annotation_window_selectors\r\n  from '../../annotation_window/selectors'\r\n\r\nconst _Test = ({ state, x_idx, ...A }: any) => {\r\n\r\n  const derived_state = { x_idx }\r\n\r\n  const full_state = { bare_state: state, derived_state }\r\n\r\n  // const state_json = JSON.stringify(full_state, null, 4);\r\n\r\n  return (\r\n    <div>\r\n\r\n      {/* <pre><code>app: {state_json}</code></pre> */}\r\n      <ReactJson theme=\"monokai\" src={full_state} />\r\n\r\n      <br />\r\n\r\n      Simple Actions:\r\n      <FloatForm name=\"set_shape_x\" action={A.set_shape_x} />\r\n      <FloatForm name=\"set_x\" action={A.set_x} />\r\n      <FloatForm name=\"set_t_idx\" action={A.set_t_idx} />\r\n      <FloatForm name=\"adjust_x\" action={A.adjust_x} />\r\n      <FloatForm name=\"set_scale_x\" action={A.set_scale_x} />\r\n\r\n      <br />\r\n\r\n      Async Actions:\r\n      <br />\r\n\r\n      <button onClick={() => A.fetch_state()}>\r\n        fetch_state\r\n      </button>\r\n\r\n      <button onClick={() => A.insert_annotation_here()}>\r\n        insert_annotation\r\n      </button>\r\n\r\n      <FloatForm name=\"fetch_annotations\" action={A.get_annotations} />\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    state: state,\r\n    x_idx: annotation_window_selectors.get_x_idx(state)\r\n  }\r\n}\r\n\r\nconst AppTest =\r\n  connect(mapStateToProps,\r\n    { ...actions.annotation_window,\r\n      ...actions.annotations,\r\n      ...saga_actions.annotation_window,\r\n      ...saga_actions.annotations\r\n    })(_Test)\r\n\r\nexport default AppTest","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux'\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom'\nimport { configureStore, getDefaultMiddleware } from \"@reduxjs/toolkit\"\nimport createSagaMiddleware from 'redux-saga'\n\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles'\nimport { blue, pink } from '@material-ui/core/colors';\n\nimport './index.css';\nimport { App, AppTest, reducer, saga } from './app';\nimport * as serviceWorker from './serviceWorker';\nimport { saga_actions } from './app'\n\nconst sagaMiddleware = createSagaMiddleware();\nconst middleware = [...getDefaultMiddleware({ thunk: false }), sagaMiddleware];\n\n\nconst store = configureStore({\n  reducer,\n  middleware,\n});\n\nexport type AppDispatch_t = typeof store.dispatch\n\nsagaMiddleware.run(saga);\n\nconst darkTheme = createMuiTheme({\n  palette: {\n    type: 'dark',\n    primary: blue,\n    secondary: pink,\n  },\n  typography: {\n    fontFamily: [\n      'source-code-pro',\n      '-apple-system',\n      'BlinkMacSystemFont',\n      '\"Segoe UI\"',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n      '\"Apple Color Emoji\"',\n      '\"Segoe UI Emoji\"',\n      '\"Segoe UI Symbol\"',\n    ].join(','),\n  },\n})\n\nReactDOM.render(\n  <Provider store={store}>\n    <ThemeProvider theme={darkTheme}>\n      <Router>\n        <Switch>\n          <Route exact path=\"/\" component={App} />\n          <Route path=\"/AppTest\" component={AppTest} />\n        </Switch>\n      </Router>\n    </ThemeProvider>\n  </Provider>,\n  document.getElementById('root')\n)\n\nstore.dispatch(saga_actions.annotation_window.fetch_state())\nstore.dispatch(saga_actions.worldlines.get_worldlines())\nstore.dispatch(saga_actions.annotations.get_annotations())\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}