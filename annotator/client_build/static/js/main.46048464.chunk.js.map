{"version":3,"sources":["annotation_window/actions.ts","third_party/lru.js","api/index.ts","annotations/actions.ts","provenances/actions.ts","app/selectors.ts","annotation_window/helpers.ts","annotation_window/selectors.ts","worldlines/selectors.ts","provenances/selectors.ts","annotations/selectors.ts","provenances/sagas.ts","provenances/components/Provenance.tsx","provenances/components/ProvenancePanel.tsx","annotations/sagas.ts","annotations/components/AnnotationsSVG.tsx","annotations/components/AnnotationPanel.tsx","worldlines/actions.ts","worldlines/sagas.ts","worldlines/components/Worldline.tsx","worldlines/components/WorldlinePanel.tsx","annotation_window/sagas.ts","test_components/ActionForm.tsx","annotation_window/components/AnnotationWindowTest.tsx","annotation_window/components/AnnovationView.tsx","annotation_window/components/WindowPanel.tsx","annotation_window/webgl/gl-matrix/common.js","annotation_window/webgl/gl-matrix/mat3.js","annotation_window/webgl/gl-matrix/mat4.js","annotation_window/webgl/gl-matrix/vec3.js","annotation_window/webgl/gl-matrix/vec4.js","annotation_window/webgl/gl-matrix/quat.js","annotation_window/webgl/gl-matrix/vec2.js","annotation_window/webgl/webgl-util.js","annotation_window/webgl/shader-srcs.js","annotation_window/components/VolumeView.tsx","annotation_window/components/AnnotationWindow.tsx","app/components/App.tsx","app/actions.ts","app/sagas.ts","app/components/AppTest.tsx","serviceWorker.js","index.tsx"],"names":["initialState","x","y","z","c_idx","t_idx","shape_x","shape_y","shape_z","views","shape_t","scale_x","scale_y","scale_z","LUT","red","green","blue","selected_annotation","visible_worldlines","selected_worldline","active_provenance","fill_circles","show_all_annotations","rpc_list","name","default_args","docstring","rpc_keybindings","rpc_args","threshold","val","min","max","Math","reducers","set_state","_state","action","payload","set_x","state","adjust_x","set_y","adjust_y","set_z","adjust_z","set_c_idx","adjust_c_idx","idx","n","length","set_t_idx","set_scale_x","set_scale_y","set_scale_z","set_shape_x","set_shape_y","set_shape_z","set_LUT_color","set_selected_annotation_local","set_selected_worldline_local","set_active_provenance","set_fill_circles","toggle_fill_circles","set_show_all_annotations","toggle_all_annotations","set_rpc_list","set_rpc_keybinding","set_rpc_args","set_rpc_arg","center_on_annotation","Number","annotation_window_slice","createSlice","actions","reducer","NEWER","Symbol","OLDER","LRUMap","limit","entries","this","size","oldest","newest","undefined","_keymap","Map","assign","Entry","key","value","EntryIterator","oldestEntry","entry","KeyIterator","ValueIterator","prototype","_markEntryAsUsed","MAX_VALUE","clear","it","iterator","itv","next","done","e","set","Error","get","shift","delete","find","has","ent","keys","values","forEach","fun","thisObj","call","toJSON","s","Array","i","toString","String","image_cache","annotation_cache","fetch_metadata","fetch","then","json","fetch_data_cache","url","signal","a","uint8_array","arrayBuffer","array","Uint8ClampedArray","catch","err","console","error","insert_annotation","annotation","method","headers","body","JSON","stringify","response","fetch_annotations_cache","t","annotations","fetch_annotations","update_annotation","id","delete_annotation","create_worldline","fetch_worldlines","update_worldline","w","delete_worldline","save","data","window","alert","path","log","load","fetch_rpcs","rpc","arg","annotations_slice","set_annotation_local","delete_annotation_local","provenances_slice","set_provenance_selected","visible","set_all_selected","provenance","get_annotations_state","app_state","idx_from_coord","coord","shape","floor","LUT_linear","lut","get_state","annotation_window","get_x","createSelector","get_y","get_z","get_c_idx","get_t_idx","get_shape_x","get_shape_y","get_shape_z","get_shape_t","get_views","get_scale_x","get_scale_y","get_scale_z","get_LUT","get_selected_annotation","get_visible_worldlines","get_selected_worldline","get_active_provenance","get_fill_circles","get_show_all_annotations","get_rpc_list","get_rpc_keybindings","get_x_idx","get_y_idx","get_z_idx","get_view","get_dim_viewname","dim","view","get_x_viewname","get_y_viewname","get_z_viewname","get_dim_viewidx","bare_getter","get_x_viewidx","get_y_viewidx","get_z_viewidx","make_data_url","get_x_url","get_y_url","get_z_url","get_vol_url","worldlines","get_worldlines","Object","filter","map","provenances","get_visible_provenances","p","app_selectors","get_annotation_ids","fp","get_used_worldline_ids","mapValues","get_annotations_list","get_visible_annotations","worldlines_selectors","provenances_selectors","pickBy","includes","worldline_id","get_selected_annotation_id","annotation_window_selectors","all","findKey","get_color","worldline","color","get_annotations_with_all_info","selected","get_annotations_view3D","pick","get_visible_annotations_near","output_x","output_y","r","close_3D","abs","radius","get_x_annotations","get_y_annotations","get_z_annotations","fetch_provenances","watch_fetch_provenances","saga_action_types","prefix","saga_actions","createAction","select","annotations_selectors","provenances_set","Set","put","takeEvery","sagas","Provenance","props","style","float","position","height","width","type","checked","onChange","event","on_check","target","marginTop","fontFamily","fontSize","border","ProvenancePanel","connect","selectors","dispatch","bindActionCreators","set_selected_worldline","annotation_window_saga_actions","connector","Card","elevation","variant","square","top","CardContent","Button","onClick","left","IconButton","aria-label","insert_annotation_here","get_annotations","watch_insert_annotation","watch_insert_annotation_here","watch_get_annotations","watch_annotations_on_set_t_idx","watch_update_annotation","watch_delete_annotation","api","set_selected_annotation","bare","abort_controller","AbortController","cached_annotations","abort","annotation_window_actions","provenances_saga_actions","updated_annotation","ok","takeLatest","AnnotationsSVG","annotation_SVGs","cx","size_x","cy","size_y","stroke","strokeWidth","fill","deselect","preventDefault","stopPropagation","onDoubleClick","AnnotationSVG","AnnotationPanel","React","useState","setAnnotation","useEffect","textfields","TF","field","field_key","TextField","label","new_annotation","handle_change","margin","InputProps","set_worldlines_local","set_worldline_lists_local","worldline_lists","selected_lists","set_worldline_local","update_worldline_local","delete_worldline_local","worldlines_slice","set_all_visible","watch_create_worldline","watch_get_worldlines","watch_update_worldline","watch_delete_worldline","watch_set_all_visible","new_worldline_raw","new_worldline","raw_worldlines","removed_id","new_worldlines","Worldline","get_name","setState","onBlur","on_rename","backgroundColor","padding","on_recolor","opacity","WorldlinesPanel","new_name","new_color","fetch_state","center_on_current_annotation","adjust_t","click","doubleclick","rpc_from_key","watch_fetch_state","watch_set_selected_annotation","watch_set_selected_worldline","watch_center_on_current_annotation","watch_adjust_t","watch_click","watch_doubleclick","watch_save","watch_load","watch_rpc","watch_rpc_from_key","meta","rpcs","new_state","new_id","worldlines_actions","annotations_saga_actions","worldlines_saga_actions","result","status","callbacks","try_int_payload","parseInt","putResolve","delay","f","exception","traceback","method_idx","ActionForm","handleChange","bind","handleSubmit","input_parser","onSubmit","defaultValue","Component","FloatForm","parseFloat","x_idx","A","full_state","bare_state","derived_state","state_json","mapDispatchToProps","connector_X","height_scale","width_scale","data_url","x_dim","y_dim","connector_Y","connector_Z","AnnotationView","fetch_and_draw","draw_to_canvas","LUTdata","ctx","refs","canvas","getContext","iData","ImageData","putImageData","make_click_handler","click_fn","getBoundingClientRect","x_pixels","clientX","y_pixels","clientY","x_local","y_local","handle_click","handle_doubleclick","prev_props","svg_width","svg_height","hline","x1","y1","x2","y2","vline","right","ref","zIndex","AnnotationViewX","AnnotationViewY","AnnotationViewZ","DocstringTooltip","withStyles","tooltip","maxWidth","Tooltip","WindowPanel","window_state","set_window_state","toFixed","update","InputLabelProps","rpc_keys","split","keyname","rpc_idx","Fragment","interactive","title","placement","FormControl","marginBottom","InputLabel","Select","labelId","handle_new_rpc_keybinding","MenuItem","nextState","createNextState","draft","handle_rpc_arg_change","EPSILON","ARRAY_TYPE","Float32Array","RANDOM","random","PI","hypot","arguments","sqrt","create","out","glMatrix","fromMat4","clone","copy","fromValues","m00","m01","m02","m10","m11","m12","m20","m21","m22","identity","transpose","a01","a02","a12","invert","a00","a10","a11","a20","a21","a22","b01","b11","b21","det","adjoint","determinant","multiply","b","b00","b02","b10","b12","b20","b22","translate","v","rotate","rad","sin","c","cos","scale","fromTranslation","fromRotation","fromScaling","fromMat2d","fromQuat","q","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","projection","str","frob","add","subtract","multiplyScalar","multiplyScalarAndAdd","exactEquals","equals","a0","a1","a2","a3","a4","a5","a6","a7","a8","b0","b1","b2","b3","b4","b5","b6","b7","b8","mul","sub","m03","m13","m23","m30","m31","m32","m33","axis","len","rotateX","rotateY","rotateZ","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","xy","xz","yz","fromQuat2","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","fromRotationTranslationScale","sx","sy","sz","fromRotationTranslationScaleOrigin","o","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","frustum","bottom","near","far","rl","tb","nf","perspective","fovy","aspect","tan","Infinity","perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","ortho","lr","bt","lookAt","eye","center","up","x0","y0","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","targetTo","a9","a14","a15","b9","b13","b14","b15","divide","ceil","round","scaleAndAdd","distance","squaredDistance","squaredLength","negate","inverse","normalize","dot","cross","lerp","hermite","d","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformMat4","m","transformMat3","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","angle","mag","cosine","acos","zero","div","dist","sqrDist","sqrLen","vec","stride","offset","count","fn","l","u","B","C","D","E","F","G","H","I","J","v1","v2","v3","v4","s1","s2","ix","iy","iz","iw","setAxisAngle","getAxisAngle","out_axis","getAngle","dotproduct","calculateW","exp","et","ln","atan2","pow","slerp","omega","cosom","sinom","scale0","scale1","u1","u2","u3","sqrt1MinusU1","sqrtU1","invDot","conjugate","fromMat3","fRoot","fTrace","j","k","fromEuler","halfToRad","cz","vec4","rotationTo","tmpvec3","vec3","xUnitVec3","yUnitVec3","sqlerp","temp1","temp2","setAxes","matr","mat3","transformMat2","transformMat2d","p0","p1","sinC","cosC","Shader","gl","vertexSrc","fragmentSrc","self","program","compileShader","regexUniform","matchUniformName","uniforms","vertexUnifs","match","fragUnifs","unif","getUniformLocation","use","useProgram","vert","frag","vs","createShader","VERTEX_SHADER","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","fs","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","ArcballCamera","zoomSpeed","screenDims","veye","vcenter","vup","zAxis","viewDist","xAxis","yAxis","invScreen","centerTranslation","mat4","vt","rotMat","rotation","quat","camera","invCamera","updateCameraMatrix","prevMouse","curMouse","mPrev","vec2","clamp","mCur","mPrevBall","screenToArcball","mCurBall","zoom","amount","pan","mouseDelta","delta","worldDelta","eyePos","eyeDir","dir","upDir","unitP","pointDist","Buffer","capacity","dtype","buffer","Uint8Array","Int8Array","Uint16Array","Int16Array","Uint32Array","Int32Array","Float64Array","append","buf","newCap","tmp","constructor","BYTES_PER_ELEMENT","Controller","mousemove","press","wheel","twoFingerDrag","pinch","registerForCanvas","addEventListener","evt","rect","deltaY","oncontextmenu","touches","changedTouches","identifier","prevTouch","curTouch","buttons","curTouches","oldTouches","push","newTouches","motionVectors","motionDirs","pinchAxis","panAxis","pinchMotion","panMotion","sign","oldDist","newDist","panAmount","touchEnd","cubeStrip","_VolumeView","shader","volumeTexture","proj","projView","targetFrameTime","samplingRate","WIDTH","HEIGHT","volDims","tex","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_3D","texStorage3D","R8","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_WRAP_R","CLAMP_TO_EDGE","TEXTURE_WRAP_S","TEXTURE_WRAP_T","texSubImage3D","RED","UNSIGNED_BYTE","longestAxis","volScale","uniform3iv","uniform3fv","deleteTexture","setInterval","document","hidden","startTime","Date","clearColor","COLOR_BUFFER_BIT","uniformMatrix4fv","drawArrays","TRIANGLE_STRIP","finish","targetSamplingRate","getTime","uniform1f","defaultEye","controller","prev","cur","amt","drag","vao","createVertexArray","bindVertexArray","vbo","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform1i","enable","CULL_FACE","cullFace","FRONT","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","colormapImage","Image","onload","draw","colormap","TEXTURE1","TEXTURE_2D","texStorage2D","SRGB8_ALPHA8","texSubImage2D","RGBA","src","VolumeView","XYZSliderBase","Slider","orientation","flip","step","track","handler","TSliderBase","max_val","LUTSliderBase","setValue","newValue","valueLabelDisplay","AnnotationWindow","annotations_z","annotations_3D","size_z","origin_left","origin_top","padding_1","x_image_left","y_image_top","x_slider_top","y_slider_left","z_slider_1_left","z_slider_1_top","z_slider_2_left","z_slider_2_top","t_slider_top","t_slider_length","annotation_panel_left","LUT_slider_length","LUT_top","LUT_G_left","LUT_B_left","window_panel_top","XSlider","YSlider","ZSlider1","ZSlider2","TSlider","LUTSliderRed","h","LUTSliderGreen","LUTSliderBlue","tabIndex","onKeyDown","fromCharCode","which","ctrl","ctrlKey","shiftKey","onKeyUp","App","annotations_actions","provenances_actions","combineReducers","annotation_window_reducer","annotations_reducer","worldlines_reducer","provenances_reducer","saga","annotation_window_sagas","annotations_sagas","worldlines_sagas","provenances_sagas","AppTest","theme","Boolean","location","hostname","sagaMiddleware","createSagaMiddleware","middleware","getDefaultMiddleware","thunk","store","configureStore","run","darkTheme","createMuiTheme","palette","primary","secondary","pink","typography","join","ReactDOM","render","ThemeProvider","exact","component","getElementById","navigator","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.46048464.chunk.js","sourcesContent":["import { AnnotationWindowState_t as State_t, rpc_t } from './model'\r\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\"\r\nimport { annotation_id_t, Annotation_t } from '../annotations/model'\r\nimport { worldline_id_t } from '../worldlines/model';\r\n\r\nexport const initialState: State_t = {\r\n  x: 0.5,\r\n  y: 0.5,\r\n  z: 0.5,\r\n  c_idx: 0,\r\n  t_idx: 0,\r\n  shape_x: 0,\r\n  shape_y: 0,\r\n  shape_z: 0,\r\n  views: [\"slice\", \"mip\", \"vol\"],\r\n  shape_t: 0,\r\n  scale_x: 1,\r\n  scale_y: 1,\r\n  scale_z: 1,\r\n  LUT: {\r\n    red: [0, 150],\r\n    green: [0, 150],\r\n    blue: [0, 150]\r\n  },\r\n  selected_annotation: null,\r\n  visible_worldlines: [],\r\n  selected_worldline: null,\r\n  active_provenance: \"ANTT\",\r\n  fill_circles: true,\r\n  show_all_annotations: false,\r\n  rpc_list: [{ name: \"None found\", default_args: \"\", docstring: \"\" }],\r\n  rpc_keybindings: {\r\n    \"1\": 0,\r\n    \"2\": 0,\r\n    \"3\": 0,\r\n    \"4\": 0,\r\n    \"5\": 0,\r\n    \"6\": 0,\r\n    \"7\": 0,\r\n    \"8\": 0,\r\n    \"9\": 0,\r\n    \"0\": 0,\r\n  },\r\n  rpc_args: {\r\n    \"1\": \"\",\r\n    \"2\": \"\",\r\n    \"3\": \"\",\r\n    \"4\": \"\",\r\n    \"5\": \"\",\r\n    \"6\": \"\",\r\n    \"7\": \"\",\r\n    \"8\": \"\",\r\n    \"9\": \"\",\r\n    \"0\": \"\",\r\n  },\r\n};\r\n\r\nconst threshold = (val: number, min: number, max: number): number =>\r\n  Math.max(Math.min(val, max), 0)\r\n\r\nconst reducers = {\r\n\r\n  set_state: (_state: State_t, action: PayloadAction<State_t>) =>\r\n    action.payload,\r\n\r\n  set_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.x = threshold(action.payload, 0, 1)\r\n  },\r\n  adjust_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.x = threshold(state.x + action.payload, 0, 1)\r\n  },\r\n\r\n  set_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.y = threshold(action.payload, 0, 1)\r\n  },\r\n  adjust_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.y = threshold(state.y + action.payload, 0, 1)\r\n  },\r\n\r\n  set_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.z = threshold(action.payload, 0, 1)\r\n  },\r\n  adjust_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.z = threshold(state.z + action.payload, 0, 1)\r\n  },\r\n\r\n  set_c_idx: (state: State_t, action: PayloadAction<number>) => {\r\n    state.c_idx = action.payload\r\n  },\r\n\r\n  adjust_c_idx: (state: State_t, action: PayloadAction<number>) => {\r\n    const idx = state.c_idx + action.payload\r\n    const n = state.views.length\r\n    state.c_idx = ((idx % n) + n) % n\r\n  },\r\n\r\n  set_t_idx: (state: State_t, action: PayloadAction<number>) => {\r\n    state.t_idx = threshold(action.payload, 0, state.shape_t - 1)\r\n  },\r\n\r\n  set_scale_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.scale_x = action.payload;\r\n  },\r\n  set_scale_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.scale_y = action.payload;\r\n  },\r\n  set_scale_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.scale_z = action.payload;\r\n  },\r\n\r\n  set_shape_x: (state: State_t, action: PayloadAction<number>) => {\r\n    state.shape_x = action.payload;\r\n  },\r\n  set_shape_y: (state: State_t, action: PayloadAction<number>) => {\r\n    state.shape_y = action.payload;\r\n  },\r\n  set_shape_z: (state: State_t, action: PayloadAction<number>) => {\r\n    state.shape_z = action.payload;\r\n  },\r\n\r\n  set_LUT_color: (state: State_t,\r\n    action: PayloadAction<[\"red\" | \"green\" | \"blue\", number, number]>) => {\r\n    state.LUT[action.payload[0]] = [action.payload[1], action.payload[2]]\r\n  },\r\n\r\n  set_selected_annotation_local: (\r\n    state: State_t, action: PayloadAction<annotation_id_t | null>) => {\r\n    state.selected_annotation = action.payload\r\n  },\r\n\r\n  set_selected_worldline_local: (\r\n    state: State_t, action: PayloadAction<worldline_id_t | null>) => {\r\n    state.selected_worldline = action.payload\r\n  },\r\n\r\n  set_active_provenance: (\r\n    state: State_t, action: PayloadAction<string>) => {\r\n    state.active_provenance = action.payload\r\n  },\r\n\r\n  set_fill_circles: (\r\n    state: State_t, action: PayloadAction<boolean>) => {\r\n    state.fill_circles = action.payload\r\n  },\r\n\r\n  toggle_fill_circles: (\r\n    state: State_t, action: PayloadAction) => {\r\n    state.fill_circles = !state.fill_circles\r\n  },\r\n\r\n  set_show_all_annotations: (\r\n    state: State_t, action: PayloadAction<boolean>) => {\r\n    state.show_all_annotations = action.payload\r\n  },\r\n\r\n  toggle_all_annotations: (\r\n    state: State_t, action: PayloadAction) => {\r\n    state.show_all_annotations = !state.show_all_annotations\r\n  },\r\n\r\n  set_rpc_list: (\r\n    state: State_t, action: PayloadAction<rpc_t[]>) => {\r\n    state.rpc_list = action.payload\r\n  },\r\n\r\n  set_rpc_keybinding: (\r\n    state: State_t, action: PayloadAction<[string, number]>) => {\r\n    state.rpc_keybindings[action.payload[0]] = action.payload[1]\r\n  },\r\n\r\n  set_rpc_args: (\r\n    state: State_t, action: PayloadAction<{ [key: string]: string }>) => {\r\n    state.rpc_args = action.payload\r\n  },\r\n\r\n  set_rpc_arg: (\r\n    state: State_t, action: PayloadAction<[string, string]>) => {\r\n    state.rpc_args[action.payload[0]] = action.payload[1]\r\n  },\r\n\r\n  center_on_annotation: (\r\n    state: State_t, action: PayloadAction<Annotation_t>) => {\r\n    state.x = Number(action.payload.x)\r\n    state.y = Number(action.payload.y)\r\n    state.z = Number(action.payload.z)\r\n  },\r\n}\r\n\r\nconst annotation_window_slice = createSlice({\r\n  name: 'annotation_window',\r\n  initialState,\r\n  reducers\r\n})\r\n\r\nexport const { actions, reducer } = annotation_window_slice\r\n","/**\r\n * A doubly linked list-based Least Recently Used (LRU) cache. Will keep most\r\n * recently used items while discarding least recently used items when its limit\r\n * is reached.\r\n *\r\n * Licensed under MIT. Copyright (c) 2010 Rasmus Andersson <http://hunch.se/>\r\n * See README.md for details.\r\n *\r\n * Illustration of the design:\r\n *\r\n *       entry             entry             entry             entry\r\n *       ______            ______            ______            ______\r\n *      | head |.newer => |      |.newer => |      |.newer => | tail |\r\n *      |  A   |          |  B   |          |  C   |          |  D   |\r\n *      |______| <= older.|______| <= older.|______| <= older.|______|\r\n *\r\n *  removed  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  <--  added\r\n */\r\n\r\nconst NEWER = Symbol('newer');\r\nconst OLDER = Symbol('older');\r\n\r\nexport function LRUMap(limit, entries) {\r\n  if (typeof limit !== 'number') {\r\n    // called as (entries)\r\n    entries = limit;\r\n    limit = 0;\r\n  }\r\n\r\n  this.size = 0;\r\n  this.limit = limit;\r\n  this.oldest = this.newest = undefined;\r\n  this._keymap = new Map();\r\n\r\n  if (entries) {\r\n    this.assign(entries);\r\n    if (limit < 1) {\r\n      this.limit = this.size;\r\n    }\r\n  }\r\n}\r\n\r\nfunction Entry(key, value) {\r\n  this.key = key;\r\n  this.value = value;\r\n  this[NEWER] = undefined;\r\n  this[OLDER] = undefined;\r\n}\r\n\r\n\r\nLRUMap.prototype._markEntryAsUsed = function(entry) {\r\n  if (entry === this.newest) {\r\n    // Already the most recenlty used entry, so no need to update the list\r\n    return;\r\n  }\r\n  // HEAD--------------TAIL\r\n  //   <.older   .newer>\r\n  //  <--- add direction --\r\n  //   A  B  C  <D>  E\r\n  if (entry[NEWER]) {\r\n    if (entry === this.oldest) {\r\n      this.oldest = entry[NEWER];\r\n    }\r\n    entry[NEWER][OLDER] = entry[OLDER]; // C <-- E.\r\n  }\r\n  if (entry[OLDER]) {\r\n    entry[OLDER][NEWER] = entry[NEWER]; // C. --> E\r\n  }\r\n  entry[NEWER] = undefined; // D --x\r\n  entry[OLDER] = this.newest; // D. --> E\r\n  if (this.newest) {\r\n    this.newest[NEWER] = entry; // E. <-- D\r\n  }\r\n  this.newest = entry;\r\n};\r\n\r\nLRUMap.prototype.assign = function(entries) {\r\n  let entry, limit = this.limit || Number.MAX_VALUE;\r\n  this._keymap.clear();\r\n  let it = entries[Symbol.iterator]();\r\n  for (let itv = it.next(); !itv.done; itv = it.next()) {\r\n    let e = new Entry(itv.value[0], itv.value[1]);\r\n    this._keymap.set(e.key, e);\r\n    if (!entry) {\r\n      this.oldest = e;\r\n    } else {\r\n      entry[NEWER] = e;\r\n      e[OLDER] = entry;\r\n    }\r\n    entry = e;\r\n    if (limit-- === 0) {\r\n      throw new Error('overflow');\r\n    }\r\n  }\r\n  this.newest = entry;\r\n  this.size = this._keymap.size;\r\n};\r\n\r\nLRUMap.prototype.get = function(key) {\r\n  // First, find our cache entry\r\n  var entry = this._keymap.get(key);\r\n  if (!entry) return; // Not cached. Sorry.\r\n  // As <key> was found in the cache, register it as being requested recently\r\n  this._markEntryAsUsed(entry);\r\n  return entry.value;\r\n};\r\n\r\nLRUMap.prototype.set = function(key, value) {\r\n  var entry = this._keymap.get(key);\r\n\r\n  if (entry) {\r\n    // update existing\r\n    entry.value = value;\r\n    this._markEntryAsUsed(entry);\r\n    return this;\r\n  }\r\n\r\n  // new entry\r\n  this._keymap.set(key, (entry = new Entry(key, value)));\r\n\r\n  if (this.newest) {\r\n    // link previous tail to the new tail (entry)\r\n    this.newest[NEWER] = entry;\r\n    entry[OLDER] = this.newest;\r\n  } else {\r\n    // we're first in -- yay\r\n    this.oldest = entry;\r\n  }\r\n\r\n  // add new entry to the end of the linked list -- it's now the freshest entry.\r\n  this.newest = entry;\r\n  ++this.size;\r\n  if (this.size > this.limit) {\r\n    // we hit the limit -- remove the head\r\n    this.shift();\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nLRUMap.prototype.shift = function() {\r\n  // todo: handle special case when limit == 1\r\n  var entry = this.oldest;\r\n  if (entry) {\r\n    if (this.oldest[NEWER]) {\r\n      // advance the list\r\n      this.oldest = this.oldest[NEWER];\r\n      this.oldest[OLDER] = undefined;\r\n    } else {\r\n      // the cache is exhausted\r\n      this.oldest = undefined;\r\n      this.newest = undefined;\r\n    }\r\n    // Remove last strong reference to <entry> and remove links from the purged\r\n    // entry being returned:\r\n    entry[NEWER] = entry[OLDER] = undefined;\r\n    this._keymap.delete(entry.key);\r\n    --this.size;\r\n    return [entry.key, entry.value];\r\n  }\r\n};\r\n\r\n// ----------------------------------------------------------------------------\r\n// Following code is optional and can be removed without breaking the core\r\n// functionality.\r\n\r\nLRUMap.prototype.find = function(key) {\r\n  let e = this._keymap.get(key);\r\n  return e ? e.value : undefined;\r\n};\r\n\r\nLRUMap.prototype.has = function(key) {\r\n  return this._keymap.has(key);\r\n};\r\n\r\nLRUMap.prototype['delete'] = function(key) {\r\n  var entry = this._keymap.get(key);\r\n  if (!entry) return;\r\n  this._keymap.delete(entry.key);\r\n  if (entry[NEWER] && entry[OLDER]) {\r\n    // relink the older entry with the newer entry\r\n    entry[OLDER][NEWER] = entry[NEWER];\r\n    entry[NEWER][OLDER] = entry[OLDER];\r\n  } else if (entry[NEWER]) {\r\n    // remove the link to us\r\n    entry[NEWER][OLDER] = undefined;\r\n    // link the newer entry to head\r\n    this.oldest = entry[NEWER];\r\n  } else if (entry[OLDER]) {\r\n    // remove the link to us\r\n    entry[OLDER][NEWER] = undefined;\r\n    // link the newer entry to head\r\n    this.newest = entry[OLDER];\r\n  } else {// if(entry[OLDER] === undefined && entry.newer === undefined) {\r\n    this.oldest = this.newest = undefined;\r\n  }\r\n\r\n  this.size--;\r\n  return entry.value;\r\n};\r\n\r\nLRUMap.prototype.clear = function() {\r\n  // Not clearing links should be safe, as we don't expose live links to user\r\n  this.oldest = this.newest = undefined;\r\n  this.size = 0;\r\n  this._keymap.clear();\r\n};\r\n\r\n\r\nfunction EntryIterator(oldestEntry) { this.entry = oldestEntry; }\r\nEntryIterator.prototype[Symbol.iterator] = function() { return this; }\r\nEntryIterator.prototype.next = function() {\r\n  let ent = this.entry;\r\n  if (ent) {\r\n    this.entry = ent[NEWER];\r\n    return { done: false, value: [ent.key, ent.value] };\r\n  } else {\r\n    return { done: true, value: undefined };\r\n  }\r\n};\r\n\r\n\r\nfunction KeyIterator(oldestEntry) { this.entry = oldestEntry; }\r\nKeyIterator.prototype[Symbol.iterator] = function() { return this; }\r\nKeyIterator.prototype.next = function() {\r\n  let ent = this.entry;\r\n  if (ent) {\r\n    this.entry = ent[NEWER];\r\n    return { done: false, value: ent.key };\r\n  } else {\r\n    return { done: true, value: undefined };\r\n  }\r\n};\r\n\r\nfunction ValueIterator(oldestEntry) { this.entry = oldestEntry; }\r\nValueIterator.prototype[Symbol.iterator] = function() { return this; }\r\nValueIterator.prototype.next = function() {\r\n  let ent = this.entry;\r\n  if (ent) {\r\n    this.entry = ent[NEWER];\r\n    return { done: false, value: ent.value };\r\n  } else {\r\n    return { done: true, value: undefined };\r\n  }\r\n};\r\n\r\n\r\nLRUMap.prototype.keys = function() {\r\n  return new KeyIterator(this.oldest);\r\n};\r\n\r\nLRUMap.prototype.values = function() {\r\n  return new ValueIterator(this.oldest);\r\n};\r\n\r\nLRUMap.prototype.entries = function() {\r\n  return this;\r\n};\r\n\r\nLRUMap.prototype[Symbol.iterator] = function() {\r\n  return new EntryIterator(this.oldest);\r\n};\r\n\r\nLRUMap.prototype.forEach = function(fun, thisObj) {\r\n  if (typeof thisObj !== 'object') {\r\n    thisObj = this;\r\n  }\r\n  let entry = this.oldest;\r\n  while (entry) {\r\n    fun.call(thisObj, entry.value, entry.key, this);\r\n    entry = entry[NEWER];\r\n  }\r\n};\r\n\r\n/** Returns a JSON (array) representation */\r\nLRUMap.prototype.toJSON = function() {\r\n  var s = new Array(this.size), i = 0, entry = this.oldest;\r\n  while (entry) {\r\n    s[i++] = { key: entry.key, value: entry.value };\r\n    entry = entry[NEWER];\r\n  }\r\n  return s;\r\n};\r\n\r\n/** Returns a String representation */\r\nLRUMap.prototype.toString = function() {\r\n  var s = '', entry = this.oldest;\r\n  while (entry) {\r\n    s += String(entry.key)+':'+entry.value;\r\n    entry = entry[NEWER];\r\n    if (entry) {\r\n      s += ' < ';\r\n    }\r\n  }\r\n  return s;\r\n};\r\n","import { LRUMap } from '../third_party/lru'\r\nimport { AnnotationsState_t, Annotation_t, annotation_id_t } from '../annotations/model'\r\nimport { Worldline_t, Worldlines_t, worldline_id_t } from '../worldlines/model'\r\n\r\nconst image_cache = new LRUMap<string, Uint8ClampedArray>(5000)\r\nconst annotation_cache = new LRUMap<number, AnnotationsState_t>(1000)\r\n\r\n// Annotation window\r\n\r\nexport const fetch_metadata = () => {\r\n  return fetch(\"/metadata\")\r\n    .then(x => x.json())\r\n}\r\n\r\nexport async function fetch_data_cache(\r\n  url: string,\r\n  signal: AbortSignal): Promise<Uint8ClampedArray> {\r\n\r\n  if (image_cache.has(url)) {\r\n    const uint8_array = image_cache.get(url)\r\n    if (uint8_array !== undefined) {\r\n      return uint8_array\r\n    }\r\n  }\r\n\r\n  return await fetch(url, { signal })\r\n    .then((x) => x.arrayBuffer())\r\n    .then((x) => {\r\n      const array = new Uint8ClampedArray(x);\r\n      image_cache.set(url, array);\r\n      return array;\r\n    })\r\n    .catch(err => {\r\n      if (err.name === \"AbortError\") {\r\n        // console.log(\"Fetch aborted:\", url)\r\n      }\r\n      else {\r\n        console.error(err)\r\n      }\r\n    }) as Uint8ClampedArray\r\n\r\n}\r\n\r\nexport async function fetch_data(\r\n  url: string,\r\n  signal: AbortSignal): Promise<Uint8ClampedArray> {\r\n\r\n  return await fetch(url, { signal })\r\n    .then((x) => x.arrayBuffer())\r\n    .then((x) => new Uint8ClampedArray(x))\r\n    .catch(err => {\r\n      if (err.name === \"AbortError\") {\r\n        // console.log(\"Fetch aborted:\", url)\r\n      }\r\n      else {\r\n        console.error(err)\r\n      }\r\n    }) as Uint8ClampedArray\r\n\r\n}\r\n\r\n// Annotations\r\n\r\nexport type bare_annotation_t = {\r\n  x: number,\r\n  y: number,\r\n  z: number,\r\n  t_idx: number,\r\n  worldline_id: number\r\n}\r\n\r\nexport const insert_annotation = (annotation: bare_annotation_t) => {\r\n  return fetch(\"/annotations\", {\r\n    method: \"POST\", // or \"PUT\"\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(annotation),\r\n  })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport function fetch_annotations_cache(t: number):\r\n  AnnotationsState_t | undefined {\r\n\r\n  if (annotation_cache.has(t)) {\r\n    const annotations = annotation_cache.get(t)\r\n    if (annotations !== undefined) {\r\n      return annotations\r\n    }\r\n  }\r\n\r\n}\r\n\r\n// export const fetch_annotations = (t: number) =>{\r\n//   return fetch(`/t/${t}/annotations`)\r\n//   .then((response) => response.json())\r\n// }\r\n\r\nexport async function fetch_annotations(t: number, signal: AbortSignal):\r\n  Promise<AnnotationsState_t> {\r\n\r\n  return await fetch(`/t/${t}/annotations`, { signal })\r\n    .then((x) => x.json())\r\n    .then((x) => {\r\n      annotation_cache.set(t, x);\r\n      return x;\r\n    })\r\n    .catch(err => {\r\n      if (err.name === \"AbortError\") {\r\n        // console.log(\"Fetch aborted: Annotations for \", t)\r\n      }\r\n      else {\r\n        console.error(err)\r\n      }\r\n    }) as AnnotationsState_t\r\n}\r\n\r\nexport const update_annotation = (a: Annotation_t) => {\r\n  return fetch(`/annotations/${a.id}`, {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(a),\r\n  })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport const delete_annotation = (id: annotation_id_t) => {\r\n  return fetch(`/annotations/${id}`, { method: \"DELETE\" })\r\n}\r\n\r\n// Worldlines\r\n\r\nexport const create_worldline = () => {\r\n  return fetch(`/worldlines`, { method: \"POST\" })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport const fetch_worldlines = () => {\r\n  return fetch(`/worldlines`, { method: \"GET\" })\r\n    .then((response) => (response.json() as Promise<Worldlines_t>))\r\n}\r\n\r\nexport const update_worldline = (w: Partial<Worldline_t>) => {\r\n  return fetch(`/worldlines/${w.id}`, {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(w),\r\n  })\r\n    .then((response) => response.json())\r\n}\r\n\r\nexport const delete_worldline = (id: worldline_id_t) => {\r\n  return fetch(`/worldlines/${id}`, { method: \"DELETE\" })\r\n}\r\n\r\n// Save worldlines and annotations\r\n\r\nexport const save = () => {\r\n  return fetch(\"/save\", {\r\n    method: \"POST\",\r\n  })\r\n    .then((response) => response.json())\r\n    .then((data) => {\r\n      window.alert(`Save successful: ${data.path}`);\r\n      console.log(\"Saved to: \", data)\r\n    })\r\n    .catch((error) => {\r\n      window.alert(\"Save failed. See console.\")\r\n      console.error(\"Error:\", error);\r\n    });\r\n}\r\n\r\n// Load worldlines and annotations\r\n\r\nexport const load = () => {\r\n  return fetch(\"/load\", {\r\n    method: \"POST\",\r\n  })\r\n    .then((response) => response.json())\r\n    .then((data) => {\r\n      window.alert(`Load successful: ${data.path}`);\r\n    })\r\n    .catch((error) => {\r\n      window.alert(\"Load failed. See console.\")\r\n      console.error(\"Error:\", error);\r\n    });\r\n}\r\n\r\n// RPC\r\n\r\nexport const fetch_rpcs = () => {\r\n  return fetch(\"/rpc\")\r\n    .then(x => x.json())\r\n}\r\n\r\nexport const rpc = (method: string, arg: string, state: AnnotationsState_t) => {\r\n\r\n  return fetch(\"/rpc\", {\r\n    method: \"POST\", // or \"PUT\"\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify({ method, arg, state }),\r\n  })\r\n    .then((response) => response.json())\r\n\r\n}","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\n\r\nimport {\r\n  AnnotationsState_t as State_t ,\r\n  Annotation_t,\r\n  annotation_id_t\r\n} from './model'\r\n\r\nexport const initialState: State_t = {}\r\n\r\nconst reducers = {\r\n\r\n  set_state: (state: State_t, action: PayloadAction<State_t>) =>\r\n    action.payload,\r\n\r\n  set_annotation_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Annotation_t>) => {\r\n      state[action.payload.id] = action.payload\r\n    },\r\n\r\n  delete_annotation_local: (\r\n    state: State_t,\r\n    action: PayloadAction<annotation_id_t>) => {\r\n      delete state[action.payload]\r\n    }\r\n\r\n}\r\n\r\nconst annotations_slice = createSlice({\r\n  name: 'annotations',\r\n  initialState,\r\n  reducers\r\n})\r\n\r\nexport const { actions, reducer } = annotations_slice","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\n\r\nimport {\r\n  provenance_id_t,\r\n  ProvenancesState_t as State_t,\r\n} from './model'\r\n\r\nexport const initialState: State_t = {}\r\n\r\nconst reducers = {\r\n\r\n  set_state: (_state: State_t, action: PayloadAction<State_t>) =>\r\n    action.payload,\r\n\r\n  set_provenance_selected:  (\r\n    state: State_t,\r\n    action: PayloadAction<[provenance_id_t, boolean]>) => {\r\n    state[action.payload[0]].visible = action.payload[1]\r\n  },\r\n\r\n  set_all_selected: (\r\n    state: State_t,\r\n    action: PayloadAction<boolean>) => {\r\n      for (let provenance in state) {\r\n        state[provenance].visible = action.payload\r\n      }\r\n    }\r\n\r\n}\r\n\r\nconst provenances_slice = createSlice({\r\n  name: 'provenances',\r\n  initialState,\r\n  reducers\r\n})\r\n\r\nexport const { actions, reducer } = provenances_slice","import { State_t } from './model'\r\n\r\nexport const get_annotation_window_state = (app_state: State_t) =>\r\n    app_state.annotation_window\r\n\r\nexport const get_annotations_state = (app_state: State_t) =>\r\n    app_state.annotations\r\n\r\nexport const get_worldlines_state = (app_state: State_t) =>\r\n    app_state.worldlines\r\n\r\nexport const get_provenances_state = (app_state: State_t) =>\r\n    app_state.provenances\r\n\r\nexport const get_dataset = (app_state: State_t) =>\r\n    app_state.dataset\r\n","// Convert x/y/z to index values using shape. The convention is that images\r\n// go from 0.0 to 1.0, so the center values of each pixel are in (0, 1)\r\n\r\nimport { LUT_t } from \"./model\"\r\n\r\nexport const idx_from_coord = (coord: number, shape: number): number => {\r\n  return Math.max(Math.floor(coord * shape - 1e-6), 0)\r\n}\r\nexport const coord_from_idx = (idx: number, shape: number): number => {\r\n  return (idx + 0.5) / shape\r\n}\r\n\r\n// Apply a LUT to a uint8 array.\r\n\r\nconst LUT_linear = (value: number, lut: [number, number]): number =>\r\n  255 / (lut[1] - lut[0]) * (value - lut[0])\r\n\r\nexport const apply_LUT =\r\n  (data: Uint8ClampedArray, LUT: LUT_t): Uint8ClampedArray =>\r\n\r\n    data.map((val: number, idx: number): number => {\r\n      const offset = idx % 4\r\n      switch (offset) {\r\n        case 0: return LUT_linear(val, LUT.red)\r\n        case 1: return LUT_linear(val, LUT.green)\r\n        case 2: return LUT_linear(val, LUT.blue)\r\n        default: return val\r\n      }\r\n    })\r\n\r\nexport const apply_green_LUT =\r\n  (data: Uint8ClampedArray, LUT: LUT_t): Uint8ClampedArray =>\r\n\r\n  data.map((val: number): number => LUT_linear(val, LUT.green))\r\n","import { createSelector } from 'reselect'\r\n\r\nimport * as app_selectors from '../app/selectors'\r\nimport { idx_from_coord } from './helpers'\r\nimport { State_t } from '../app/model'\r\n\r\nexport const get_state = app_selectors.get_annotation_window_state\r\n\r\n// Top level selectors\r\nexport const get_x = createSelector(get_state, s => s.x)\r\nexport const get_y = createSelector(get_state, s => s.y)\r\nexport const get_z = createSelector(get_state, s => s.z)\r\nexport const get_c_idx = createSelector(get_state, s => s.c_idx)\r\nexport const get_t_idx = createSelector(get_state, s => s.t_idx)\r\nexport const get_shape_x = createSelector(get_state, s => s.shape_x)\r\nexport const get_shape_y = createSelector(get_state, s => s.shape_y)\r\nexport const get_shape_z = createSelector(get_state, s => s.shape_z)\r\nexport const get_shape_t = createSelector(get_state, s => s.shape_t)\r\nexport const get_views = createSelector(get_state, s => s.views)\r\nexport const get_scale_x = createSelector(get_state, s => s.scale_x)\r\nexport const get_scale_y = createSelector(get_state, s => s.scale_y)\r\nexport const get_scale_z = createSelector(get_state, s => s.scale_z)\r\nexport const get_LUT = createSelector(get_state, s => s.LUT)\r\nexport const get_selected_annotation = createSelector(get_state,\r\n  s => s.selected_annotation)\r\nexport const get_visible_worldlines = createSelector(get_state,\r\n  s => s.visible_worldlines)\r\nexport const get_selected_worldline = createSelector(get_state,\r\n  s => s.selected_worldline)\r\nexport const get_active_provenance = createSelector(get_state,\r\n  s => s.active_provenance)\r\nexport const get_fill_circles = createSelector(get_state, s => s.fill_circles)\r\nexport const get_show_all_annotations = createSelector(get_state,\r\n  s => s.show_all_annotations)\r\nexport const get_rpc_list = createSelector(get_state,\r\n  s => s.rpc_list)\r\nexport const get_rpc_keybindings = createSelector(get_state,\r\n  s => s.rpc_keybindings)\r\n\r\n// Convert coordinate in (0, 1) to index in [0, shape-1]\r\nexport const get_x_idx = createSelector([get_x, get_shape_x], idx_from_coord)\r\nexport const get_y_idx = createSelector([get_y, get_shape_y], idx_from_coord)\r\nexport const get_z_idx = createSelector([get_z, get_shape_z], idx_from_coord)\r\n\r\n// Get view information\r\n\r\nexport const get_view = createSelector(\r\n  get_views,\r\n  get_c_idx,\r\n  (views, c_idx) => views[c_idx]\r\n)\r\n\r\nconst get_dim_viewname = (dim: 'x' | 'y' | 'z') => createSelector(\r\n  get_view,\r\n  (view) => {\r\n    switch (view) {\r\n      case \"slice\": return dim\r\n      case \"mip\": return `mip_${dim}`\r\n      default: return dim\r\n    }\r\n  }\r\n)\r\n\r\nconst get_x_viewname = get_dim_viewname('x')\r\nconst get_y_viewname = get_dim_viewname('y')\r\nconst get_z_viewname = get_dim_viewname('z')\r\n\r\nconst get_dim_viewidx = (dim: 'x' | 'y' | 'z',\r\n  bare_getter: (s: State_t) => number) => createSelector(\r\n    get_view,\r\n    bare_getter,\r\n    (view, idx) => {\r\n      switch (view) {\r\n        case \"slice\": return idx\r\n        case \"mip\": return 0\r\n        default: return idx\r\n      }\r\n    }\r\n)\r\n\r\nconst get_x_viewidx = get_dim_viewidx('x', get_x_idx)\r\nconst get_y_viewidx = get_dim_viewidx('y', get_y_idx)\r\nconst get_z_viewidx = get_dim_viewidx('z', get_z_idx)\r\n\r\n// Get image urls (fetching has to be done in components)\r\n\r\nconst make_data_url = (t: number, view: string, x: number) =>\r\n  `/t/${t}/data/${view}/${x}`\r\n\r\nexport const get_x_url = createSelector(\r\n  get_t_idx,\r\n  get_x_viewname,\r\n  get_x_viewidx,\r\n  make_data_url\r\n)\r\nexport const get_y_url = createSelector(\r\n  get_t_idx,\r\n  get_y_viewname,\r\n  get_y_viewidx,\r\n  make_data_url\r\n)\r\nexport const get_z_url = createSelector(\r\n  get_t_idx,\r\n  get_z_viewname,\r\n  get_z_viewidx,\r\n  make_data_url\r\n)\r\n\r\nexport const get_vol_url = createSelector(\r\n  get_t_idx,\r\n  (t) => make_data_url(t, \"gvol\", 1)\r\n)","import { createSelector } from 'reselect'\r\n\r\nimport * as app_selectors from '../app/selectors'\r\n\r\nexport const get_state = app_selectors.get_worldlines_state\r\n\r\nexport const get_worldlines = createSelector(\r\n  get_state,\r\n  (s) => s.worldlines\r\n)\r\n\r\nexport const get_visible_worldlines = createSelector(\r\n  get_worldlines,\r\n  (s) => Object.entries(s)\r\n    .filter((w) => w[1].visible)\r\n    .map((w) => Number(w[0]))\r\n)\r\n","import { createSelector } from 'reselect'\r\n\r\nimport * as app_selectors from '../app/selectors'\r\n\r\nexport const get_state = app_selectors.get_provenances_state\r\n\r\nexport const get_visible_provenances = createSelector(\r\n    get_state,\r\n    (x) => {\r\n        console.log(x)\r\n        return Object.entries(x)\r\n        .filter((p) => p[1].visible)\r\n        .map((p) => p[1].id)}\r\n)","import { createSelector } from 'reselect'\r\nimport fp from 'lodash/fp'\r\nimport { Dictionary } from 'lodash'\r\n\r\nimport { annotation_id_t, Annotation_t } from './model'\r\nimport * as app_selectors from '../app/selectors'\r\nimport * as annotation_window_selectors from '../annotation_window/selectors'\r\nimport * as worldlines_selectors from '../worldlines/selectors'\r\nimport * as provenances_selectors from '../provenances/selectors'\r\nimport { Worldline_t, WorldlinesState_t } from '../worldlines/model'\r\n\r\nexport const get_state = app_selectors.get_annotations_state\r\n\r\nexport const get_annotation_ids = createSelector(\r\n  get_state,\r\n  fp.keys\r\n)\r\n\r\nexport const get_used_worldline_ids = createSelector(\r\n  get_state,\r\n  (x) => fp.values(fp.mapValues(\"worldline_id\")(x))\r\n)\r\n\r\n// Get annotations\r\n\r\nexport const get_annotations_list = createSelector(\r\n  get_state,\r\n  (annotations) => {\r\n    return Object.entries(annotations).map((a) => a[1])\r\n  }\r\n)\r\n\r\nexport const get_visible_annotations = createSelector(\r\n  get_state,\r\n  worldlines_selectors.get_visible_worldlines,\r\n  provenances_selectors.get_visible_provenances,\r\n  (s, w, p) => fp.pickBy((x: Annotation_t) =>\r\n    w.includes(x.worldline_id) && p.includes(x.provenance))(s)\r\n)\r\n\r\nexport const get_selected_annotation_id = createSelector(\r\n  get_state,\r\n  annotation_window_selectors.get_selected_annotation,\r\n  annotation_window_selectors.get_selected_worldline,\r\n  (all, a, w) => {\r\n    if (a && a > 0) {\r\n      return a\r\n    }\r\n    else if (w && w > 0) {\r\n      return Number(fp.findKey({ worldline_id: w })(all))\r\n    } else {\r\n      return null\r\n    }\r\n  }\r\n)\r\n\r\nexport const get_selected_annotation = createSelector(\r\n  get_state,\r\n  get_selected_annotation_id,\r\n  (all, a) => { return (a ? all[a] : null) }\r\n)\r\n\r\n// Gather information needed to draw annotations in 3D or 2D.\r\n\r\nconst get_worldline_for_annotation = (\r\n  annotation: Annotation_t,\r\n  worldlines: WorldlinesState_t) =>\r\n  worldlines.worldlines[annotation.worldline_id]\r\n\r\nconst get_color = (annotation: Annotation_t, worldline: Worldline_t) => {\r\n  return worldline.color\r\n}\r\n\r\nconst get_annotations_with_all_info = createSelector(\r\n  get_visible_annotations,\r\n  worldlines_selectors.get_state,\r\n  get_selected_annotation_id,\r\n  (a, w, s) => fp.mapValues((x: Annotation_t) => {\r\n    const worldline = get_worldline_for_annotation(x, w)\r\n    return {\r\n      ...x,\r\n      //worldline: worldline,\r\n      color: get_color(x, worldline),\r\n      selected: x.id === s\r\n    }\r\n  }\r\n  )(a)\r\n)\r\n\r\nexport type AnnotationView3D_t = {\r\n  id: annotation_id_t,\r\n  x: number,\r\n  y: number,\r\n  z: number,\r\n  color: string,\r\n  selected: boolean\r\n}\r\nexport const get_annotations_view3D = createSelector(\r\n  get_annotations_with_all_info,\r\n  fp.mapValues(fp.pick(['id', 'x', 'y', 'z', 'color', 'selected']))\r\n)\r\n\r\nexport type AnnotationView2D_t = {\r\n  id: annotation_id_t,\r\n  x: number,\r\n  y: number,\r\n  color: string,\r\n  selected: boolean,\r\n  radius: number\r\n}\r\nconst get_visible_annotations_near = (\r\n  annotations: Dictionary<AnnotationView3D_t>,\r\n  dim: 'x' | 'y' | 'z',\r\n  output_x: 'x' | 'y' | 'z',\r\n  output_y: 'x' | 'y' | 'z',\r\n  coord: number,\r\n  r: number\r\n): Dictionary<AnnotationView2D_t> => {\r\n\r\n  const is_close = (a: AnnotationView3D_t) => {\r\n    return (r - Math.abs(a[dim] - coord)) > 0\r\n  }\r\n\r\n  const project_2D = (a: AnnotationView3D_t): any => {\r\n    return {\r\n      id: a.id,\r\n      x: a[output_x],\r\n      y: a[output_y],\r\n      color: a.color,\r\n      selected: a.selected,\r\n      radius: 4\r\n    }\r\n  }\r\n\r\n  const close_3D = fp.pickBy(is_close)(annotations)\r\n  return fp.mapValues(project_2D)(close_3D)\r\n\r\n}\r\n\r\nconst RADIUS_X = 0.02\r\nconst RADIUS_Y = 0.02\r\nconst RADIUS_Z = 0.07\r\n\r\nexport const get_x_annotations = createSelector(\r\n  get_annotations_view3D,\r\n  annotation_window_selectors.get_x,\r\n  annotation_window_selectors.get_show_all_annotations,\r\n  (a, x, all) => {\r\n    if (all) {\r\n      return get_visible_annotations_near(a, \"x\", \"z\", \"y\", x, 2.0)\r\n    } else {\r\n      return get_visible_annotations_near(a, \"x\", \"z\", \"y\", x, RADIUS_X)\r\n    }\r\n  }\r\n)\r\n\r\nexport const get_y_annotations = createSelector(\r\n  get_annotations_view3D,\r\n  annotation_window_selectors.get_y,\r\n  annotation_window_selectors.get_show_all_annotations,\r\n  (a, y, all) => {\r\n    if (all) {\r\n      return get_visible_annotations_near(a, \"y\", \"x\", \"z\", y, 2.0)\r\n    } else {\r\n      return get_visible_annotations_near(a, \"y\", \"x\", \"z\", y, RADIUS_Y)\r\n    }\r\n  }\r\n)\r\n\r\nexport const get_z_annotations = createSelector(\r\n  get_annotations_view3D,\r\n  annotation_window_selectors.get_z,\r\n  annotation_window_selectors.get_show_all_annotations,\r\n  (a, z, all) => {\r\n    if (all) {\r\n      return get_visible_annotations_near(a, \"z\", \"x\", \"y\", z, 2.0)\r\n    } else {\r\n      return get_visible_annotations_near(a, \"z\", \"x\", \"y\", z, RADIUS_Z)\r\n    }\r\n  }\r\n)","import { createAction, PayloadAction } from '@reduxjs/toolkit'\r\nimport { put, takeEvery, select } from 'redux-saga/effects'\r\n\r\nimport { actions } from './actions'\r\nimport { ProvenancesState_t } from './model'\r\n\r\nimport { Annotation_t } from '../annotations/model'\r\nimport * as annotations_selectors from '../annotations/selectors'\r\n\r\nconst prefix = \"provenances/\"\r\nconst saga_action_types = {\r\n  fetch_provenances: prefix + \"fetch_provenances\",\r\n}\r\n\r\nexport const saga_actions = {\r\n  fetch_provenances: createAction(saga_action_types.fetch_provenances),\r\n}\r\n\r\nfunction* fetch_provenances(action: PayloadAction) {\r\n  const annotations = (yield select(\r\n    annotations_selectors.get_annotations_list)) as Annotation_t[]\r\n\r\n  const provenances_set = new Set(annotations.map(x => x.provenance));\r\n\r\n  const provenances: ProvenancesState_t = {}\r\n  provenances_set.forEach(x => {\r\n    provenances[x] = {id: x, visible: true}\r\n  });\r\n\r\n  yield put(actions.set_state(provenances))\r\n}\r\n\r\nfunction* watch_fetch_provenances() {\r\n  yield takeEvery(saga_action_types.fetch_provenances, fetch_provenances)\r\n}\r\nexport const sagas = [\r\n  watch_fetch_provenances,\r\n]","import React from 'react'\r\n\r\nimport { Provenance_t } from '../model'\r\n\r\ntype Provenance_props_t = {\r\n  provenance: Provenance_t,\r\n  on_check: (state: boolean) => any,\r\n}\r\n\r\nconst Provenance = (props: Provenance_props_t) => {\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        float: \"left\",\r\n        position: \"relative\",\r\n        height: \"30px\",\r\n        width: \"100px\"\r\n      }}>\r\n      <input type=\"checkbox\"\r\n        checked={props.provenance.visible}\r\n        onChange={(event) => props.on_check(event.target.checked)}\r\n        style={{\r\n          float: \"left\",\r\n          marginTop: \"8px\"\r\n        }} />\r\n      <div\r\n        style={{\r\n          float: \"left\",\r\n          fontFamily: \"monospace\",\r\n          fontSize: \"14px\",\r\n          color: \"#C0C0C0\",\r\n          marginTop: \"5px\",\r\n          border: \"0px\",\r\n          width: \"20px\"\r\n        }}>\r\n          { props.provenance.id }\r\n      </div>\r\n    </div >)\r\n\r\n}\r\n\r\nexport default Provenance","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\n\r\nimport { Card, CardContent } from '@material-ui/core'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport RefreshIcon from '@material-ui/icons/Refresh'\r\nimport Button from '@material-ui/core/Button'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../../index'\r\n\r\nimport { Provenance_t } from '../model'\r\nimport * as selectors from '../selectors'\r\nimport { actions } from '../actions'\r\nimport { saga_actions } from '../sagas'\r\n\r\nimport { saga_actions as annotation_window_saga_actions }\r\n  from '../../annotation_window'\r\n\r\nimport Provenance from './Provenance'\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    state: selectors.get_state(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    actions: bindActionCreators({ ...actions }, dispatch),\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n    set_selected_worldline: bindActionCreators(\r\n      annotation_window_saga_actions.set_selected_worldline, dispatch\r\n    )\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype ProvenancePanel_props_t = ReduxProps_t\r\n\r\nconst _ProvenancePanel = (props: ProvenancePanel_props_t) => {\r\n\r\n  const provenances = (Object.values(props.state)).map(\r\n    (x: Provenance_t) =>\r\n      <Provenance key={x.id}\r\n        provenance={x}\r\n        on_check={(checked) =>\r\n          props.actions.set_provenance_selected([x.id, checked])\r\n        }\r\n      />)\r\n\r\n  return (\r\n    <Card\r\n      elevation={3}\r\n      variant=\"outlined\"\r\n      square\r\n      style={{\r\n        position: \"relative\",\r\n        top: \"50px\",\r\n        width: \"340px\",\r\n        height: \"auto\"\r\n      }}>\r\n      <CardContent>\r\n        <h3>Provenances:</h3>\r\n\r\n        <Button\r\n          color=\"default\"\r\n          onClick={(event) => props.actions.set_all_selected(true)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"140px\",\r\n            top: \"28px\"\r\n          }}>\r\n          all\r\n        </Button>\r\n        <Button\r\n          color=\"default\"\r\n          onClick={(event) => props.actions.set_all_selected(false)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"190px\",\r\n            top: \"28px\"\r\n          }}>\r\n          none\r\n        </Button>\r\n\r\n        {provenances ? provenances : null}\r\n\r\n        <IconButton\r\n          aria-label=\"fetch\"\r\n          onClick={props.saga_actions.fetch_provenances}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"250px\",\r\n            top: \"25px\"\r\n          }}>\r\n          <RefreshIcon fontSize=\"small\" />\r\n        </IconButton>\r\n\r\n      </CardContent>\r\n    </Card>)\r\n\r\n}\r\n\r\nconst ProvenancePanel = connector(_ProvenancePanel)\r\nexport default ProvenancePanel","import { call, put, takeEvery, takeLatest, select }\r\n  from 'redux-saga/effects'\r\nimport { createAction, PayloadAction } from '@reduxjs/toolkit'\r\nimport { actions } from './actions'\r\nimport { actions as annotation_window_actions ,\r\n  saga_actions as annotation_window_saga_actions }\r\n  from '../annotation_window'\r\nimport {saga_actions as provenances_saga_actions} from '../provenances'\r\nimport * as annotation_window_selectors from '../annotation_window/selectors'\r\nimport * as annotations_selectors from '../annotations/selectors'\r\nimport { State_t as AppState_t } from '../app/model'\r\n\r\nimport * as api from '../api'\r\nimport { Annotation_t } from './model'\r\n\r\nconst prefix = \"annotations/\"\r\nconst saga_action_types = {\r\n  insert_annotation: prefix + \"insert_annotation\",\r\n  insert_annotation_here: prefix + \"insert_annotation_here\",\r\n  get_annotations: prefix + \"get_annotations\",\r\n  update_annotation: prefix + \"update_annotation\",\r\n  delete_annotation: prefix + \"delete_annotation\",\r\n}\r\n\r\nexport const saga_actions = {\r\n\r\n  insert_annotation: createAction<api.bare_annotation_t>(\r\n    saga_action_types.insert_annotation),\r\n\r\n  insert_annotation_here: createAction(\r\n    saga_action_types.insert_annotation_here),\r\n\r\n  get_annotations: createAction(saga_action_types.get_annotations),\r\n\r\n  update_annotation: createAction<Annotation_t>(\r\n    saga_action_types.update_annotation),\r\n\r\n  delete_annotation: createAction(saga_action_types.delete_annotation)\r\n\r\n}\r\n\r\nfunction* insert_annotation(action: PayloadAction<api.bare_annotation_t>) {\r\n\r\n  const a = yield call(api.insert_annotation, action.payload)\r\n  yield put(actions.set_annotation_local(a))\r\n  yield put(annotation_window_saga_actions.set_selected_annotation(a.id))\r\n\r\n}\r\n\r\nfunction* insert_annotation_here() {\r\n\r\n  const state: AppState_t = yield select()\r\n\r\n  const { x, y, z, t_idx, selected_worldline, active_provenance } =\r\n    state.annotation_window\r\n\r\n  let worldline_id = selected_worldline\r\n  if (worldline_id === null) {\r\n    worldline_id = 0\r\n  }\r\n\r\n  const bare = { x, y, z, t_idx, worldline_id, provenance: active_provenance }\r\n\r\n  yield put(saga_actions.insert_annotation(bare))\r\n\r\n}\r\n\r\nlet abort_controller = new AbortController()\r\nfunction* get_annotations(action:PayloadAction<number>) {\r\n\r\n  const t_idx = yield select(annotation_window_selectors.get_t_idx)\r\n\r\n  const cached_annotations = yield call(api.fetch_annotations_cache, t_idx)\r\n  if (cached_annotations !== undefined) {\r\n    yield put(actions.set_state(cached_annotations))\r\n  }\r\n\r\n  abort_controller.abort()\r\n  abort_controller = new AbortController()\r\n\r\n  const annotations = yield call(api.fetch_annotations, t_idx,\r\n    abort_controller.signal)\r\n  yield put(actions.set_state(annotations))\r\n\r\n  yield put(annotation_window_actions.set_selected_annotation_local(null))\r\n\r\n  const selected_annotation = yield select(\r\n    annotations_selectors.get_selected_annotation)\r\n\r\n  if (selected_annotation) {\r\n    yield put(\r\n      annotation_window_actions.center_on_annotation(selected_annotation))\r\n  }\r\n\r\n  yield put(provenances_saga_actions.fetch_provenances())\r\n\r\n}\r\n\r\nfunction* update_annotation(action: PayloadAction<Annotation_t>) {\r\n  const updated_annotation = yield call(api.update_annotation, action.payload)\r\n  yield put(actions.set_annotation_local(updated_annotation))\r\n  yield put(annotation_window_saga_actions\r\n    .set_selected_annotation(updated_annotation.id))\r\n}\r\n\r\nfunction* delete_annotation(action: PayloadAction) {\r\n\r\n  const selected = yield select(\r\n    annotations_selectors.get_selected_annotation_id)\r\n\r\n  const status = yield call(api.delete_annotation, selected)\r\n\r\n  if (status.ok) {\r\n    yield put(actions.delete_annotation_local(selected))\r\n    yield put(annotation_window_actions.set_selected_annotation_local(null))\r\n  }\r\n}\r\n\r\nfunction* watch_insert_annotation() {\r\n  yield takeEvery(saga_action_types.insert_annotation, insert_annotation)\r\n}\r\n\r\nfunction* watch_insert_annotation_here() {\r\n  yield takeEvery(saga_action_types.insert_annotation_here,\r\n    insert_annotation_here)\r\n}\r\n\r\nfunction* watch_get_annotations() {\r\n  yield takeLatest(saga_action_types.get_annotations, get_annotations)\r\n}\r\n\r\nfunction* watch_annotations_on_set_t_idx() {\r\n  yield takeLatest(\"annotation_window/set_t_idx\", get_annotations)\r\n}\r\n\r\nfunction* watch_update_annotation() {\r\n  yield takeEvery(saga_action_types.update_annotation, update_annotation)\r\n}\r\n\r\nfunction* watch_delete_annotation() {\r\n  yield takeEvery(saga_action_types.delete_annotation, delete_annotation)\r\n}\r\nexport const sagas = [\r\n  watch_insert_annotation,\r\n  watch_insert_annotation_here,\r\n  watch_get_annotations,\r\n  watch_annotations_on_set_t_idx,\r\n  watch_update_annotation,\r\n  watch_delete_annotation,\r\n]","import React from 'react'\r\n\r\nimport { AnnotationView2D_t } from '../selectors'\r\nimport { Dictionary } from 'lodash'\r\n\r\ntype AnnotationSVG_props_t = AnnotationView2D_t & {\r\n  size_x: number,\r\n  size_y: number,\r\n  select: (id: number) => any,\r\n  deselect: (id: number) => any,\r\n  fill_circles: boolean,\r\n}\r\n\r\nconst AnnotationSVG = (props: AnnotationSVG_props_t) =>\r\n  <circle\r\n    key={props.id}\r\n    cx={props.x * props.size_x}\r\n    cy={props.y * props.size_y}\r\n    r={props.selected ? 2 * props.radius : props.radius}\r\n    stroke={props.fill_circles? \"white\":  props.color}\r\n    strokeWidth=\"1\"\r\n    fill={props.fill_circles? props.color: \"none\"}\r\n    onClick={(e) => {\r\n      props.selected ? props.deselect(props.id) : props.select(props.id)\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n    }}\r\n    onDoubleClick={(e) => { e.preventDefault(); e.stopPropagation(); }} />\r\n\r\n\r\ntype AnnotationsSVG_props_t = {\r\n  annotations: Dictionary<AnnotationView2D_t>\r\n  size_x: number,\r\n  size_y: number,\r\n  select: (id: number) => any,\r\n  deselect: (id: number) => any,\r\n  fill_circles: boolean,\r\n}\r\n\r\nconst AnnotationsSVG = (props: AnnotationsSVG_props_t) => {\r\n\r\n  const annotation_SVGs = Object.entries(props.annotations).map((a) =>\r\n    AnnotationSVG({\r\n      ...a[1],\r\n      size_x: props.size_x,\r\n      size_y: props.size_y,\r\n      select: props.select,\r\n      deselect: props.deselect,\r\n      fill_circles: props.fill_circles\r\n    }))\r\n\r\n  return <g> {annotation_SVGs} </g>\r\n}\r\n\r\nexport default AnnotationsSVG","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\nimport { TextField, Card, CardContent } from '@material-ui/core'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport DoneIcon from '@material-ui/icons/Done'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../../index'\r\nimport * as selectors from '../selectors'\r\nimport { saga_actions } from '../sagas'\r\nimport { Annotation_t } from '../model'\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    annotation: selectors.get_selected_annotation(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype AnnotationPanel_props_t = ReduxProps_t\r\n\r\nconst _AnnotationPanel = (props: AnnotationPanel_props_t) => {\r\n\r\n  const [annotation, setAnnotation] = React.useState(props.annotation)\r\n\r\n  React.useEffect(() => {\r\n    setAnnotation(props.annotation);\r\n  },\r\n    [props.annotation])\r\n\r\n  let textfields = [<div key=\"null\" style={{ position: \"absolute\" }}>\r\n    select an annotation\r\n    </div>,]\r\n\r\n  const handle_change = (key: string, value: number | string) => {\r\n    const new_annotation = { ...(annotation as Annotation_t), [key]: value }\r\n    console.log(key, value, new_annotation)\r\n    setAnnotation(new_annotation)\r\n  }\r\n\r\n  if (annotation != null) {\r\n\r\n    const TF = (field: string, name: string) => {\r\n      const field_key = field as keyof Annotation_t\r\n\r\n      return <TextField\r\n        type=\"string\"\r\n        label={name}\r\n        key={field_key}\r\n        value={annotation[field_key] !== null ? annotation[field_key] : \"\"}\r\n        onChange={(event) => handle_change(field_key, event.target.value)}\r\n        style={{\r\n          position: \"relative\",\r\n          width: \"100px\",\r\n          height: \"30px\",\r\n          margin: \"10px\",\r\n        }}\r\n        InputProps={{ style: { fontFamily: \"monospace\" } }}\r\n      />\r\n    }\r\n\r\n    textfields = [\r\n      [\"x\", \"x\"],\r\n      [\"y\", \"y\"],\r\n      [\"z\", \"z\"],\r\n      [\"t_idx\", \"t\"],\r\n      [\"id\", \"id\"],\r\n      [\"worldline_id\", \"track\"],\r\n      [\"parent_id\", \"parent_id\"],\r\n      [\"provenance\", \"provenance\"]]\r\n      .map((x) => TF(x[0], x[1]))\r\n\r\n  }\r\n\r\n  return (\r\n    <Card\r\n      elevation={3}\r\n      variant=\"outlined\"\r\n      square\r\n      style={{\r\n        position: \"relative\",\r\n        width: \"340px\",\r\n        height: \"300px\",\r\n        top: \"20px\"\r\n      }}>\r\n      <CardContent>\r\n        <h3>Annotation</h3>\r\n\r\n        <IconButton\r\n          aria-label=\"done\"\r\n          onClick={() =>\r\n            props.saga_actions.update_annotation(annotation as Annotation_t)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"230px\",\r\n            top: \"20px\"\r\n          }}>\r\n          <DoneIcon fontSize=\"small\" />\r\n        </IconButton>\r\n\r\n        <IconButton\r\n          aria-label=\"delete\"\r\n          onClick={props.saga_actions.delete_annotation}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"280px\",\r\n            top: \"20px\"\r\n          }}>\r\n          <DeleteIcon fontSize=\"small\" />\r\n        </IconButton>\r\n\r\n        {textfields}\r\n      </CardContent>\r\n    </Card>)\r\n}\r\n\r\nconst AnnotationPanel = connector(_AnnotationPanel)\r\nexport default AnnotationPanel","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\r\n\r\nimport {\r\n  worldline_id_t,\r\n  Worldline_t,\r\n  Worldlines_t,\r\n  WorldlinesState_t as State_t,\r\n} from './model'\r\n\r\nexport const initialState: State_t = {\r\n  worldlines: {},\r\n  worldline_lists: null,\r\n  selected_lists: []\r\n}\r\n\r\nconst reducers = {\r\n\r\n  set_state: (state: State_t, action: PayloadAction<State_t>) =>\r\n    action.payload,\r\n\r\n  set_worldlines_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Worldlines_t>) => {\r\n    state.worldlines = action.payload\r\n  },\r\n\r\n  set_worldline_lists_local: (\r\n    state: State_t,\r\n    action: PayloadAction<{ [key: string]: [worldline_id_t] }>) => {\r\n    state.worldline_lists = action.payload\r\n    state.selected_lists = []\r\n  },\r\n\r\n  set_worldline_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Worldline_t>) => {\r\n    state.worldlines[action.payload.id] = action.payload\r\n  },\r\n\r\n  update_worldline_local: (\r\n    state: State_t,\r\n    action: PayloadAction<Partial<Worldline_t>>) => {\r\n    if (action.payload.id !== undefined)\r\n      state.worldlines[action.payload.id] = {\r\n        ...state.worldlines[action.payload.id],\r\n        ...action.payload\r\n      }\r\n  },\r\n\r\n  delete_worldline_local: (\r\n    state: State_t,\r\n    action: PayloadAction<worldline_id_t>) => {\r\n    delete state.worldlines[action.payload]\r\n  },\r\n\r\n}\r\n\r\nconst worldlines_slice = createSlice({\r\n  name: 'worldlines',\r\n  initialState,\r\n  reducers\r\n})\r\n\r\nexport const { actions, reducer } = worldlines_slice","import { createAction, PayloadAction } from '@reduxjs/toolkit'\r\nimport { call, put, takeEvery, select } from 'redux-saga/effects'\r\nimport fp from 'lodash/fp'\r\n\r\nimport * as api from '../api'\r\nimport { actions } from './actions'\r\nimport * as selectors from './selectors'\r\nimport { Worldline_t, worldline_id_t, Worldlines_t } from './model'\r\n\r\nconst prefix = \"worldlines/\"\r\nconst saga_action_types = {\r\n  create_worldline: prefix + \"create_worldline\",\r\n  get_worldlines: prefix + \"get_worldlines\",\r\n  update_worldline: prefix + \"update_worldline\",\r\n  delete_worldline: prefix + \"delete_worldline\",\r\n  set_all_visible: prefix + \"set_all_visible\"\r\n}\r\n\r\nexport const saga_actions = {\r\n  create_worldline: createAction(saga_action_types.create_worldline),\r\n  get_worldlines: createAction(saga_action_types.get_worldlines),\r\n  update_worldline: createAction<Partial<Worldline_t>>(\r\n    saga_action_types.update_worldline),\r\n  delete_worldline: createAction<worldline_id_t>(\r\n    saga_action_types.delete_worldline),\r\n  set_all_visible: createAction<boolean>(saga_action_types.set_all_visible),\r\n}\r\n\r\nfunction* create_worldline(action: PayloadAction) {\r\n  const new_worldline_raw = yield call(api.create_worldline)\r\n  const new_worldline = {\r\n    ...new_worldline_raw,\r\n    visible: true,\r\n  }\r\n  yield put(actions.set_worldline_local(new_worldline))\r\n}\r\n\r\nfunction* get_worldlines(action: PayloadAction) {\r\n\r\n  const raw_worldlines = (yield call(api.fetch_worldlines)) as Worldlines_t\r\n\r\n  let worldlines: Worldlines_t = {}\r\n  for (let w of Object.values(raw_worldlines)) {\r\n    worldlines[Number(w.id)] = {\r\n      id: Number(w.id),\r\n      name: String(w.name),\r\n      color: String(w.color),\r\n      visible: true\r\n    }\r\n  }\r\n\r\n  yield put(actions.set_worldlines_local(worldlines))\r\n\r\n}\r\n\r\nfunction* update_worldline(action: PayloadAction<Partial<Worldline_t>>) {\r\n  const worldline = yield call(api.update_worldline, action.payload)\r\n  yield put(actions.update_worldline_local(worldline))\r\n}\r\n\r\nfunction* delete_worldline(action: PayloadAction<worldline_id_t>) {\r\n  const removed_id = yield call(api.delete_worldline, action.payload)\r\n  if (removed_id >= 0) yield put(actions.delete_worldline_local(removed_id))\r\n}\r\n\r\nfunction* set_all_visible(action: PayloadAction<boolean>) {\r\n  const worldlines = yield select(selectors.get_worldlines)\r\n  const new_worldlines = fp.mapValues((x: Worldline_t) => {\r\n    return { ...x, visible: action.payload }})(worldlines)\r\n  yield put(actions.set_worldlines_local(new_worldlines))\r\n}\r\n\r\nfunction* watch_create_worldline() {\r\n  yield takeEvery(saga_action_types.create_worldline, create_worldline)\r\n}\r\nfunction* watch_get_worldlines() {\r\n  yield takeEvery(saga_action_types.get_worldlines, get_worldlines)\r\n}\r\nfunction* watch_update_worldline() {\r\n  yield takeEvery(saga_action_types.update_worldline, update_worldline)\r\n}\r\nfunction* watch_delete_worldline() {\r\n  yield takeEvery(saga_action_types.delete_worldline, delete_worldline)\r\n}\r\nfunction* watch_set_all_visible() {\r\n  yield takeEvery(saga_action_types.set_all_visible, set_all_visible)\r\n}\r\n\r\nexport const sagas = [\r\n  watch_create_worldline,\r\n  watch_get_worldlines,\r\n  watch_update_worldline,\r\n  watch_delete_worldline,\r\n  watch_set_all_visible\r\n]","import React, { useState } from 'react'\r\n\r\nimport { Worldline_t } from '../model'\r\n\r\ntype Worldline_props_t = {\r\n  // left: number,\r\n  // top: number,\r\n  worldline: Worldline_t,\r\n  on_check: (state: boolean) => any,\r\n  on_rename: (new_name: string) => any,\r\n  on_recolor: (new_color: string) => any,\r\n}\r\n\r\nconst Worldline = (props: Worldline_props_t) => {\r\n\r\n  const get_name = (x: Worldline_props_t) => {\r\n    const name = x.worldline.name\r\n    if (name && name !== \"null\") {\r\n      return name\r\n    } else {\r\n      return String(x.worldline.id)\r\n    }\r\n  }\r\n\r\n  const [state, setState] = useState(get_name(props))\r\n  React.useEffect(() => {\r\n    setState(get_name(props));\r\n  }, [props])\r\n\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        float: \"left\",\r\n        position: \"relative\",\r\n        height: \"30px\",\r\n        width: \"100px\"\r\n        // left: props.left,\r\n        // top: props.top,\r\n      }}>\r\n      <input type=\"checkbox\"\r\n        checked={props.worldline.visible}\r\n        onChange={(event) => props.on_check(event.target.checked)}\r\n        style={{\r\n          float: \"left\",\r\n          marginTop: \"8px\"\r\n        }} />\r\n      <div\r\n        style={{\r\n          float: \"left\",\r\n          fontFamily: \"monospace\",\r\n          fontSize: \"10px\",\r\n          color: \"#C0C0C0\",\r\n          marginTop: \"8px\",\r\n          border: \"0px\",\r\n          width: \"20px\"\r\n        }}>\r\n          { props.worldline.id }\r\n      </div>\r\n      <input type=\"text\"\r\n        onBlur={(event) => props.on_rename(event.target.value)}\r\n        onChange={(event) => setState(event.target.value)}\r\n        value={state}\r\n        style={{\r\n          float: \"left\",\r\n          marginTop: \"5px\",\r\n          fontFamily: \"monospace\",\r\n          color: \"white\",\r\n          backgroundColor: \"#666\",\r\n          border: \"0px\",\r\n          width: \"40px\"\r\n        }} />\r\n      <div style={{\r\n        backgroundColor: props.worldline.color,\r\n        float: \"left\",\r\n        marginTop: \"5px\",\r\n        border: \"0px\",\r\n        padding: \"0px\",\r\n        width: \"16px\",\r\n        height: \"18px\",\r\n      }} >\r\n        <input type=\"color\"\r\n          value={props.worldline.color}\r\n          onChange={(event) => props.on_recolor(event.target.value)}\r\n          style={{\r\n            float: \"left\",\r\n            opacity: \"0\",\r\n            marginTop: \"5px\",\r\n            border: \"0px\",\r\n            padding: \"0px\",\r\n            width: \"16px\",\r\n            height: \"16px\",\r\n          }} />\r\n      </div>\r\n    </div >)\r\n\r\n}\r\n\r\nexport default Worldline","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\n\r\nimport { Card, CardContent } from '@material-ui/core'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport AddIcon from '@material-ui/icons/Add'\r\nimport Button from '@material-ui/core/Button'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../../index'\r\n\r\nimport { Worldline_t } from '../model'\r\nimport * as selectors from '../selectors'\r\nimport { actions } from '../actions'\r\nimport { saga_actions } from '../sagas'\r\n\r\nimport { saga_actions as annotation_window_saga_actions }\r\n  from '../../annotation_window'\r\n\r\nimport Worldline from './Worldline'\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    state: selectors.get_state(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    actions: bindActionCreators({ ...actions }, dispatch),\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n    set_selected_worldline: bindActionCreators(\r\n      annotation_window_saga_actions.set_selected_worldline, dispatch\r\n    )\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype WorldlinesPanel_props_t = ReduxProps_t\r\n\r\nconst _WorldlinesPanel = (props: WorldlinesPanel_props_t) => {\r\n\r\n  const worldlines = (Object.values(props.state.worldlines)).map(\r\n    (x: Worldline_t) =>\r\n      <Worldline key={x.id}\r\n        worldline={x}\r\n        on_check={(checked) => {\r\n          props.actions.update_worldline_local({\r\n            id: x.id,\r\n            visible: checked\r\n          })\r\n          if (checked)\r\n            props.set_selected_worldline(x.id)\r\n        }}\r\n        on_rename={(new_name) =>\r\n          props.saga_actions.update_worldline({\r\n            id: x.id,\r\n            name: new_name\r\n          })}\r\n        on_recolor={(new_color) =>\r\n          props.saga_actions.update_worldline({\r\n            id: x.id,\r\n            color: new_color\r\n          })}\r\n      />)\r\n\r\n  return (\r\n    <Card\r\n      elevation={3}\r\n      variant=\"outlined\"\r\n      square\r\n      style={{\r\n        position: \"relative\",\r\n        // left: props.left,\r\n        top: \"90px\",\r\n        width: \"340px\",\r\n        height: \"auto\"\r\n      }}>\r\n      <CardContent>\r\n        <h3>Tracks:</h3>\r\n\r\n        <Button\r\n          color=\"default\"\r\n          onClick={(event) => props.saga_actions.set_all_visible(true)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"90px\",\r\n            top: \"28px\"\r\n          }}>\r\n          all\r\n        </Button>\r\n        <Button\r\n          color=\"default\"\r\n          onClick={(event) => props.saga_actions.set_all_visible(false)}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"160px\",\r\n            top: \"28px\"\r\n          }}>\r\n          none\r\n        </Button>\r\n\r\n        {worldlines}\r\n\r\n        <IconButton\r\n          aria-label=\"add\"\r\n          onClick={() => props.saga_actions.create_worldline()}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"220px\",\r\n            top: \"25px\"\r\n          }}>\r\n          <AddIcon fontSize=\"small\" />\r\n        </IconButton>\r\n\r\n      </CardContent>\r\n    </Card>)\r\n\r\n}\r\n\r\nconst WorldlinesPanel = connector(_WorldlinesPanel)\r\nexport default WorldlinesPanel","import { call, put, putResolve, delay, select, takeEvery, takeLatest }\r\n  from 'redux-saga/effects'\r\nimport { createAction, PayloadAction } from '@reduxjs/toolkit'\r\n\r\nimport { actions, initialState } from './actions'\r\nimport * as api from '../api'\r\nimport { annotation_id_t } from '../annotations/model'\r\nimport { selectors } from './'\r\n\r\nimport { saga_actions as annotations_saga_actions } from '../annotations'\r\nimport { actions as worldlines_actions } from '../worldlines'\r\nimport { saga_actions as worldlines_saga_actions } from '../worldlines'\r\nimport { worldline_id_t } from '../worldlines/model'\r\nimport { selectors as annotations_selectors } from '../annotations'\r\nimport { selectors as worldlines_selectors } from '../worldlines'\r\nimport { get_annotations_state } from '../app/selectors'\r\n\r\nconst prefix = \"annotation_window/\"\r\n\r\nconst saga_action_types = {\r\n  fetch_state: prefix + \"fetch_state\",\r\n  set_selected_annotation: prefix + \"set_selected_annotation\",\r\n  set_selected_worldline: prefix + \"set_selected_worldline\",\r\n  center_on_current_annotation: prefix + \"center_on_current_annotation\",\r\n  adjust_t: prefix + \"adjust_t\",\r\n  click: prefix + \"click\",\r\n  doubleclick: prefix + \"doubleclick\",\r\n  save: prefix + \"save\",\r\n  load: prefix + \"load\",\r\n  rpc: prefix + \"rpc\",\r\n  rpc_from_key: prefix + \"rpc_from_key\",\r\n}\r\n\r\nexport type click_payload_t = {\r\n  x?: number,\r\n  y?: number,\r\n  z?: number,\r\n}\r\n\r\nexport const saga_actions = {\r\n\r\n  fetch_state: createAction(\r\n    saga_action_types.fetch_state),\r\n\r\n  set_selected_annotation: createAction<annotation_id_t | null>(\r\n    saga_action_types.set_selected_annotation),\r\n\r\n  set_selected_worldline: createAction<worldline_id_t | null>(\r\n    saga_action_types.set_selected_worldline),\r\n\r\n  center_on_current_annotation: createAction(\r\n    saga_action_types.center_on_current_annotation),\r\n\r\n  adjust_t: createAction<number>(\r\n    saga_action_types.adjust_t),\r\n\r\n  click: createAction<click_payload_t>(\r\n    saga_action_types.click),\r\n\r\n  doubleclick: createAction<click_payload_t>(\r\n    saga_action_types.doubleclick),\r\n\r\n  save: createAction(saga_action_types.save),\r\n\r\n  load: createAction(saga_action_types.load),\r\n\r\n  rpc: createAction<[number, string]>(saga_action_types.rpc),\r\n\r\n  rpc_from_key: createAction<string>(saga_action_types.rpc_from_key),\r\n\r\n}\r\n\r\nfunction* fetch_state() {\r\n\r\n  const meta = yield call(api.fetch_metadata)\r\n  const rpcs = yield call(api.fetch_rpcs)\r\n\r\n  const new_state = {\r\n    ...initialState,\r\n    shape_x: meta.shape_x,\r\n    shape_y: meta.shape_y,\r\n    shape_z: meta.shape_z,\r\n    shape_t: meta.shape_t,\r\n    scale_x: 700 / meta.shape_x,\r\n    scale_y: 700 / meta.shape_x,\r\n    scale_z: 120 / meta.shape_z,\r\n    rpc_list: rpcs.payload,\r\n  }\r\n\r\n  yield put(actions.set_state(new_state))\r\n}\r\n\r\nfunction* set_selected_annotation(\r\n  action: PayloadAction<annotation_id_t | null>) {\r\n\r\n  if (!action.payload) {\r\n    yield put(actions.set_selected_annotation_local(null))\r\n    yield put(actions.set_selected_worldline_local(null))\r\n  }\r\n\r\n  else {\r\n\r\n    const annotations = yield select(get_annotations_state)\r\n\r\n    const a = annotations[action.payload]\r\n\r\n    if (a === undefined) {\r\n      console.error(`Annotation ${action.payload} not found.`)\r\n      return\r\n    }\r\n\r\n    yield put(actions.set_selected_annotation_local(a.id))\r\n    if (a.worldline_id > 0) {\r\n      yield put(actions.set_selected_worldline_local(a.worldline_id))\r\n    }\r\n\r\n    yield put(saga_actions.center_on_current_annotation())\r\n  }\r\n}\r\n\r\nfunction* set_selected_worldline(\r\n  action: PayloadAction<worldline_id_t | null>) {\r\n\r\n  const new_id = action.payload\r\n\r\n  if (new_id == null) {\r\n    yield put(actions.set_selected_worldline_local(null))\r\n    return\r\n  }\r\n\r\n  const worldlines = yield select(worldlines_selectors.get_worldlines)\r\n\r\n  if (!worldlines[new_id]) {\r\n    window.alert(`Bad track: ${new_id}. Please select an existing one or `\r\n      + `create a new one.`)\r\n    return\r\n  }\r\n\r\n  yield put(actions.set_selected_worldline_local(new_id))\r\n  yield put(actions.set_selected_annotation_local(null))\r\n\r\n  if (new_id !== null)\r\n    yield put(worldlines_actions.update_worldline_local({\r\n      id: new_id,\r\n      visible: true,\r\n    }))\r\n\r\n  yield put(saga_actions.center_on_current_annotation())\r\n\r\n}\r\n\r\nfunction* center_on_current_annotation() {\r\n\r\n  const a = yield select(annotations_selectors.get_selected_annotation)\r\n\r\n  if (a !== null && a !== undefined)\r\n    yield put(actions.center_on_annotation(a))\r\n\r\n}\r\n\r\nfunction* adjust_t(action: PayloadAction<number>) {\r\n  const t_idx = yield select(selectors.get_t_idx)\r\n  yield put(actions.set_t_idx(t_idx + action.payload))\r\n}\r\n\r\nfunction* click(action: PayloadAction<click_payload_t>) {\r\n  if (action.payload.x)\r\n    yield put(actions.set_x(action.payload.x))\r\n  if (action.payload.y)\r\n    yield put(actions.set_y(action.payload.y))\r\n  if (action.payload.z)\r\n    yield put(actions.set_z(action.payload.z))\r\n}\r\n\r\nfunction* doubleclick(action: PayloadAction<click_payload_t>) {\r\n  yield put(saga_actions.click(action.payload))\r\n  yield put(annotations_saga_actions.insert_annotation_here())\r\n}\r\n\r\nfunction* save() {\r\n  yield call(api.save)\r\n}\r\n\r\nfunction* load() {\r\n  yield call(api.load)\r\n  yield put(annotations_saga_actions.get_annotations())\r\n  yield put(worldlines_saga_actions.get_worldlines())\r\n}\r\n\r\nfunction* rpc(action: PayloadAction<[number, string]>) {\r\n\r\n  const state = yield select(selectors.get_state)\r\n\r\n  const rpc = state.rpc_list[action.payload[0]]\r\n  const method = rpc.name\r\n  const arg = action.payload[1]\r\n\r\n  const result = yield call(api.rpc, method, arg, state)\r\n\r\n  console.log(result)\r\n\r\n  if (result.status === \"ok\") {\r\n    for (let action of result.callbacks) {\r\n      const try_int_payload = parseInt(action.payload)\r\n      if (String(try_int_payload) === action.payload)\r\n        action.payload = try_int_payload\r\n      yield putResolve(action)\r\n      yield delay(100)\r\n    }\r\n  }\r\n  else if (result.status === \"error\") {\r\n    window.alert(result.exception)\r\n    console.error(result.traceback)\r\n  }\r\n\r\n}\r\n\r\nfunction* rpc_from_key(action: PayloadAction<string>) {\r\n\r\n  const state = yield select(selectors.get_state)\r\n  const method_idx = state.rpc_keybindings[action.payload]\r\n  const arg = state.rpc_args[action.payload]\r\n\r\n  yield put(saga_actions.rpc([method_idx, arg]))\r\n}\r\n\r\n\r\nfunction* watch_fetch_state() {\r\n  yield takeLatest(saga_action_types.fetch_state, fetch_state)\r\n}\r\n\r\nfunction* watch_set_selected_annotation() {\r\n  yield takeLatest(saga_action_types.set_selected_annotation,\r\n    set_selected_annotation)\r\n}\r\n\r\nfunction* watch_set_selected_worldline() {\r\n  yield takeLatest(saga_action_types.set_selected_worldline,\r\n    set_selected_worldline)\r\n}\r\n\r\nfunction* watch_center_on_current_annotation() {\r\n  yield takeLatest(saga_action_types.center_on_current_annotation,\r\n    center_on_current_annotation)\r\n}\r\n\r\nfunction* watch_adjust_t() {\r\n  yield takeLatest(saga_action_types.adjust_t, adjust_t)\r\n}\r\n\r\n\r\nfunction* watch_click() {\r\n  yield takeLatest(saga_action_types.click, click)\r\n}\r\n\r\nfunction* watch_doubleclick() {\r\n  yield takeLatest(saga_action_types.doubleclick, doubleclick)\r\n}\r\n\r\nfunction* watch_save() {\r\n  yield takeLatest(saga_action_types.save, save)\r\n}\r\n\r\nfunction* watch_load() {\r\n  yield takeLatest(saga_action_types.load, load)\r\n}\r\n\r\nfunction* watch_rpc() {\r\n  yield takeEvery(saga_action_types.rpc, rpc)\r\n}\r\n\r\nfunction* watch_rpc_from_key() {\r\n  yield takeEvery(saga_action_types.rpc_from_key, rpc_from_key)\r\n}\r\n\r\n// These are the exported sagas.\r\nexport const sagas = [\r\n  watch_fetch_state,\r\n  watch_set_selected_annotation,\r\n  watch_set_selected_worldline,\r\n  watch_center_on_current_annotation,\r\n  watch_adjust_t,\r\n  watch_click,\r\n  watch_doubleclick,\r\n  watch_save,\r\n  watch_load,\r\n  watch_rpc,\r\n  watch_rpc_from_key,\r\n]","\r\nimport React from 'react'\r\n\r\ntype SimpleFormProps = {\r\n  name: string,\r\n  action: Function\r\n}\r\n\r\ntype ActionFormProps = SimpleFormProps & { input_parser: Function }\r\n\r\ntype ActionFormState = { value: string }\r\n\r\nexport class ActionForm extends\r\n  React.Component<ActionFormProps, ActionFormState>\r\n{\r\n\r\n  constructor(props: ActionFormProps) {\r\n    super(props);\r\n    this.state = { value: \"0\" }\r\n\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n\r\n  handleChange(event: any) {\r\n    this.setState({ value: event.target.value });\r\n  }\r\n\r\n  handleSubmit(event: any) {\r\n    this.props.action(this.props.input_parser(this.state.value))\r\n    event.preventDefault()\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <form onSubmit={this.handleSubmit}>\r\n        <input type=\"submit\" value={this.props.name} />\r\n        <input type=\"text\"\r\n          defaultValue={this.state.value}\r\n          onChange={this.handleChange} />\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\nexport const FloatForm = (props: SimpleFormProps) =>\r\n  <ActionForm {...props} input_parser={parseFloat} />","/* This file should provide an interface to visualize the state and dispatch\r\nactions. UI and styling should be minimal. */\r\n\r\nimport React from 'react'\r\nimport { connect } from \"react-redux\"\r\n//import { TextField, Button}  from '@material-ui/core';\r\n\r\nimport * as selectors from '../selectors'\r\nimport { actions } from '../actions'\r\nimport { saga_actions } from '../sagas'\r\nimport { State_t } from '../../app/model'\r\nimport { FloatForm } from '../../test_components/ActionForm'\r\n\r\nconst _Test = ({ state, x_idx, ...A }: any) => {\r\n\r\n  const derived_state = { x_idx }\r\n\r\n  const full_state = { bare_state: state, derived_state }\r\n\r\n  const state_json = JSON.stringify(full_state, null, 4);\r\n\r\n  return (\r\n    <div>\r\n      <pre><code>annotation_window: {state_json}</code></pre>\r\n\r\n      <br />\r\n\r\n      Simple Actions:\r\n      <FloatForm name=\"set_shape_x\" action={A.set_shape_x} />\r\n      <FloatForm name=\"set_x\" action={A.set_x} />\r\n      <FloatForm name=\"adjust_x\" action={A.adjust_x} />\r\n      <FloatForm name=\"set_scale_x\" action={A.set_scale_x} />\r\n\r\n      <br />\r\n\r\n      Async Actions:\r\n      <br />\r\n      <button onClick={() => A.fetch_state()}>fetch_state</button>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    state: selectors.get_state(state),\r\n    x_idx: selectors.get_x_idx(state)\r\n  }\r\n}\r\n\r\nconst AnnotationWindowTest =\r\n  connect(mapStateToProps, { ...actions, ...saga_actions })(_Test)\r\n\r\nexport default AnnotationWindowTest","import React, { Component } from 'react'\r\nimport { connect, ConnectedProps } from 'react-redux'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../..'\r\nimport { fetch_data_cache } from '../../api'\r\n\r\nimport { selectors } from '../'\r\nimport { apply_LUT } from '../helpers'\r\nimport { saga_actions, click_payload_t } from '../sagas'\r\nimport { AnnotationsSVG } from '../../annotations'\r\n\r\nimport { selectors as annotations_selectors } from '../../annotations'\r\n\r\nconst mapStateToProps_X = (state: State_t) => {\r\n  return {\r\n    height: selectors.get_shape_y(state),\r\n    width: selectors.get_shape_z(state),\r\n    height_scale: selectors.get_scale_y(state),\r\n    width_scale: selectors.get_scale_z(state),\r\n    data_url: selectors.get_x_url(state),\r\n    x: selectors.get_z(state),\r\n    y: selectors.get_y(state),\r\n    x_dim: \"z\",\r\n    y_dim: \"y\",\r\n    annotations: annotations_selectors.get_x_annotations(state),\r\n    fill_circles: selectors.get_fill_circles(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst mapStateToProps_Y = (state: State_t) => {\r\n  return {\r\n    height: selectors.get_shape_z(state),\r\n    width: selectors.get_shape_x(state),\r\n    height_scale: selectors.get_scale_z(state),\r\n    width_scale: selectors.get_scale_x(state),\r\n    data_url: selectors.get_y_url(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_z(state),\r\n    x_dim: \"x\",\r\n    y_dim: \"z\",\r\n    annotations: annotations_selectors.get_y_annotations(state),\r\n    fill_circles: selectors.get_fill_circles(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst mapStateToProps_Z = (state: State_t) => {\r\n  return {\r\n    height: selectors.get_shape_y(state),\r\n    width: selectors.get_shape_x(state),\r\n    height_scale: selectors.get_scale_y(state),\r\n    width_scale: selectors.get_scale_x(state),\r\n    data_url: selectors.get_z_url(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_y(state),\r\n    x_dim: \"x\",\r\n    y_dim: \"y\",\r\n    annotations: annotations_selectors.get_z_annotations(state),\r\n    fill_circles: selectors.get_fill_circles(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    select: (x: number) => dispatch(saga_actions.set_selected_annotation(x)),\r\n    deselect: () => dispatch(saga_actions.set_selected_annotation(null)),\r\n    click: (x: click_payload_t) => dispatch(saga_actions.click(x)),\r\n    doubleclick: (x: click_payload_t) =>\r\n      dispatch(saga_actions.doubleclick(x))\r\n  }\r\n}\r\n\r\nconst connector_X = connect(mapStateToProps_X, mapDispatchToProps)\r\nconst connector_Y = connect(mapStateToProps_Y, mapDispatchToProps)\r\nconst connector_Z = connect(mapStateToProps_Z, mapDispatchToProps)\r\n\r\ntype ReduxProps_t = ConnectedProps<typeof connector_X>\r\ntype AnnotationView_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\ntype AnnotationView_state_t = {\r\n  data: Uint8ClampedArray | null\r\n}\r\n\r\nclass AnnotationView\r\n  extends Component<AnnotationView_props_t, AnnotationView_state_t> {\r\n\r\n  state: AnnotationView_state_t\r\n  abort_controller: AbortController\r\n\r\n  constructor(props: AnnotationView_props_t) {\r\n    super(props)\r\n    this.abort_controller = new AbortController()\r\n    this.state = {\r\n      data: null,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetch_and_draw()\r\n  }\r\n\r\n  componentDidUpdate(prev_props: AnnotationView_props_t) {\r\n    if (this.props.data_url !== prev_props.data_url)\r\n      this.fetch_and_draw()\r\n    else if (this.props.LUT !== prev_props.LUT)\r\n      this.draw_to_canvas()\r\n  }\r\n\r\n  fetch_and_draw = () => {\r\n\r\n    this.abort_controller.abort()\r\n    this.abort_controller = new AbortController()\r\n\r\n    fetch_data_cache(this.props.data_url, this.abort_controller.signal)\r\n      .then(data => this.setState({ data }))\r\n      .then(this.draw_to_canvas)\r\n  }\r\n\r\n  draw_to_canvas = () => {\r\n\r\n    if ((this.state.data != null) &&\r\n      (this.props.width > 0) &&\r\n      (this.props.height > 0)) {\r\n\r\n      const LUTdata = apply_LUT(this.state.data, this.props.LUT)\r\n\r\n      const cvs = this.refs.canvas as HTMLCanvasElement\r\n      const ctx = cvs.getContext(\"2d\")\r\n\r\n      const iData = new ImageData(\r\n        LUTdata,\r\n        this.props.width,\r\n        this.props.height);\r\n\r\n      ctx?.putImageData(iData, 0, 0)\r\n\r\n    }\r\n  }\r\n\r\n  make_click_handler = (click_fn: any) => (event: React.MouseEvent) => {\r\n    const target = event.target as HTMLElement;\r\n    const dim = target.getBoundingClientRect();\r\n    const x_pixels = event.clientX - dim.left;\r\n    const y_pixels = event.clientY - dim.top;\r\n\r\n    const svg_width = this.props.width * this.props.width_scale\r\n    const svg_height = this.props.height * this.props.height_scale\r\n\r\n    const x_local = x_pixels / svg_width\r\n    const y_local = y_pixels / svg_height\r\n\r\n    click_fn({\r\n      [this.props.x_dim]: x_local,\r\n      [this.props.y_dim]: y_local\r\n    })\r\n\r\n  }\r\n\r\n  handle_click = this.make_click_handler(this.props.click)\r\n  handle_doubleclick = this.make_click_handler(this.props.doubleclick)\r\n\r\n  render() {\r\n\r\n    const svg_width = this.props.width * this.props.width_scale\r\n    const svg_height = this.props.height * this.props.height_scale\r\n\r\n    const hline =\r\n      <line\r\n        x1={0}\r\n        y1={this.props.y * svg_height}\r\n        x2={svg_width}\r\n        y2={this.props.y * svg_height}\r\n        strokeWidth=\"0.4\" stroke=\"grey\" />\r\n    const vline =\r\n      <line\r\n        x1={this.props.x * svg_width}\r\n        y1={0}\r\n        x2={this.props.x * svg_width}\r\n        y2={svg_height}\r\n        strokeWidth=\"0.4\" stroke=\"grey\" />\r\n\r\n    return (\r\n      <div style={{\r\n        position: \"relative\",\r\n        left: this.props.left,\r\n        top: this.props.top,\r\n        right: \"0px\",\r\n      }}>\r\n\r\n        <canvas ref=\"canvas\"\r\n          width={this.props.width}\r\n          height={this.props.height}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            top: \"0px\",\r\n            zIndex: 1,\r\n            width: this.props.width * this.props.width_scale,\r\n            height: this.props.height * this.props.height_scale\r\n          }}>\r\n        </canvas>\r\n\r\n        <svg ref=\"svg\"\r\n          width={this.props.width * this.props.width_scale}\r\n          height={this.props.height * this.props.height_scale}\r\n          onClick={this.handle_click}\r\n          onDoubleClick={this.handle_doubleclick}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            top: \"0px\",\r\n            zIndex: 2,\r\n          }}>\r\n          <AnnotationsSVG\r\n            annotations={this.props.annotations}\r\n            size_x={this.props.width * this.props.width_scale}\r\n            size_y={this.props.height * this.props.height_scale}\r\n            select={this.props.select}\r\n            deselect={this.props.deselect}\r\n            fill_circles={this.props.fill_circles} />\r\n          {hline}\r\n          {vline}\r\n        </svg>\r\n      </div>)\r\n  }\r\n}\r\n\r\nexport const AnnotationViewX = connector_X(AnnotationView)\r\nexport const AnnotationViewY = connector_Y(AnnotationView)\r\nexport const AnnotationViewZ = connector_Z(AnnotationView)\r\n","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { createNextState } from '@reduxjs/toolkit'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\nimport { get } from 'lodash'\r\n\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Card from '@material-ui/core/Card'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport SaveIcon from '@material-ui/icons/Save'\r\nimport GetApp from '@material-ui/icons/GetApp'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport Select from '@material-ui/core/Select'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { AppDispatch_t } from '../../index'\r\nimport { AnnotationWindowState_t } from '../model'\r\nimport { actions, saga_actions, selectors } from '../'\r\n\r\nconst DocstringTooltip = withStyles({\r\n  tooltip: {\r\n    maxWidth: 600,\r\n    margin: 10,\r\n    padding: 10,\r\n    position: \"absolute\",\r\n    top: -50\r\n  }\r\n})(Tooltip)\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    window_state: selectors.get_state(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    actions: bindActionCreators({ ...actions }, dispatch),\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype WindowPanel_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\nconst _WindowPanel = (props: WindowPanel_props_t) => {\r\n\r\n  const [window_state, set_window_state] = React.useState(props.window_state)\r\n\r\n  React.useEffect(() => {\r\n    set_window_state({\r\n      ...props.window_state,\r\n      x: parseFloat(props.window_state.x.toFixed(3)),\r\n      y: parseFloat(props.window_state.y.toFixed(3)),\r\n      z: parseFloat(props.window_state.z.toFixed(3)),\r\n    });\r\n  },\r\n    [props.window_state])\r\n\r\n  const handle_change = (key: string, value: string) => {\r\n    const new_state = { ...(window_state), [key]: value }\r\n    set_window_state(new_state)\r\n  }\r\n\r\n  const handle_new_rpc_keybinding = (key: string, rpc_idx: number) => {\r\n\r\n    props.actions.set_rpc_keybinding([key, rpc_idx])\r\n\r\n    props.actions.set_rpc_arg([key,\r\n      window_state.rpc_list[rpc_idx].default_args])\r\n  }\r\n\r\n  const handle_rpc_arg_change = (key: string, value: string) => {\r\n\r\n    const rpc_idx = window_state.rpc_keybindings[key]\r\n\r\n    const nextState = createNextState(window_state, draft => {\r\n      draft.rpc_args[key] = value\r\n      draft.rpc_list[rpc_idx].default_args = value\r\n    })\r\n\r\n    set_window_state(nextState)\r\n  }\r\n\r\n\r\n  const update = () => {\r\n    props.actions.set_x(window_state.x)\r\n    props.actions.set_y(window_state.y)\r\n    props.actions.set_z(window_state.z)\r\n    props.actions.set_t_idx(window_state.t_idx)\r\n\r\n    const a = window_state.selected_annotation\r\n    if ((a === null) || String(a) === \"\") {\r\n      props.saga_actions.set_selected_annotation(null)\r\n    } else {\r\n      props.saga_actions.set_selected_annotation(Number(a))\r\n    }\r\n\r\n    const w = window_state.selected_worldline\r\n    if ((w === null) || String(w) === \"\") {\r\n      props.saga_actions.set_selected_worldline(null)\r\n    } else {\r\n      props.saga_actions.set_selected_worldline(Number(w))\r\n    }\r\n\r\n    props.actions.set_active_provenance(window_state.active_provenance)\r\n\r\n    props.actions.set_rpc_args(window_state.rpc_args)\r\n    props.actions.set_rpc_list(window_state.rpc_list)\r\n\r\n  }\r\n\r\n  const TF = (field: string, name: string) => {\r\n    const field_key = field as keyof AnnotationWindowState_t\r\n\r\n    return <TextField\r\n      type=\"string\"\r\n      label={name}\r\n      key={field_key}\r\n      value={window_state[field_key] !== null ? window_state[field_key] : \"\"}\r\n      onChange={(event) => handle_change(field_key, event.target.value)}\r\n      onBlur={update}\r\n      style={{\r\n        position: \"relative\",\r\n        width: \"80px\",\r\n        margin: \"10px\",\r\n      }}\r\n      InputLabelProps= {{style: { fontSize: 14 }}}\r\n      InputProps={{ style: { fontFamily: \"monospace\" } }}\r\n    />\r\n  }\r\n\r\n  const textfields = [\r\n    [\"x\", \"x\"],\r\n    [\"y\", \"y\"],\r\n    [\"z\", \"z\"],\r\n    [\"t_idx\", \"t\"],\r\n    [\"selected_annotation\", \"anno.\"],\r\n    [\"selected_worldline\", \"track\"],\r\n    [\"active_provenance\", \"prov\"]]\r\n    .map((x) => TF(x[0], x[1]))\r\n\r\n  const RPCKeyConfig = (keyname: string) => {\r\n\r\n    const rpc_idx = get(window_state.rpc_keybindings, keyname, 0)\r\n    const rpc = get(window_state.rpc_list, rpc_idx)\r\n    let docstring\r\n    if (rpc) {\r\n      docstring = get(rpc, \"docstring\", \"\")\r\n    } else {\r\n      docstring = \"\"\r\n    }\r\n\r\n    return (\r\n      <React.Fragment key={keyname}>\r\n        <DocstringTooltip\r\n          interactive\r\n          title={\r\n            <pre style={{ fontSize: 14 }} >\r\n              {docstring}\r\n            </pre>}\r\n          placement=\"right\"\r\n        >\r\n          <FormControl style={{\r\n            width: 810, margin: 10, top: 10, marginBottom: 50\r\n          }}>\r\n            <InputLabel id={`action-${keyname}-select-label`}>Key {keyname}\r\n            </InputLabel>\r\n            <Select\r\n              labelId={`action-${keyname}-select-label`}\r\n              id={`action-${keyname}-select`}\r\n              value={rpc_idx}\r\n              onChange={(event) => handle_new_rpc_keybinding(\r\n                keyname, Number(event.target.value))}\r\n              style={{\r\n                width: 250,\r\n                position: \"absolute\",\r\n                fontFamily: \"monospace\"\r\n              }}\r\n            >\r\n              {props.window_state.rpc_list.map((x, idx) =>\r\n                <MenuItem\r\n                  style={{ fontFamily: \"monospace\" }}\r\n                  value={idx}\r\n                  key={idx}>\r\n                  {x.name}\r\n                </MenuItem>\r\n              )}\r\n            </Select>\r\n            <TextField\r\n              type=\"string\"\r\n              label={\"arg\"}\r\n              value={window_state.rpc_args[keyname]}\r\n              onChange={(event) => handle_rpc_arg_change(\r\n                keyname, event.target.value)}\r\n              onBlur={update}\r\n              style={{\r\n                position: \"absolute\",\r\n                left: 300,\r\n                width: 400,\r\n              }}\r\n              InputProps={{ style: { fontFamily: \"monospace\" } }}\r\n            />\r\n          </FormControl>\r\n        </DocstringTooltip>\r\n      </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const rpc_keys = \"1234567890\".split(\"\").map(RPCKeyConfig)\r\n\r\n  return (\r\n    <Card\r\n      elevation={3}\r\n      variant=\"outlined\"\r\n      square\r\n      style={{\r\n        position: \"absolute\",\r\n        left: props.left,\r\n        top: props.top,\r\n        width: \"840px\",\r\n        height: \"1000px\"\r\n      }}>\r\n      <CardContent>\r\n        <h3>Annotation Window</h3>\r\n\r\n        <Tooltip title=\"Load from disk\">\r\n          <IconButton\r\n            aria-label=\"load\"\r\n            onClick={() => props.saga_actions.load()}\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"650px\",\r\n              top: \"5px\"\r\n            }}>\r\n            <GetApp fontSize=\"small\" />\r\n          </IconButton>\r\n        </Tooltip>\r\n\r\n        <Tooltip title=\"Save to disk\">\r\n          <IconButton\r\n            aria-label=\"save\"\r\n            onClick={() => props.saga_actions.save()}\r\n            style={{\r\n              position: \"absolute\",\r\n              left: \"700px\",\r\n              top: \"5px\"\r\n            }}>\r\n            <SaveIcon fontSize=\"small\" />\r\n          </IconButton>\r\n        </Tooltip>\r\n\r\n        {textfields}\r\n\r\n        <Tooltip title=\"Keyboard shortcut: o\">\r\n          <div style={{width:150, float: \"left\"}}>\r\n            <input type=\"checkbox\"\r\n              checked={props.window_state.fill_circles}\r\n              id=\"fill-circles-cb\"\r\n              onChange={(event) =>\r\n                props.actions.set_fill_circles(event.target.checked)}\r\n              style={{\r\n                // float: \"left\",\r\n                marginTop: \"30px\"\r\n              }} />\r\n            <label>Fill circles</label>\r\n          </div>\r\n        </Tooltip>\r\n\r\n        <Tooltip title=\"Keyboard shortcut: a\">\r\n          <div style={{width:150, float: \"left\"}}>\r\n            <input type=\"checkbox\"\r\n              checked={props.window_state.show_all_annotations}\r\n              id=\"all-annotations-cb\"\r\n              onChange={(event) =>\r\n                props.actions.set_show_all_annotations(event.target.checked)}\r\n              style={{\r\n                // float: \"left\",\r\n                marginTop: \"30px\"\r\n              }} />\r\n            <label>Show all</label>\r\n          </div>\r\n        </Tooltip>\r\n\r\n\r\n        {rpc_keys}\r\n\r\n      </CardContent>\r\n    </Card>)\r\n}\r\n\r\nconst WindowPanel = connector(_WindowPanel)\r\nexport default WindowPanel","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\r\n\r\n// Configuration Constants\r\nexport const EPSILON = 0.000001;\r\nexport let ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\r\nexport const RANDOM = Math.random;\r\n\r\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\r\nexport function setMatrixArrayType(type) {\r\n  ARRAY_TYPE = type;\r\n}\r\n\r\nconst degree = Math.PI / 180;\r\n\r\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\r\nexport function toRadian(a) {\r\n  return a * degree;\r\n}\r\n\r\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  return Math.abs(a - b) <= EPSILON*Math.max(1.0, Math.abs(a), Math.abs(b));\r\n}\r\n\r\nif (!Math.hypot) Math.hypot = function() {\r\n  var y = 0, i = arguments.length;\r\n  while (i--) y += arguments[i] * arguments[i];\r\n  return Math.sqrt(y);\r\n};\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\r\n\r\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[5] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[4] = 1;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\r\nexport function fromMat4(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[4];\r\n  out[4] = a[5];\r\n  out[5] = a[6];\r\n  out[6] = a[8];\r\n  out[7] = a[9];\r\n  out[8] = a[10];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\r\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m10;\r\n  out[4] = m11;\r\n  out[5] = m12;\r\n  out[6] = m20;\r\n  out[7] = m21;\r\n  out[8] = m22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\r\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m10;\r\n  out[4] = m11;\r\n  out[5] = m12;\r\n  out[6] = m20;\r\n  out[7] = m21;\r\n  out[8] = m22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 1;\r\n  out[5] = 0;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function transpose(out, a) {\r\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n  if (out === a) {\r\n    let a01 = a[1],\r\n      a02 = a[2],\r\n      a12 = a[5];\r\n    out[1] = a[3];\r\n    out[2] = a[6];\r\n    out[3] = a01;\r\n    out[5] = a[7];\r\n    out[6] = a02;\r\n    out[7] = a12;\r\n  } else {\r\n    out[0] = a[0];\r\n    out[1] = a[3];\r\n    out[2] = a[6];\r\n    out[3] = a[1];\r\n    out[4] = a[4];\r\n    out[5] = a[7];\r\n    out[6] = a[2];\r\n    out[7] = a[5];\r\n    out[8] = a[8];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function invert(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  let b01 = a22 * a11 - a12 * a21;\r\n  let b11 = -a22 * a10 + a12 * a20;\r\n  let b21 = a21 * a10 - a11 * a20;\r\n\r\n  // Calculate the determinant\r\n  let det = a00 * b01 + a01 * b11 + a02 * b21;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = b01 * det;\r\n  out[1] = (-a22 * a01 + a02 * a21) * det;\r\n  out[2] = (a12 * a01 - a02 * a11) * det;\r\n  out[3] = b11 * det;\r\n  out[4] = (a22 * a00 - a02 * a20) * det;\r\n  out[5] = (-a12 * a00 + a02 * a10) * det;\r\n  out[6] = b21 * det;\r\n  out[7] = (-a21 * a00 + a01 * a20) * det;\r\n  out[8] = (a11 * a00 - a01 * a10) * det;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function adjoint(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  out[0] = a11 * a22 - a12 * a21;\r\n  out[1] = a02 * a21 - a01 * a22;\r\n  out[2] = a01 * a12 - a02 * a11;\r\n  out[3] = a12 * a20 - a10 * a22;\r\n  out[4] = a00 * a22 - a02 * a20;\r\n  out[5] = a02 * a10 - a00 * a12;\r\n  out[6] = a10 * a21 - a11 * a20;\r\n  out[7] = a01 * a20 - a00 * a21;\r\n  out[8] = a00 * a11 - a01 * a10;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  return (\r\n    a00 * (a22 * a11 - a12 * a21) +\r\n    a01 * (-a22 * a10 + a12 * a20) +\r\n    a02 * (a21 * a10 - a11 * a20)\r\n  );\r\n}\r\n\r\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2];\r\n  let a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5];\r\n  let a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8];\r\n\r\n  let b00 = b[0],\r\n    b01 = b[1],\r\n    b02 = b[2];\r\n  let b10 = b[3],\r\n    b11 = b[4],\r\n    b12 = b[5];\r\n  let b20 = b[6],\r\n    b21 = b[7],\r\n    b22 = b[8];\r\n\r\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\r\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\r\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\r\n\r\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\r\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\r\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\r\n\r\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\r\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\r\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\r\nexport function translate(out, a, v) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5],\r\n    a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8],\r\n    x = v[0],\r\n    y = v[1];\r\n\r\n  out[0] = a00;\r\n  out[1] = a01;\r\n  out[2] = a02;\r\n\r\n  out[3] = a10;\r\n  out[4] = a11;\r\n  out[5] = a12;\r\n\r\n  out[6] = x * a00 + y * a10 + a20;\r\n  out[7] = x * a01 + y * a11 + a21;\r\n  out[8] = x * a02 + y * a12 + a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\r\nexport function rotate(out, a, rad) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a10 = a[3],\r\n    a11 = a[4],\r\n    a12 = a[5],\r\n    a20 = a[6],\r\n    a21 = a[7],\r\n    a22 = a[8],\r\n    s = Math.sin(rad),\r\n    c = Math.cos(rad);\r\n\r\n  out[0] = c * a00 + s * a10;\r\n  out[1] = c * a01 + s * a11;\r\n  out[2] = c * a02 + s * a12;\r\n\r\n  out[3] = c * a10 - s * a00;\r\n  out[4] = c * a11 - s * a01;\r\n  out[5] = c * a12 - s * a02;\r\n\r\n  out[6] = a20;\r\n  out[7] = a21;\r\n  out[8] = a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let x = v[0],\r\n    y = v[1];\r\n\r\n  out[0] = x * a[0];\r\n  out[1] = x * a[1];\r\n  out[2] = x * a[2];\r\n\r\n  out[3] = y * a[3];\r\n  out[4] = y * a[4];\r\n  out[5] = y * a[5];\r\n\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\r\nexport function fromTranslation(out, v) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 1;\r\n  out[5] = 0;\r\n  out[6] = v[0];\r\n  out[7] = v[1];\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\r\nexport function fromRotation(out, rad) {\r\n  let s = Math.sin(rad),\r\n    c = Math.cos(rad);\r\n\r\n  out[0] = c;\r\n  out[1] = s;\r\n  out[2] = 0;\r\n\r\n  out[3] = -s;\r\n  out[4] = c;\r\n  out[5] = 0;\r\n\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n\r\n  out[3] = 0;\r\n  out[4] = v[1];\r\n  out[5] = 0;\r\n\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\r\nexport function fromMat2d(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = 0;\r\n\r\n  out[3] = a[2];\r\n  out[4] = a[3];\r\n  out[5] = 0;\r\n\r\n  out[6] = a[4];\r\n  out[7] = a[5];\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\r\nexport function fromQuat(out, q) {\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let yx = y * x2;\r\n  let yy = y * y2;\r\n  let zx = z * x2;\r\n  let zy = z * y2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - yy - zz;\r\n  out[3] = yx - wz;\r\n  out[6] = zx + wy;\r\n\r\n  out[1] = yx + wz;\r\n  out[4] = 1 - xx - zz;\r\n  out[7] = zy - wx;\r\n\r\n  out[2] = zx - wy;\r\n  out[5] = zy + wx;\r\n  out[8] = 1 - xx - yy;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\r\nexport function normalFromMat4(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  // Calculate the determinant\r\n  let det =\r\n    b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n\r\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n\r\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\r\nexport function projection(out, width, height) {\r\n  out[0] = 2 / width;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = -2 / height;\r\n  out[5] = 0;\r\n  out[6] = -1;\r\n  out[7] = 1;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return (\r\n    \"mat3(\" +\r\n    a[0] +\r\n    \", \" +\r\n    a[1] +\r\n    \", \" +\r\n    a[2] +\r\n    \", \" +\r\n    a[3] +\r\n    \", \" +\r\n    a[4] +\r\n    \", \" +\r\n    a[5] +\r\n    \", \" +\r\n    a[6] +\r\n    \", \" +\r\n    a[7] +\r\n    \", \" +\r\n    a[8] +\r\n    \")\"\r\n  );\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\r\n}\r\n\r\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  out[6] = a[6] + b[6];\r\n  out[7] = a[7] + b[7];\r\n  out[8] = a[8] + b[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  out[4] = a[4] - b[4];\r\n  out[5] = a[5] - b[5];\r\n  out[6] = a[6] - b[6];\r\n  out[7] = a[7] - b[7];\r\n  out[8] = a[8] - b[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  out[6] = a[6] * b;\r\n  out[7] = a[7] * b;\r\n  out[8] = a[8] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  out[3] = a[3] + b[3] * scale;\r\n  out[4] = a[4] + b[4] * scale;\r\n  out[5] = a[5] + b[5] * scale;\r\n  out[6] = a[6] + b[6] * scale;\r\n  out[7] = a[7] + b[7] * scale;\r\n  out[8] = a[8] + b[8] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return (\r\n    a[0] === b[0] &&\r\n    a[1] === b[1] &&\r\n    a[2] === b[2] &&\r\n    a[3] === b[3] &&\r\n    a[4] === b[4] &&\r\n    a[5] === b[5] &&\r\n    a[6] === b[6] &&\r\n    a[7] === b[7] &&\r\n    a[8] === b[8]\r\n  );\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3],\r\n    a4 = a[4],\r\n    a5 = a[5],\r\n    a6 = a[6],\r\n    a7 = a[7],\r\n    a8 = a[8];\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3],\r\n    b4 = b[4],\r\n    b5 = b[5],\r\n    b6 = b[6],\r\n    b7 = b[7],\r\n    b8 = b[8];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n    Math.abs(a3 - b3) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n    Math.abs(a4 - b4) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n    Math.abs(a5 - b5) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\r\n    Math.abs(a6 - b6) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\r\n    Math.abs(a7 - b7) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\r\n    Math.abs(a8 - b8) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\r\n\r\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[11] = 0;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[5] = 1;\r\n  out[10] = 1;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  out[9] = a[9];\r\n  out[10] = a[10];\r\n  out[11] = a[11];\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  out[9] = a[9];\r\n  out[10] = a[10];\r\n  out[11] = a[11];\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\r\nexport function fromValues(\r\n  m00,\r\n  m01,\r\n  m02,\r\n  m03,\r\n  m10,\r\n  m11,\r\n  m12,\r\n  m13,\r\n  m20,\r\n  m21,\r\n  m22,\r\n  m23,\r\n  m30,\r\n  m31,\r\n  m32,\r\n  m33\r\n) {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m03;\r\n  out[4] = m10;\r\n  out[5] = m11;\r\n  out[6] = m12;\r\n  out[7] = m13;\r\n  out[8] = m20;\r\n  out[9] = m21;\r\n  out[10] = m22;\r\n  out[11] = m23;\r\n  out[12] = m30;\r\n  out[13] = m31;\r\n  out[14] = m32;\r\n  out[15] = m33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\r\nexport function set(\r\n  out,\r\n  m00,\r\n  m01,\r\n  m02,\r\n  m03,\r\n  m10,\r\n  m11,\r\n  m12,\r\n  m13,\r\n  m20,\r\n  m21,\r\n  m22,\r\n  m23,\r\n  m30,\r\n  m31,\r\n  m32,\r\n  m33\r\n) {\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m03;\r\n  out[4] = m10;\r\n  out[5] = m11;\r\n  out[6] = m12;\r\n  out[7] = m13;\r\n  out[8] = m20;\r\n  out[9] = m21;\r\n  out[10] = m22;\r\n  out[11] = m23;\r\n  out[12] = m30;\r\n  out[13] = m31;\r\n  out[14] = m32;\r\n  out[15] = m33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function transpose(out, a) {\r\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n  if (out === a) {\r\n    let a01 = a[1],\r\n      a02 = a[2],\r\n      a03 = a[3];\r\n    let a12 = a[6],\r\n      a13 = a[7];\r\n    let a23 = a[11];\r\n\r\n    out[1] = a[4];\r\n    out[2] = a[8];\r\n    out[3] = a[12];\r\n    out[4] = a01;\r\n    out[6] = a[9];\r\n    out[7] = a[13];\r\n    out[8] = a02;\r\n    out[9] = a12;\r\n    out[11] = a[14];\r\n    out[12] = a03;\r\n    out[13] = a13;\r\n    out[14] = a23;\r\n  } else {\r\n    out[0] = a[0];\r\n    out[1] = a[4];\r\n    out[2] = a[8];\r\n    out[3] = a[12];\r\n    out[4] = a[1];\r\n    out[5] = a[5];\r\n    out[6] = a[9];\r\n    out[7] = a[13];\r\n    out[8] = a[2];\r\n    out[9] = a[6];\r\n    out[10] = a[10];\r\n    out[11] = a[14];\r\n    out[12] = a[3];\r\n    out[13] = a[7];\r\n    out[14] = a[11];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function invert(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  // Calculate the determinant\r\n  let det =\r\n    b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\r\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\r\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\r\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\r\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\r\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\r\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function adjoint(out, a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  out[0] = a11 * b11 - a12 * b10 + a13 * b09;\r\n  out[1] = a02 * b10 - a01 * b11 - a03 * b09;\r\n  out[2] = a31 * b05 - a32 * b04 + a33 * b03;\r\n  out[3] = a22 * b04 - a21 * b05 - a23 * b03;\r\n  out[4] = a12 * b08 - a10 * b11 - a13 * b07;\r\n  out[5] = a00 * b11 - a02 * b08 + a03 * b07;\r\n  out[6] = a32 * b02 - a30 * b05 - a33 * b01;\r\n  out[7] = a20 * b05 - a22 * b02 + a23 * b01;\r\n  out[8] = a10 * b10 - a11 * b08 + a13 * b06;\r\n  out[9] = a01 * b08 - a00 * b10 - a03 * b06;\r\n  out[10] = a30 * b04 - a31 * b02 + a33 * b00;\r\n  out[11] = a21 * b02 - a20 * b04 - a23 * b00;\r\n  out[12] = a11 * b07 - a10 * b09 - a12 * b06;\r\n  out[13] = a00 * b09 - a01 * b07 + a02 * b06;\r\n  out[14] = a31 * b01 - a30 * b03 - a32 * b00;\r\n  out[15] = a20 * b03 - a21 * b01 + a22 * b00;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  let b0 = a00 * a11 - a01 * a10;\r\n  let b1 = a00 * a12 - a02 * a10;\r\n  let b2 = a01 * a12 - a02 * a11;\r\n  let b3 = a20 * a31 - a21 * a30;\r\n  let b4 = a20 * a32 - a22 * a30;\r\n  let b5 = a21 * a32 - a22 * a31;\r\n  let b6 = a00 * b5 - a01 * b4 + a02 * b3;\r\n  let b7 = a10 * b5 - a11 * b4 + a12 * b3;\r\n  let b8 = a20 * b2 - a21 * b1 + a22 * b0;\r\n  let b9 = a30 * b2 - a31 * b1 + a32 * b0;\r\n\r\n  // Calculate the determinant\r\n  return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\r\n}\r\n\r\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a00 = a[0],\r\n    a01 = a[1],\r\n    a02 = a[2],\r\n    a03 = a[3];\r\n  let a10 = a[4],\r\n    a11 = a[5],\r\n    a12 = a[6],\r\n    a13 = a[7];\r\n  let a20 = a[8],\r\n    a21 = a[9],\r\n    a22 = a[10],\r\n    a23 = a[11];\r\n  let a30 = a[12],\r\n    a31 = a[13],\r\n    a32 = a[14],\r\n    a33 = a[15];\r\n\r\n  // Cache only the current line of the second matrix\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3];\r\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n\r\n  b0 = b[4];\r\n  b1 = b[5];\r\n  b2 = b[6];\r\n  b3 = b[7];\r\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n\r\n  b0 = b[8];\r\n  b1 = b[9];\r\n  b2 = b[10];\r\n  b3 = b[11];\r\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n\r\n  b0 = b[12];\r\n  b1 = b[13];\r\n  b2 = b[14];\r\n  b3 = b[15];\r\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\r\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\r\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\r\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\r\nexport function translate(out, a, v) {\r\n  let x = v[0],\r\n    y = v[1],\r\n    z = v[2];\r\n  let a00, a01, a02, a03;\r\n  let a10, a11, a12, a13;\r\n  let a20, a21, a22, a23;\r\n\r\n  if (a === out) {\r\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\r\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\r\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\r\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\r\n  } else {\r\n    a00 = a[0];\r\n    a01 = a[1];\r\n    a02 = a[2];\r\n    a03 = a[3];\r\n    a10 = a[4];\r\n    a11 = a[5];\r\n    a12 = a[6];\r\n    a13 = a[7];\r\n    a20 = a[8];\r\n    a21 = a[9];\r\n    a22 = a[10];\r\n    a23 = a[11];\r\n\r\n    out[0] = a00;\r\n    out[1] = a01;\r\n    out[2] = a02;\r\n    out[3] = a03;\r\n    out[4] = a10;\r\n    out[5] = a11;\r\n    out[6] = a12;\r\n    out[7] = a13;\r\n    out[8] = a20;\r\n    out[9] = a21;\r\n    out[10] = a22;\r\n    out[11] = a23;\r\n\r\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\r\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\r\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\r\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let x = v[0],\r\n    y = v[1],\r\n    z = v[2];\r\n\r\n  out[0] = a[0] * x;\r\n  out[1] = a[1] * x;\r\n  out[2] = a[2] * x;\r\n  out[3] = a[3] * x;\r\n  out[4] = a[4] * y;\r\n  out[5] = a[5] * y;\r\n  out[6] = a[6] * y;\r\n  out[7] = a[7] * y;\r\n  out[8] = a[8] * z;\r\n  out[9] = a[9] * z;\r\n  out[10] = a[10] * z;\r\n  out[11] = a[11] * z;\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\r\nexport function rotate(out, a, rad, axis) {\r\n  let x = axis[0],\r\n    y = axis[1],\r\n    z = axis[2];\r\n  let len = Math.hypot(x, y, z);\r\n  let s, c, t;\r\n  let a00, a01, a02, a03;\r\n  let a10, a11, a12, a13;\r\n  let a20, a21, a22, a23;\r\n  let b00, b01, b02;\r\n  let b10, b11, b12;\r\n  let b20, b21, b22;\r\n\r\n  if (len < glMatrix.EPSILON) {\r\n    return null;\r\n  }\r\n\r\n  len = 1 / len;\r\n  x *= len;\r\n  y *= len;\r\n  z *= len;\r\n\r\n  s = Math.sin(rad);\r\n  c = Math.cos(rad);\r\n  t = 1 - c;\r\n\r\n  a00 = a[0];\r\n  a01 = a[1];\r\n  a02 = a[2];\r\n  a03 = a[3];\r\n  a10 = a[4];\r\n  a11 = a[5];\r\n  a12 = a[6];\r\n  a13 = a[7];\r\n  a20 = a[8];\r\n  a21 = a[9];\r\n  a22 = a[10];\r\n  a23 = a[11];\r\n\r\n  // Construct the elements of the rotation matrix\r\n  b00 = x * x * t + c;\r\n  b01 = y * x * t + z * s;\r\n  b02 = z * x * t - y * s;\r\n  b10 = x * y * t - z * s;\r\n  b11 = y * y * t + c;\r\n  b12 = z * y * t + x * s;\r\n  b20 = x * z * t + y * s;\r\n  b21 = y * z * t - x * s;\r\n  b22 = z * z * t + c;\r\n\r\n  // Perform rotation-specific matrix multiplication\r\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\r\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\r\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\r\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\r\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\r\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\r\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\r\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\r\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\r\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\r\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\r\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged last row\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateX(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a10 = a[4];\r\n  let a11 = a[5];\r\n  let a12 = a[6];\r\n  let a13 = a[7];\r\n  let a20 = a[8];\r\n  let a21 = a[9];\r\n  let a22 = a[10];\r\n  let a23 = a[11];\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged rows\r\n    out[0] = a[0];\r\n    out[1] = a[1];\r\n    out[2] = a[2];\r\n    out[3] = a[3];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[4] = a10 * c + a20 * s;\r\n  out[5] = a11 * c + a21 * s;\r\n  out[6] = a12 * c + a22 * s;\r\n  out[7] = a13 * c + a23 * s;\r\n  out[8] = a20 * c - a10 * s;\r\n  out[9] = a21 * c - a11 * s;\r\n  out[10] = a22 * c - a12 * s;\r\n  out[11] = a23 * c - a13 * s;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateY(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a00 = a[0];\r\n  let a01 = a[1];\r\n  let a02 = a[2];\r\n  let a03 = a[3];\r\n  let a20 = a[8];\r\n  let a21 = a[9];\r\n  let a22 = a[10];\r\n  let a23 = a[11];\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged rows\r\n    out[4] = a[4];\r\n    out[5] = a[5];\r\n    out[6] = a[6];\r\n    out[7] = a[7];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = a00 * c - a20 * s;\r\n  out[1] = a01 * c - a21 * s;\r\n  out[2] = a02 * c - a22 * s;\r\n  out[3] = a03 * c - a23 * s;\r\n  out[8] = a00 * s + a20 * c;\r\n  out[9] = a01 * s + a21 * c;\r\n  out[10] = a02 * s + a22 * c;\r\n  out[11] = a03 * s + a23 * c;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateZ(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a00 = a[0];\r\n  let a01 = a[1];\r\n  let a02 = a[2];\r\n  let a03 = a[3];\r\n  let a10 = a[4];\r\n  let a11 = a[5];\r\n  let a12 = a[6];\r\n  let a13 = a[7];\r\n\r\n  if (a !== out) {\r\n    // If the source and destination differ, copy the unchanged last row\r\n    out[8] = a[8];\r\n    out[9] = a[9];\r\n    out[10] = a[10];\r\n    out[11] = a[11];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = a00 * c + a10 * s;\r\n  out[1] = a01 * c + a11 * s;\r\n  out[2] = a02 * c + a12 * s;\r\n  out[3] = a03 * c + a13 * s;\r\n  out[4] = a10 * c - a00 * s;\r\n  out[5] = a11 * c - a01 * s;\r\n  out[6] = a12 * c - a02 * s;\r\n  out[7] = a13 * c - a03 * s;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromTranslation(out, v) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = v[1];\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = v[2];\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotation(out, rad, axis) {\r\n  let x = axis[0],\r\n    y = axis[1],\r\n    z = axis[2];\r\n  let len = Math.hypot(x, y, z);\r\n  let s, c, t;\r\n\r\n  if (len < glMatrix.EPSILON) {\r\n    return null;\r\n  }\r\n\r\n  len = 1 / len;\r\n  x *= len;\r\n  y *= len;\r\n  z *= len;\r\n\r\n  s = Math.sin(rad);\r\n  c = Math.cos(rad);\r\n  t = 1 - c;\r\n\r\n  // Perform rotation-specific matrix multiplication\r\n  out[0] = x * x * t + c;\r\n  out[1] = y * x * t + z * s;\r\n  out[2] = z * x * t - y * s;\r\n  out[3] = 0;\r\n  out[4] = x * y * t - z * s;\r\n  out[5] = y * y * t + c;\r\n  out[6] = z * y * t + x * s;\r\n  out[7] = 0;\r\n  out[8] = x * z * t + y * s;\r\n  out[9] = y * z * t - x * s;\r\n  out[10] = z * z * t + c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromXRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = c;\r\n  out[6] = s;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = -s;\r\n  out[10] = c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromYRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = c;\r\n  out[1] = 0;\r\n  out[2] = -s;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = s;\r\n  out[9] = 0;\r\n  out[10] = c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromZRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = c;\r\n  out[1] = s;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = -s;\r\n  out[5] = c;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslation(out, q, v) {\r\n  // Quaternion math\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - (yy + zz);\r\n  out[1] = xy + wz;\r\n  out[2] = xz - wy;\r\n  out[3] = 0;\r\n  out[4] = xy - wz;\r\n  out[5] = 1 - (xx + zz);\r\n  out[6] = yz + wx;\r\n  out[7] = 0;\r\n  out[8] = xz + wy;\r\n  out[9] = yz - wx;\r\n  out[10] = 1 - (xx + yy);\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\r\nexport function fromQuat2(out, a) {\r\n  let translation = new glMatrix.ARRAY_TYPE(3);\r\n  let bx = -a[0],\r\n    by = -a[1],\r\n    bz = -a[2],\r\n    bw = a[3],\r\n    ax = a[4],\r\n    ay = a[5],\r\n    az = a[6],\r\n    aw = a[7];\r\n\r\n  let magnitude = bx * bx + by * by + bz * bz + bw * bw;\r\n  //Only scale if it makes sense\r\n  if (magnitude > 0) {\r\n    translation[0] = ((ax * bw + aw * bx + ay * bz - az * by) * 2) / magnitude;\r\n    translation[1] = ((ay * bw + aw * by + az * bx - ax * bz) * 2) / magnitude;\r\n    translation[2] = ((az * bw + aw * bz + ax * by - ay * bx) * 2) / magnitude;\r\n  } else {\r\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\r\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\r\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\r\n  }\r\n  fromRotationTranslation(out, a, translation);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\r\nexport function getTranslation(out, mat) {\r\n  out[0] = mat[12];\r\n  out[1] = mat[13];\r\n  out[2] = mat[14];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\r\nexport function getScaling(out, mat) {\r\n  let m11 = mat[0];\r\n  let m12 = mat[1];\r\n  let m13 = mat[2];\r\n  let m21 = mat[4];\r\n  let m22 = mat[5];\r\n  let m23 = mat[6];\r\n  let m31 = mat[8];\r\n  let m32 = mat[9];\r\n  let m33 = mat[10];\r\n\r\n  out[0] = Math.hypot(m11, m12, m13);\r\n  out[1] = Math.hypot(m21, m22, m23);\r\n  out[2] = Math.hypot(m31, m32, m33);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\r\nexport function getRotation(out, mat) {\r\n  let scaling = new glMatrix.ARRAY_TYPE(3);\r\n  getScaling(scaling, mat);\r\n\r\n  let is1 = 1 / scaling[0];\r\n  let is2 = 1 / scaling[1];\r\n  let is3 = 1 / scaling[2];\r\n\r\n  let sm11 = mat[0] * is1;\r\n  let sm12 = mat[1] * is2;\r\n  let sm13 = mat[2] * is3;\r\n  let sm21 = mat[4] * is1;\r\n  let sm22 = mat[5] * is2;\r\n  let sm23 = mat[6] * is3;\r\n  let sm31 = mat[8] * is1;\r\n  let sm32 = mat[9] * is2;\r\n  let sm33 = mat[10] * is3;\r\n\r\n  let trace = sm11 + sm22 + sm33;\r\n  let S = 0;\r\n\r\n  if (trace > 0) {\r\n    S = Math.sqrt(trace + 1.0) * 2;\r\n    out[3] = 0.25 * S;\r\n    out[0] = (sm23 - sm32) / S;\r\n    out[1] = (sm31 - sm13) / S;\r\n    out[2] = (sm12 - sm21) / S;\r\n  } else if (sm11 > sm22 && sm11 > sm33) {\r\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\r\n    out[3] = (sm23 - sm32) / S;\r\n    out[0] = 0.25 * S;\r\n    out[1] = (sm12 + sm21) / S;\r\n    out[2] = (sm31 + sm13) / S;\r\n  } else if (sm22 > sm33) {\r\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\r\n    out[3] = (sm31 - sm13) / S;\r\n    out[0] = (sm12 + sm21) / S;\r\n    out[1] = 0.25 * S;\r\n    out[2] = (sm23 + sm32) / S;\r\n  } else {\r\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\r\n    out[3] = (sm12 - sm21) / S;\r\n    out[0] = (sm31 + sm13) / S;\r\n    out[1] = (sm23 + sm32) / S;\r\n    out[2] = 0.25 * S;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslationScale(out, q, v, s) {\r\n  // Quaternion math\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n  let sx = s[0];\r\n  let sy = s[1];\r\n  let sz = s[2];\r\n\r\n  out[0] = (1 - (yy + zz)) * sx;\r\n  out[1] = (xy + wz) * sx;\r\n  out[2] = (xz - wy) * sx;\r\n  out[3] = 0;\r\n  out[4] = (xy - wz) * sy;\r\n  out[5] = (1 - (xx + zz)) * sy;\r\n  out[6] = (yz + wx) * sy;\r\n  out[7] = 0;\r\n  out[8] = (xz + wy) * sz;\r\n  out[9] = (yz - wx) * sz;\r\n  out[10] = (1 - (xx + yy)) * sz;\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\r\n  // Quaternion math\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  let sx = s[0];\r\n  let sy = s[1];\r\n  let sz = s[2];\r\n\r\n  let ox = o[0];\r\n  let oy = o[1];\r\n  let oz = o[2];\r\n\r\n  let out0 = (1 - (yy + zz)) * sx;\r\n  let out1 = (xy + wz) * sx;\r\n  let out2 = (xz - wy) * sx;\r\n  let out4 = (xy - wz) * sy;\r\n  let out5 = (1 - (xx + zz)) * sy;\r\n  let out6 = (yz + wx) * sy;\r\n  let out8 = (xz + wy) * sz;\r\n  let out9 = (yz - wx) * sz;\r\n  let out10 = (1 - (xx + yy)) * sz;\r\n\r\n  out[0] = out0;\r\n  out[1] = out1;\r\n  out[2] = out2;\r\n  out[3] = 0;\r\n  out[4] = out4;\r\n  out[5] = out5;\r\n  out[6] = out6;\r\n  out[7] = 0;\r\n  out[8] = out8;\r\n  out[9] = out9;\r\n  out[10] = out10;\r\n  out[11] = 0;\r\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\r\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\r\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\r\nexport function fromQuat(out, q) {\r\n  let x = q[0],\r\n    y = q[1],\r\n    z = q[2],\r\n    w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let yx = y * x2;\r\n  let yy = y * y2;\r\n  let zx = z * x2;\r\n  let zy = z * y2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - yy - zz;\r\n  out[1] = yx + wz;\r\n  out[2] = zx - wy;\r\n  out[3] = 0;\r\n\r\n  out[4] = yx - wz;\r\n  out[5] = 1 - xx - zz;\r\n  out[6] = zy + wx;\r\n  out[7] = 0;\r\n\r\n  out[8] = zx + wy;\r\n  out[9] = zy - wx;\r\n  out[10] = 1 - xx - yy;\r\n  out[11] = 0;\r\n\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function frustum(out, left, right, bottom, top, near, far) {\r\n  let rl = 1 / (right - left);\r\n  let tb = 1 / (top - bottom);\r\n  let nf = 1 / (near - far);\r\n  out[0] = near * 2 * rl;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = near * 2 * tb;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = (right + left) * rl;\r\n  out[9] = (top + bottom) * tb;\r\n  out[10] = (far + near) * nf;\r\n  out[11] = -1;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = far * near * 2 * nf;\r\n  out[15] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\r\nexport function perspective(out, fovy, aspect, near, far) {\r\n  let f = 1.0 / Math.tan(fovy / 2),\r\n    nf;\r\n  out[0] = f / aspect;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = f;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[11] = -1;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[15] = 0;\r\n  if (far != null && far !== Infinity) {\r\n    nf = 1 / (near - far);\r\n    out[10] = (far + near) * nf;\r\n    out[14] = 2 * far * near * nf;\r\n  } else {\r\n    out[10] = -1;\r\n    out[14] = -2 * near;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\r\n  let upTan = Math.tan((fov.upDegrees * Math.PI) / 180.0);\r\n  let downTan = Math.tan((fov.downDegrees * Math.PI) / 180.0);\r\n  let leftTan = Math.tan((fov.leftDegrees * Math.PI) / 180.0);\r\n  let rightTan = Math.tan((fov.rightDegrees * Math.PI) / 180.0);\r\n  let xScale = 2.0 / (leftTan + rightTan);\r\n  let yScale = 2.0 / (upTan + downTan);\r\n\r\n  out[0] = xScale;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  out[3] = 0.0;\r\n  out[4] = 0.0;\r\n  out[5] = yScale;\r\n  out[6] = 0.0;\r\n  out[7] = 0.0;\r\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\r\n  out[9] = (upTan - downTan) * yScale * 0.5;\r\n  out[10] = far / (near - far);\r\n  out[11] = -1.0;\r\n  out[12] = 0.0;\r\n  out[13] = 0.0;\r\n  out[14] = (far * near) / (near - far);\r\n  out[15] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function ortho(out, left, right, bottom, top, near, far) {\r\n  let lr = 1 / (left - right);\r\n  let bt = 1 / (bottom - top);\r\n  let nf = 1 / (near - far);\r\n  out[0] = -2 * lr;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = -2 * bt;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 2 * nf;\r\n  out[11] = 0;\r\n  out[12] = (left + right) * lr;\r\n  out[13] = (top + bottom) * bt;\r\n  out[14] = (far + near) * nf;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\r\nexport function lookAt(out, eye, center, up) {\r\n  let x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\r\n  let eyex = eye[0];\r\n  let eyey = eye[1];\r\n  let eyez = eye[2];\r\n  let upx = up[0];\r\n  let upy = up[1];\r\n  let upz = up[2];\r\n  let centerx = center[0];\r\n  let centery = center[1];\r\n  let centerz = center[2];\r\n\r\n  if (\r\n    Math.abs(eyex - centerx) < glMatrix.EPSILON &&\r\n    Math.abs(eyey - centery) < glMatrix.EPSILON &&\r\n    Math.abs(eyez - centerz) < glMatrix.EPSILON\r\n  ) {\r\n    return identity(out);\r\n  }\r\n\r\n  z0 = eyex - centerx;\r\n  z1 = eyey - centery;\r\n  z2 = eyez - centerz;\r\n\r\n  len = 1 / Math.hypot(z0, z1, z2);\r\n  z0 *= len;\r\n  z1 *= len;\r\n  z2 *= len;\r\n\r\n  x0 = upy * z2 - upz * z1;\r\n  x1 = upz * z0 - upx * z2;\r\n  x2 = upx * z1 - upy * z0;\r\n  len = Math.hypot(x0, x1, x2);\r\n  if (!len) {\r\n    x0 = 0;\r\n    x1 = 0;\r\n    x2 = 0;\r\n  } else {\r\n    len = 1 / len;\r\n    x0 *= len;\r\n    x1 *= len;\r\n    x2 *= len;\r\n  }\r\n\r\n  y0 = z1 * x2 - z2 * x1;\r\n  y1 = z2 * x0 - z0 * x2;\r\n  y2 = z0 * x1 - z1 * x0;\r\n\r\n  len = Math.hypot(y0, y1, y2);\r\n  if (!len) {\r\n    y0 = 0;\r\n    y1 = 0;\r\n    y2 = 0;\r\n  } else {\r\n    len = 1 / len;\r\n    y0 *= len;\r\n    y1 *= len;\r\n    y2 *= len;\r\n  }\r\n\r\n  out[0] = x0;\r\n  out[1] = y0;\r\n  out[2] = z0;\r\n  out[3] = 0;\r\n  out[4] = x1;\r\n  out[5] = y1;\r\n  out[6] = z1;\r\n  out[7] = 0;\r\n  out[8] = x2;\r\n  out[9] = y2;\r\n  out[10] = z2;\r\n  out[11] = 0;\r\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\r\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\r\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\r\nexport function targetTo(out, eye, target, up) {\r\n  let eyex = eye[0],\r\n    eyey = eye[1],\r\n    eyez = eye[2],\r\n    upx = up[0],\r\n    upy = up[1],\r\n    upz = up[2];\r\n\r\n  let z0 = eyex - target[0],\r\n    z1 = eyey - target[1],\r\n    z2 = eyez - target[2];\r\n\r\n  let len = z0 * z0 + z1 * z1 + z2 * z2;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n    z0 *= len;\r\n    z1 *= len;\r\n    z2 *= len;\r\n  }\r\n\r\n  let x0 = upy * z2 - upz * z1,\r\n    x1 = upz * z0 - upx * z2,\r\n    x2 = upx * z1 - upy * z0;\r\n\r\n  len = x0 * x0 + x1 * x1 + x2 * x2;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n    x0 *= len;\r\n    x1 *= len;\r\n    x2 *= len;\r\n  }\r\n\r\n  out[0] = x0;\r\n  out[1] = x1;\r\n  out[2] = x2;\r\n  out[3] = 0;\r\n  out[4] = z1 * x2 - z2 * x1;\r\n  out[5] = z2 * x0 - z0 * x2;\r\n  out[6] = z0 * x1 - z1 * x0;\r\n  out[7] = 0;\r\n  out[8] = z0;\r\n  out[9] = z1;\r\n  out[10] = z2;\r\n  out[11] = 0;\r\n  out[12] = eyex;\r\n  out[13] = eyey;\r\n  out[14] = eyez;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return (\r\n    \"mat4(\" +\r\n    a[0] +\r\n    \", \" +\r\n    a[1] +\r\n    \", \" +\r\n    a[2] +\r\n    \", \" +\r\n    a[3] +\r\n    \", \" +\r\n    a[4] +\r\n    \", \" +\r\n    a[5] +\r\n    \", \" +\r\n    a[6] +\r\n    \", \" +\r\n    a[7] +\r\n    \", \" +\r\n    a[8] +\r\n    \", \" +\r\n    a[9] +\r\n    \", \" +\r\n    a[10] +\r\n    \", \" +\r\n    a[11] +\r\n    \", \" +\r\n    a[12] +\r\n    \", \" +\r\n    a[13] +\r\n    \", \" +\r\n    a[14] +\r\n    \", \" +\r\n    a[15] +\r\n    \")\"\r\n  );\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return Math.hypot(\r\n    a[0],\r\n    a[1],\r\n    a[2],\r\n    a[3],\r\n    a[4],\r\n    a[5],\r\n    a[6],\r\n    a[7],\r\n    a[8],\r\n    a[9],\r\n    a[10],\r\n    a[11],\r\n    a[12],\r\n    a[13],\r\n    a[14],\r\n    a[15]\r\n  );\r\n}\r\n\r\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  out[6] = a[6] + b[6];\r\n  out[7] = a[7] + b[7];\r\n  out[8] = a[8] + b[8];\r\n  out[9] = a[9] + b[9];\r\n  out[10] = a[10] + b[10];\r\n  out[11] = a[11] + b[11];\r\n  out[12] = a[12] + b[12];\r\n  out[13] = a[13] + b[13];\r\n  out[14] = a[14] + b[14];\r\n  out[15] = a[15] + b[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  out[4] = a[4] - b[4];\r\n  out[5] = a[5] - b[5];\r\n  out[6] = a[6] - b[6];\r\n  out[7] = a[7] - b[7];\r\n  out[8] = a[8] - b[8];\r\n  out[9] = a[9] - b[9];\r\n  out[10] = a[10] - b[10];\r\n  out[11] = a[11] - b[11];\r\n  out[12] = a[12] - b[12];\r\n  out[13] = a[13] - b[13];\r\n  out[14] = a[14] - b[14];\r\n  out[15] = a[15] - b[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  out[6] = a[6] * b;\r\n  out[7] = a[7] * b;\r\n  out[8] = a[8] * b;\r\n  out[9] = a[9] * b;\r\n  out[10] = a[10] * b;\r\n  out[11] = a[11] * b;\r\n  out[12] = a[12] * b;\r\n  out[13] = a[13] * b;\r\n  out[14] = a[14] * b;\r\n  out[15] = a[15] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  out[3] = a[3] + b[3] * scale;\r\n  out[4] = a[4] + b[4] * scale;\r\n  out[5] = a[5] + b[5] * scale;\r\n  out[6] = a[6] + b[6] * scale;\r\n  out[7] = a[7] + b[7] * scale;\r\n  out[8] = a[8] + b[8] * scale;\r\n  out[9] = a[9] + b[9] * scale;\r\n  out[10] = a[10] + b[10] * scale;\r\n  out[11] = a[11] + b[11] * scale;\r\n  out[12] = a[12] + b[12] * scale;\r\n  out[13] = a[13] + b[13] * scale;\r\n  out[14] = a[14] + b[14] * scale;\r\n  out[15] = a[15] + b[15] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return (\r\n    a[0] === b[0] &&\r\n    a[1] === b[1] &&\r\n    a[2] === b[2] &&\r\n    a[3] === b[3] &&\r\n    a[4] === b[4] &&\r\n    a[5] === b[5] &&\r\n    a[6] === b[6] &&\r\n    a[7] === b[7] &&\r\n    a[8] === b[8] &&\r\n    a[9] === b[9] &&\r\n    a[10] === b[10] &&\r\n    a[11] === b[11] &&\r\n    a[12] === b[12] &&\r\n    a[13] === b[13] &&\r\n    a[14] === b[14] &&\r\n    a[15] === b[15]\r\n  );\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3];\r\n  let a4 = a[4],\r\n    a5 = a[5],\r\n    a6 = a[6],\r\n    a7 = a[7];\r\n  let a8 = a[8],\r\n    a9 = a[9],\r\n    a10 = a[10],\r\n    a11 = a[11];\r\n  let a12 = a[12],\r\n    a13 = a[13],\r\n    a14 = a[14],\r\n    a15 = a[15];\r\n\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3];\r\n  let b4 = b[4],\r\n    b5 = b[5],\r\n    b6 = b[6],\r\n    b7 = b[7];\r\n  let b8 = b[8],\r\n    b9 = b[9],\r\n    b10 = b[10],\r\n    b11 = b[11];\r\n  let b12 = b[12],\r\n    b13 = b[13],\r\n    b14 = b[14],\r\n    b15 = b[15];\r\n\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n    Math.abs(a3 - b3) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n    Math.abs(a4 - b4) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n    Math.abs(a5 - b5) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\r\n    Math.abs(a6 - b6) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\r\n    Math.abs(a7 - b7) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\r\n    Math.abs(a8 - b8) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) &&\r\n    Math.abs(a9 - b9) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) &&\r\n    Math.abs(a10 - b10) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) &&\r\n    Math.abs(a11 - b11) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) &&\r\n    Math.abs(a12 - b12) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) &&\r\n    Math.abs(a13 - b13) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) &&\r\n    Math.abs(a14 - b14) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) &&\r\n    Math.abs(a15 - b15) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(3);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function clone(a) {\r\n  var out = new glMatrix.ARRAY_TYPE(3);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  return Math.hypot(x, y, z);\r\n}\r\n\r\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function fromValues(x, y, z) {\r\n  let out = new glMatrix.ARRAY_TYPE(3);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\r\nexport function set(out, x, y, z) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  out[2] = a[2] * b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  out[2] = a[2] / b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  out[2] = Math.ceil(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  out[2] = Math.floor(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  out[2] = Math.min(a[2], b[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  out[2] = Math.max(a[2], b[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  out[2] = Math.round(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  return Math.hypot(x, y, z);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  return x * x + y * y + z * z;\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  return x * x + y * y + z * z;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\r\nexport function normalize(out, a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let len = x * x + y * y + z * z;\r\n  if (len > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = a[0] * len;\r\n  out[1] = a[1] * len;\r\n  out[2] = a[2] * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\r\n}\r\n\r\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function cross(out, a, b) {\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2];\r\n  let bx = b[0],\r\n    by = b[1],\r\n    bz = b[2];\r\n\r\n  out[0] = ay * bz - az * by;\r\n  out[1] = az * bx - ax * bz;\r\n  out[2] = ax * by - ay * bx;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  let ax = a[0];\r\n  let ay = a[1];\r\n  let az = a[2];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  out[2] = az + t * (b[2] - az);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function hermite(out, a, b, c, d, t) {\r\n  let factorTimes2 = t * t;\r\n  let factor1 = factorTimes2 * (2 * t - 3) + 1;\r\n  let factor2 = factorTimes2 * (t - 2) + t;\r\n  let factor3 = factorTimes2 * (t - 1);\r\n  let factor4 = factorTimes2 * (3 - 2 * t);\r\n\r\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\r\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\r\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function bezier(out, a, b, c, d, t) {\r\n  let inverseFactor = 1 - t;\r\n  let inverseFactorTimesTwo = inverseFactor * inverseFactor;\r\n  let factorTimes2 = t * t;\r\n  let factor1 = inverseFactorTimesTwo * inverseFactor;\r\n  let factor2 = 3 * t * inverseFactorTimesTwo;\r\n  let factor3 = 3 * factorTimes2 * inverseFactor;\r\n  let factor4 = factorTimes2 * t;\r\n\r\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\r\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\r\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n\r\n  let r = glMatrix.RANDOM() * 2.0 * Math.PI;\r\n  let z = glMatrix.RANDOM() * 2.0 - 1.0;\r\n  let zScale = Math.sqrt(1.0 - z * z) * scale;\r\n\r\n  out[0] = Math.cos(r) * zScale;\r\n  out[1] = Math.sin(r) * zScale;\r\n  out[2] = z * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  let w = m[3] * x + m[7] * y + m[11] * z + m[15];\r\n  w = w || 1.0;\r\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\r\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\r\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformMat3(out, a, m) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  out[0] = x * m[0] + y * m[3] + z * m[6];\r\n  out[1] = x * m[1] + y * m[4] + z * m[7];\r\n  out[2] = x * m[2] + y * m[5] + z * m[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformQuat(out, a, q) {\r\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\r\n  let qx = q[0],\r\n    qy = q[1],\r\n    qz = q[2],\r\n    qw = q[3];\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  // var qvec = [qx, qy, qz];\r\n  // var uv = vec3.cross([], qvec, a);\r\n  let uvx = qy * z - qz * y,\r\n    uvy = qz * x - qx * z,\r\n    uvz = qx * y - qy * x;\r\n  // var uuv = vec3.cross([], qvec, uv);\r\n  let uuvx = qy * uvz - qz * uvy,\r\n    uuvy = qz * uvx - qx * uvz,\r\n    uuvz = qx * uvy - qy * uvx;\r\n  // vec3.scale(uv, uv, 2 * w);\r\n  let w2 = qw * 2;\r\n  uvx *= w2;\r\n  uvy *= w2;\r\n  uvz *= w2;\r\n  // vec3.scale(uuv, uuv, 2);\r\n  uuvx *= 2;\r\n  uuvy *= 2;\r\n  uuvz *= 2;\r\n  // return vec3.add(out, a, vec3.add(out, uv, uuv));\r\n  out[0] = x + uvx + uuvx;\r\n  out[1] = y + uvy + uuvy;\r\n  out[2] = z + uvz + uuvz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateX(out, a, b, rad) {\r\n  let p = [],\r\n    r = [];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[0];\r\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\r\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad);\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateY(out, a, b, rad) {\r\n  let p = [],\r\n    r = [];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\r\n  r[1] = p[1];\r\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad);\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateZ(out, a, b, rad) {\r\n  let p = [],\r\n    r = [];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\r\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\r\n  r[2] = p[2];\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\r\nexport function angle(a, b) {\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    bx = b[0],\r\n    by = b[1],\r\n    bz = b[2],\r\n    mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\r\n    mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\r\n    mag = mag1 * mag2,\r\n    cosine = mag && dot(a, b) / mag;\r\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\r\n}\r\n\r\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2];\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if (!stride) {\r\n      stride = 3;\r\n    }\r\n\r\n    if (!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if (count) {\r\n      l = Math.min(count * stride + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for (i = offset; i < l; i += stride) {\r\n      vec[0] = a[i];\r\n      vec[1] = a[i + 1];\r\n      vec[2] = a[i + 2];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0];\r\n      a[i + 1] = vec[1];\r\n      a[i + 2] = vec[2];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function fromValues(x, y, z, w) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\r\nexport function set(out, x, y, z, w) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  out[2] = a[2] * b[2];\r\n  out[3] = a[3] * b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  out[2] = a[2] / b[2];\r\n  out[3] = a[3] / b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  out[2] = Math.ceil(a[2]);\r\n  out[3] = Math.ceil(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  out[2] = Math.floor(a[2]);\r\n  out[3] = Math.floor(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  out[2] = Math.min(a[2], b[2]);\r\n  out[3] = Math.min(a[3], b[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  out[2] = Math.max(a[2], b[2]);\r\n  out[3] = Math.max(a[3], b[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  out[2] = Math.round(a[2]);\r\n  out[3] = Math.round(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  out[2] = a[2] + b[2] * scale;\r\n  out[3] = a[3] + b[3] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  let w = b[3] - a[3];\r\n  return Math.hypot(x, y, z, w);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  let w = b[3] - a[3];\r\n  return x * x + y * y + z * z + w * w;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  return Math.hypot(x, y, z, w);\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  return x * x + y * y + z * z + w * w;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] = -a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  out[3] = 1.0 / a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\r\nexport function normalize(out, a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  let len = x * x + y * y + z * z + w * w;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = x * len;\r\n  out[1] = y * len;\r\n  out[2] = z * len;\r\n  out[3] = w * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\r\n}\r\n\r\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\r\nexport function cross(out, u, v, w) {\r\n  let A = v[0] * w[1] - v[1] * w[0],\r\n    B = v[0] * w[2] - v[2] * w[0],\r\n    C = v[0] * w[3] - v[3] * w[0],\r\n    D = v[1] * w[2] - v[2] * w[1],\r\n    E = v[1] * w[3] - v[3] * w[1],\r\n    F = v[2] * w[3] - v[3] * w[2];\r\n  let G = u[0];\r\n  let H = u[1];\r\n  let I = u[2];\r\n  let J = u[3];\r\n\r\n  out[0] = H * F - I * E + J * D;\r\n  out[1] = -(G * F) + I * C - J * B;\r\n  out[2] = G * E - H * C + J * A;\r\n  out[3] = -(G * D) + H * B - I * A;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  let ax = a[0];\r\n  let ay = a[1];\r\n  let az = a[2];\r\n  let aw = a[3];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  out[2] = az + t * (b[2] - az);\r\n  out[3] = aw + t * (b[3] - aw);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n\r\n  // Marsaglia, George. Choosing a Point from the Surface of a\r\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\r\n  // http://projecteuclid.org/euclid.aoms/1177692644;\r\n  var v1, v2, v3, v4;\r\n  var s1, s2;\r\n  do {\r\n    v1 = glMatrix.RANDOM() * 2 - 1;\r\n    v2 = glMatrix.RANDOM() * 2 - 1;\r\n    s1 = v1 * v1 + v2 * v2;\r\n  } while (s1 >= 1);\r\n  do {\r\n    v3 = glMatrix.RANDOM() * 2 - 1;\r\n    v4 = glMatrix.RANDOM() * 2 - 1;\r\n    s2 = v3 * v3 + v4 * v4;\r\n  } while (s2 >= 1);\r\n\r\n  var d = Math.sqrt((1 - s1) / s2);\r\n  out[0] = scale * v1;\r\n  out[1] = scale * v2;\r\n  out[2] = scale * v3 * d;\r\n  out[3] = scale * v4 * d;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2],\r\n    w = a[3];\r\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\r\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\r\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\r\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\r\nexport function transformQuat(out, a, q) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n  let qx = q[0],\r\n    qy = q[1],\r\n    qz = q[2],\r\n    qw = q[3];\r\n\r\n  // calculate quat * vec\r\n  let ix = qw * x + qy * z - qz * y;\r\n  let iy = qw * y + qz * x - qx * z;\r\n  let iz = qw * z + qx * y - qy * x;\r\n  let iw = -qx * x - qy * y - qz * z;\r\n\r\n  // calculate result * inverse quat\r\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  out[3] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3];\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n    Math.abs(a3 - b3) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if (!stride) {\r\n      stride = 4;\r\n    }\r\n\r\n    if (!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if (count) {\r\n      l = Math.min(count * stride + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for (i = offset; i < l; i += stride) {\r\n      vec[0] = a[i];\r\n      vec[1] = a[i + 1];\r\n      vec[2] = a[i + 2];\r\n      vec[3] = a[i + 3];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0];\r\n      a[i + 1] = vec[1];\r\n      a[i + 2] = vec[2];\r\n      a[i + 3] = vec[3];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\nimport * as mat3 from \"./mat3.js\";\r\nimport * as vec3 from \"./vec3.js\";\r\nimport * as vec4 from \"./vec4.js\";\r\n\r\n/**\r\n * Quaternion\r\n * @module quat\r\n */\r\n\r\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n  }\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 0;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\r\nexport function setAxisAngle(out, axis, rad) {\r\n  rad = rad * 0.5;\r\n  let s = Math.sin(rad);\r\n  out[0] = s * axis[0];\r\n  out[1] = s * axis[1];\r\n  out[2] = s * axis[2];\r\n  out[3] = Math.cos(rad);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\r\nexport function getAxisAngle(out_axis, q) {\r\n  let rad = Math.acos(q[3]) * 2.0;\r\n  let s = Math.sin(rad / 2.0);\r\n  if (s > glMatrix.EPSILON) {\r\n    out_axis[0] = q[0] / s;\r\n    out_axis[1] = q[1] / s;\r\n    out_axis[2] = q[2] / s;\r\n  } else {\r\n    // If s is zero, return any axis (no rotation - axis does not matter)\r\n    out_axis[0] = 1;\r\n    out_axis[1] = 0;\r\n    out_axis[2] = 0;\r\n  }\r\n  return rad;\r\n}\r\n\r\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\r\nexport function getAngle(a, b) {\r\n  let dotproduct = dot(a, b);\r\n\r\n  return Math.acos(2 * dotproduct * dotproduct - 1);\r\n}\r\n\r\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bx = b[0],\r\n    by = b[1],\r\n    bz = b[2],\r\n    bw = b[3];\r\n\r\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\r\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\r\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\r\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateX(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bx = Math.sin(rad),\r\n    bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw + aw * bx;\r\n  out[1] = ay * bw + az * bx;\r\n  out[2] = az * bw - ay * bx;\r\n  out[3] = aw * bw - ax * bx;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateY(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let by = Math.sin(rad),\r\n    bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw - az * by;\r\n  out[1] = ay * bw + aw * by;\r\n  out[2] = az * bw + ax * by;\r\n  out[3] = aw * bw - ay * by;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateZ(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bz = Math.sin(rad),\r\n    bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw + ay * bz;\r\n  out[1] = ay * bw - ax * bz;\r\n  out[2] = az * bw + aw * bz;\r\n  out[3] = aw * bw - az * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\r\nexport function calculateW(out, a) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2];\r\n\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\r\nexport function exp(out, a) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2],\r\n    w = a[3];\r\n\r\n  let r = Math.sqrt(x * x + y * y + z * z);\r\n  let et = Math.exp(w);\r\n  let s = r > 0 ? (et * Math.sin(r)) / r : 0;\r\n\r\n  out[0] = x * s;\r\n  out[1] = y * s;\r\n  out[2] = z * s;\r\n  out[3] = et * Math.cos(r);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\r\nexport function ln(out, a) {\r\n  let x = a[0],\r\n    y = a[1],\r\n    z = a[2],\r\n    w = a[3];\r\n\r\n  let r = Math.sqrt(x * x + y * y + z * z);\r\n  let t = r > 0 ? Math.atan2(r, w) / r : 0;\r\n\r\n  out[0] = x * t;\r\n  out[1] = y * t;\r\n  out[2] = z * t;\r\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\r\nexport function pow(out, a, b) {\r\n  ln(out, a);\r\n  scale(out, out, b);\r\n  exp(out, out);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\r\nexport function slerp(out, a, b, t) {\r\n  // benchmarks:\r\n  //    http://jsperf.com/quaternion-slerp-implementations\r\n  let ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n  let bx = b[0],\r\n    by = b[1],\r\n    bz = b[2],\r\n    bw = b[3];\r\n\r\n  let omega, cosom, sinom, scale0, scale1;\r\n\r\n  // calc cosine\r\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\r\n  // adjust signs (if necessary)\r\n  if (cosom < 0.0) {\r\n    cosom = -cosom;\r\n    bx = -bx;\r\n    by = -by;\r\n    bz = -bz;\r\n    bw = -bw;\r\n  }\r\n  // calculate coefficients\r\n  if (1.0 - cosom > glMatrix.EPSILON) {\r\n    // standard case (slerp)\r\n    omega = Math.acos(cosom);\r\n    sinom = Math.sin(omega);\r\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\r\n    scale1 = Math.sin(t * omega) / sinom;\r\n  } else {\r\n    // \"from\" and \"to\" quaternions are very close\r\n    //  ... so we can do a linear interpolation\r\n    scale0 = 1.0 - t;\r\n    scale1 = t;\r\n  }\r\n  // calculate final values\r\n  out[0] = scale0 * ax + scale1 * bx;\r\n  out[1] = scale0 * ay + scale1 * by;\r\n  out[2] = scale0 * az + scale1 * bz;\r\n  out[3] = scale0 * aw + scale1 * bw;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\r\nexport function random(out) {\r\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\r\n  // TODO: Calling random 3 times is probably not the fastest solution\r\n  let u1 = glMatrix.RANDOM();\r\n  let u2 = glMatrix.RANDOM();\r\n  let u3 = glMatrix.RANDOM();\r\n\r\n  let sqrt1MinusU1 = Math.sqrt(1 - u1);\r\n  let sqrtU1 = Math.sqrt(u1);\r\n\r\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\r\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\r\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\r\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\r\nexport function invert(out, a) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3];\r\n  let dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\r\n  let invDot = dot ? 1.0 / dot : 0;\r\n\r\n  // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\r\n\r\n  out[0] = -a0 * invDot;\r\n  out[1] = -a1 * invDot;\r\n  out[2] = -a2 * invDot;\r\n  out[3] = a3 * invDot;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\r\nexport function conjugate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport function fromMat3(out, m) {\r\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\r\n  // article \"Quaternion Calculus and Fast Animation\".\r\n  let fTrace = m[0] + m[4] + m[8];\r\n  let fRoot;\r\n\r\n  if (fTrace > 0.0) {\r\n    // |w| > 1/2, may as well choose w > 1/2\r\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\r\n    out[3] = 0.5 * fRoot;\r\n    fRoot = 0.5 / fRoot; // 1/(4w)\r\n    out[0] = (m[5] - m[7]) * fRoot;\r\n    out[1] = (m[6] - m[2]) * fRoot;\r\n    out[2] = (m[1] - m[3]) * fRoot;\r\n  } else {\r\n    // |w| <= 1/2\r\n    let i = 0;\r\n    if (m[4] > m[0]) i = 1;\r\n    if (m[8] > m[i * 3 + i]) i = 2;\r\n    let j = (i + 1) % 3;\r\n    let k = (i + 2) % 3;\r\n\r\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\r\n    out[i] = 0.5 * fRoot;\r\n    fRoot = 0.5 / fRoot;\r\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\r\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\r\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport function fromEuler(out, x, y, z) {\r\n  let halfToRad = (0.5 * Math.PI) / 180.0;\r\n  x *= halfToRad;\r\n  y *= halfToRad;\r\n  z *= halfToRad;\r\n\r\n  let sx = Math.sin(x);\r\n  let cx = Math.cos(x);\r\n  let sy = Math.sin(y);\r\n  let cy = Math.cos(y);\r\n  let sz = Math.sin(z);\r\n  let cz = Math.cos(z);\r\n\r\n  out[0] = sx * cy * cz - cx * sy * sz;\r\n  out[1] = cx * sy * cz + sx * cy * sz;\r\n  out[2] = cx * cy * sz - sx * sy * cz;\r\n  out[3] = cx * cy * cz + sx * sy * sz;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\r\n}\r\n\r\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nexport const clone = vec4.clone;\r\n\r\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nexport const fromValues = vec4.fromValues;\r\n\r\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const copy = vec4.copy;\r\n\r\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const set = vec4.set;\r\n\r\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const add = vec4.add;\r\n\r\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const scale = vec4.scale;\r\n\r\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\r\nexport const dot = vec4.dot;\r\n\r\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const lerp = vec4.lerp;\r\n\r\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport const length = vec4.length;\r\n\r\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\r\nexport const squaredLength = vec4.squaredLength;\r\n\r\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const normalize = vec4.normalize;\r\n\r\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport const exactEquals = vec4.exactEquals;\r\n\r\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport const equals = vec4.equals;\r\n\r\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\r\nexport const rotationTo = (function() {\r\n  let tmpvec3 = vec3.create();\r\n  let xUnitVec3 = vec3.fromValues(1, 0, 0);\r\n  let yUnitVec3 = vec3.fromValues(0, 1, 0);\r\n\r\n  return function(out, a, b) {\r\n    let dot = vec3.dot(a, b);\r\n    if (dot < -0.999999) {\r\n      vec3.cross(tmpvec3, xUnitVec3, a);\r\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\r\n      vec3.normalize(tmpvec3, tmpvec3);\r\n      setAxisAngle(out, tmpvec3, Math.PI);\r\n      return out;\r\n    } else if (dot > 0.999999) {\r\n      out[0] = 0;\r\n      out[1] = 0;\r\n      out[2] = 0;\r\n      out[3] = 1;\r\n      return out;\r\n    } else {\r\n      vec3.cross(tmpvec3, a, b);\r\n      out[0] = tmpvec3[0];\r\n      out[1] = tmpvec3[1];\r\n      out[2] = tmpvec3[2];\r\n      out[3] = 1 + dot;\r\n      return normalize(out, out);\r\n    }\r\n  };\r\n})();\r\n\r\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\r\nexport const sqlerp = (function() {\r\n  let temp1 = create();\r\n  let temp2 = create();\r\n\r\n  return function(out, a, b, c, d, t) {\r\n    slerp(temp1, a, d, t);\r\n    slerp(temp2, b, c, t);\r\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\r\n\r\n    return out;\r\n  };\r\n})();\r\n\r\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\r\nexport const setAxes = (function() {\r\n  let matr = mat3.create();\r\n\r\n  return function(out, view, right, up) {\r\n    matr[0] = right[0];\r\n    matr[3] = right[1];\r\n    matr[6] = right[2];\r\n\r\n    matr[1] = up[0];\r\n    matr[4] = up[1];\r\n    matr[7] = up[2];\r\n\r\n    matr[2] = -view[0];\r\n    matr[5] = -view[1];\r\n    matr[8] = -view[2];\r\n\r\n    return normalize(out, fromMat3(out, matr));\r\n  };\r\n})();\r\n","/* eslint-disable */\r\nimport * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function fromValues(x, y) {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\r\nexport function set(out, x, y) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + b[0] * scale;\r\n  out[1] = a[1] + b[1] * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  var x = b[0] - a[0],\r\n    y = b[1] - a[1];\r\n  return Math.hypot(x, y);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  var x = b[0] - a[0],\r\n    y = b[1] - a[1];\r\n  return x * x + y * y;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  return Math.hypot(x, y);\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  return x * x + y * y;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\r\nexport function normalize(out, a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  var len = x * x + y * y;\r\n  if (len > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = a[0] * len;\r\n  out[1] = a[1] * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1];\r\n}\r\n\r\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function cross(out, a, b) {\r\n  var z = a[0] * b[1] - a[1] * b[0];\r\n  out[0] = out[1] = 0;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  var ax = a[0],\r\n    ay = a[1];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\r\n  out[0] = Math.cos(r) * scale;\r\n  out[1] = Math.sin(r) * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat2(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[2] * y;\r\n  out[1] = m[1] * x + m[3] * y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat2d(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[2] * y + m[4];\r\n  out[1] = m[1] * x + m[3] * y + m[5];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat3(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[3] * y + m[6];\r\n  out[1] = m[1] * x + m[4] * y + m[7];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  out[0] = m[0] * x + m[4] * y + m[12];\r\n  out[1] = m[1] * x + m[5] * y + m[13];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\r\nexport function rotate(out, a, b, rad) {\r\n  //Translate point to the origin\r\n  let p0 = a[0] - b[0],\r\n    p1 = a[1] - b[1],\r\n    sinC = Math.sin(rad),\r\n    cosC = Math.cos(rad);\r\n\r\n  //perform rotation and translate to correct position\r\n  out[0] = p0 * cosC - p1 * sinC + b[0];\r\n  out[1] = p0 * sinC + p1 * cosC + b[1];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\r\nexport function angle(a, b) {\r\n  let x1 = a[0],\r\n    y1 = a[1],\r\n    x2 = b[0],\r\n    y2 = b[1],\r\n    // mag is the product of the magnitudes of a and b\r\n    mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\r\n    // mag &&.. short circuits if mag == 0\r\n    cosine = mag && (x1 * x2 + y1 * y2) / mag;\r\n  // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\r\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\r\n}\r\n\r\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1];\r\n  let b0 = b[0],\r\n    b1 = b[1];\r\n  return (\r\n    Math.abs(a0 - b0) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <=\r\n      glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1))\r\n  );\r\n}\r\n\r\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if (!stride) {\r\n      stride = 2;\r\n    }\r\n\r\n    if (!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if (count) {\r\n      l = Math.min(count * stride + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for (i = offset; i < l; i += stride) {\r\n      vec[0] = a[i];\r\n      vec[1] = a[i + 1];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0];\r\n      a[i + 1] = vec[1];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\n// Code from https://github.com/Twinklebear/webgl-volume-raycaster\r\n\r\nimport {\r\n    vec2, vec3, vec4, mat3, mat4, quat\r\n} from './gl-matrix'\r\n\r\n// Compute the view frustum in world space from the provided\r\n// column major projection * view matrix\r\nvar Frustum = function(projView) {\r\n    var rows = [vec4.create(), vec4.create(), vec4.create(), vec4.create()];\r\n    for (var i = 0; i < rows.length; ++i) {\r\n        rows[i] = vec4.set(rows[i], projView[i], projView[4 + i],\r\n            projView[8 + i], projView[12 + i]);\r\n    }\r\n\r\n    this.planes = [\r\n        // -x plane\r\n        vec4.add(vec4.create(), rows[3], rows[0]),\r\n        // +x plane\r\n        vec4.sub(vec4.create(), rows[3], rows[0]),\r\n        // -y plane\r\n        vec4.add(vec4.create(), rows[3], rows[1]),\r\n        // +y plane\r\n        vec4.sub(vec4.create(), rows[3], rows[1]),\r\n        // -z plane\r\n        vec4.add(vec4.create(), rows[3], rows[2]),\r\n        // +z plane\r\n        vec4.sub(vec4.create(), rows[3], rows[2])\r\n    ];\r\n\r\n    // Normalize the planes\r\n    for (var i = 0; i < this.planes.length; ++i) {\r\n        var s = 1.0 / Math.sqrt(this.planes[i][0] * this.planes[i][0] +\r\n            this.planes[i][1] * this.planes[i][1] + this.planes[i][2] * this.planes[i][2]);\r\n        this.planes[i][0] *= s;\r\n        this.planes[i][1] *= s;\r\n        this.planes[i][2] *= s;\r\n        this.planes[i][3] *= s;\r\n    }\r\n\r\n    // Compute the frustum points as well\r\n    var invProjView = mat4.invert(mat4.create(), projView);\r\n    this.points = [\r\n        // x_l, y_l, z_l\r\n        vec4.set(vec4.create(), -1, -1, -1, 1),\r\n        // x_h, y_l, z_l\r\n        vec4.set(vec4.create(), 1, -1, -1, 1),\r\n        // x_l, y_h, z_l\r\n        vec4.set(vec4.create(), -1, 1, -1, 1),\r\n        // x_h, y_h, z_l\r\n        vec4.set(vec4.create(), 1, 1, -1, 1),\r\n        // x_l, y_l, z_h\r\n        vec4.set(vec4.create(), -1, -1, 1, 1),\r\n        // x_h, y_l, z_h\r\n        vec4.set(vec4.create(), 1, -1, 1, 1),\r\n        // x_l, y_h, z_h\r\n        vec4.set(vec4.create(), -1, 1, 1, 1),\r\n        // x_h, y_h, z_h\r\n        vec4.set(vec4.create(), 1, 1, 1, 1)\r\n    ];\r\n    for (var i = 0; i < 8; ++i) {\r\n        this.points[i] = vec4.transformMat4(this.points[i], this.points[i], invProjView);\r\n        this.points[i][0] /= this.points[i][3];\r\n        this.points[i][1] /= this.points[i][3];\r\n        this.points[i][2] /= this.points[i][3];\r\n        this.points[i][3] = 1.0;\r\n    }\r\n}\r\n\r\n// Check if the box is contained in the Frustum\r\n// The box should be [x_lower, y_lower, z_lower, x_upper, y_upper, z_upper]\r\n// This is done using Inigo Quilez's approach to help with large\r\n// bounds: https://www.iquilezles.org/www/articles/frustumcorrect/frustumcorrect.htm\r\nFrustum.prototype.containsBox = function(box) {\r\n    // Test the box against each plane\r\n    var vec = vec4.create();\r\n    var out = 0;\r\n    for (var i = 0; i < this.planes.length; ++i) {\r\n        out = 0;\r\n        // x_l, y_l, z_l\r\n        vec4.set(vec, box[0], box[1], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_l, z_l\r\n        vec4.set(vec, box[3], box[1], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_l, y_h, z_l\r\n        vec4.set(vec, box[0], box[4], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_h, z_l\r\n        vec4.set(vec, box[3], box[4], box[2], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_l, y_l, z_h\r\n        vec4.set(vec, box[0], box[1], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_l, z_h\r\n        vec4.set(vec, box[3], box[1], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_l, y_h, z_h\r\n        vec4.set(vec, box[0], box[4], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n        // x_h, y_h, z_h\r\n        vec4.set(vec, box[3], box[4], box[5], 1.0);\r\n        out += vec4.dot(this.planes[i], vec) < 0.0 ? 1 : 0;\r\n\r\n        if (out == 8) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Test the frustum against the box\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][0] > box[3] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][0] < box[0] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][1] > box[4] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][1] < box[1] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][2] > box[5] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n\r\n    out = 0;\r\n    for (var i = 0; i < 8; ++i) {\r\n        out += this.points[i][2] < box[2] ? 1 : 0;\r\n    }\r\n    if (out == 8) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\nvar Shader = function(gl, vertexSrc, fragmentSrc) {\r\n    var self = this;\r\n    this.program = compileShader(gl, vertexSrc, fragmentSrc);\r\n\r\n    var regexUniform = /uniform[^;]+[ ](\\w+);/g\r\n    var matchUniformName = /uniform[^;]+[ ](\\w+);/\r\n\r\n    this.uniforms = {};\r\n\r\n    var vertexUnifs = vertexSrc.match(regexUniform);\r\n    var fragUnifs = fragmentSrc.match(regexUniform);\r\n\r\n    if (vertexUnifs) {\r\n        vertexUnifs.forEach(function(unif) {\r\n            var m = unif.match(matchUniformName);\r\n            self.uniforms[m[1]] = -1;\r\n        });\r\n    }\r\n    if (fragUnifs) {\r\n        fragUnifs.forEach(function(unif) {\r\n            var m = unif.match(matchUniformName);\r\n            self.uniforms[m[1]] = -1;\r\n        });\r\n    }\r\n\r\n    for (var unif in this.uniforms) {\r\n        this.uniforms[unif] = gl.getUniformLocation(this.program, unif);\r\n    }\r\n}\r\n\r\nShader.prototype.use = function(gl) {\r\n    gl.useProgram(this.program);\r\n}\r\n\r\n// Compile and link the shaders vert and frag. vert and frag should contain\r\n// the shader source code for the vertex and fragment shaders respectively\r\n// Returns the compiled and linked program, or null if compilation or linking failed\r\nvar compileShader = function(gl, vert, frag){\r\n    var vs = gl.createShader(gl.VERTEX_SHADER);\r\n    gl.shaderSource(vs, vert);\r\n    gl.compileShader(vs);\r\n    if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS)){\r\n        alert(\"Vertex shader failed to compile, see console for log\");\r\n        console.log(gl.getShaderInfoLog(vs));\r\n        return null;\r\n    }\r\n\r\n    var fs = gl.createShader(gl.FRAGMENT_SHADER);\r\n    gl.shaderSource(fs, frag);\r\n    gl.compileShader(fs);\r\n    if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)){\r\n        alert(\"Fragment shader failed to compile, see console for log\");\r\n        console.log(gl.getShaderInfoLog(fs));\r\n        return null;\r\n    }\r\n\r\n    var program = gl.createProgram();\r\n    gl.attachShader(program, vs);\r\n    gl.attachShader(program, fs);\r\n    gl.linkProgram(program);\r\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)){\r\n        alert(\"Shader failed to link, see console for log\");\r\n        console.log(gl.getProgramInfoLog(program));\r\n        return null;\r\n    }\r\n    return program;\r\n}\r\n\r\n// var getGLExtension = function(ext) {\r\n//     if (!gl.getExtension(ext)) {\r\n//         alert(\"Missing \" + ext + \" WebGL extension\");\r\n//         return false;\r\n//     }\r\n//     return true;\r\n// }\r\n\r\n/* The arcball camera will be placed at the position 'eye', rotating\r\n * around the point 'center', with the up vector 'up'. 'screenDims'\r\n * should be the dimensions of the canvas or region taking mouse input\r\n * so the mouse positions can be normalized into [-1, 1] from the pixel\r\n * coordinates.\r\n */\r\nvar ArcballCamera = function(eye, center, up, zoomSpeed, screenDims) {\r\n\r\n    var veye = vec3.set(vec3.create(), eye[0], eye[1], eye[2]);\r\n    var vcenter = vec3.set(vec3.create(), center[0], center[1], center[2]);\r\n    var vup = vec3.set(vec3.create(), up[0], up[1], up[2]);\r\n    vec3.normalize(vup, vup);\r\n\r\n    var zAxis = vec3.sub(vec3.create(), vcenter, veye);\r\n    var viewDist = vec3.len(zAxis);\r\n    vec3.normalize(zAxis, zAxis);\r\n\r\n    var xAxis = vec3.cross(vec3.create(), zAxis, vup);\r\n    vec3.normalize(xAxis, xAxis);\r\n\r\n    var yAxis = vec3.cross(vec3.create(), xAxis, zAxis);\r\n    vec3.normalize(yAxis, yAxis);\r\n\r\n    vec3.cross(xAxis, zAxis, yAxis);\r\n    vec3.normalize(xAxis, xAxis);\r\n\r\n    this.zoomSpeed = zoomSpeed;\r\n    this.invScreen = [1.0 / screenDims[0], 1.0 / screenDims[1]];\r\n\r\n    this.centerTranslation = mat4.fromTranslation(mat4.create(), center);\r\n    mat4.invert(this.centerTranslation, this.centerTranslation);\r\n\r\n    var vt = vec3.set(vec3.create(), 0, 0, -1.0 * viewDist);\r\n    this.translation = mat4.fromTranslation(mat4.create(), vt);\r\n\r\n    var rotMat = mat3.fromValues(xAxis[0], xAxis[1], xAxis[2],\r\n        yAxis[0], yAxis[1], yAxis[2],\r\n        -zAxis[0], -zAxis[1], -zAxis[2]);\r\n    mat3.transpose(rotMat, rotMat);\r\n    this.rotation = quat.fromMat3(quat.create(), rotMat);\r\n    quat.normalize(this.rotation, this.rotation);\r\n\r\n    this.camera = mat4.create();\r\n    this.invCamera = mat4.create();\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.rotate = function(prevMouse, curMouse) {\r\n    var mPrev = vec2.set(vec2.create(),\r\n        clamp(prevMouse[0] * 2.0 * this.invScreen[0] - 1.0, -1.0, 1.0),\r\n        clamp(1.0 - prevMouse[1] * 2.0 * this.invScreen[1], -1.0, 1.0));\r\n\r\n    var mCur = vec2.set(vec2.create(),\r\n        clamp(curMouse[0] * 2.0 * this.invScreen[0] - 1.0, -1.0, 1.0),\r\n        clamp(1.0 - curMouse[1] * 2.0 * this.invScreen[1], -1.0, 1.0));\r\n\r\n    var mPrevBall = screenToArcball(mPrev);\r\n    var mCurBall = screenToArcball(mCur);\r\n    // rotation = curBall * prevBall * rotation\r\n    this.rotation = quat.mul(this.rotation, mPrevBall, this.rotation);\r\n    this.rotation = quat.mul(this.rotation, mCurBall, this.rotation);\r\n\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.zoom = function(amount) {\r\n    var vt = vec3.set(vec3.create(), 0.0, 0.0, amount * this.invScreen[1] * this.zoomSpeed);\r\n    var t = mat4.fromTranslation(mat4.create(), vt);\r\n    this.translation = mat4.mul(this.translation, t, this.translation);\r\n    if (this.translation[14] >= -0.2) {\r\n        this.translation[14] = -0.2;\r\n    }\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.pan = function(mouseDelta) {\r\n    var delta = vec4.set(vec4.create(), mouseDelta[0] * this.invScreen[0] * Math.abs(this.translation[14]),\r\n        mouseDelta[1] * this.invScreen[1] * Math.abs(this.translation[14]), 0, 0);\r\n    var worldDelta = vec4.transformMat4(vec4.create(), delta, this.invCamera);\r\n    var translation = mat4.fromTranslation(mat4.create(), worldDelta);\r\n    this.centerTranslation = mat4.mul(this.centerTranslation, translation, this.centerTranslation);\r\n    this.updateCameraMatrix();\r\n}\r\n\r\nArcballCamera.prototype.updateCameraMatrix = function() {\r\n    // camera = translation * rotation * centerTranslation\r\n    var rotMat = mat4.fromQuat(mat4.create(), this.rotation);\r\n    this.camera = mat4.mul(this.camera, rotMat, this.centerTranslation);\r\n    this.camera = mat4.mul(this.camera, this.translation, this.camera);\r\n    this.invCamera = mat4.invert(this.invCamera, this.camera);\r\n}\r\n\r\nArcballCamera.prototype.eyePos = function() {\r\n    return [this.invCamera[12], this.invCamera[13], this.invCamera[14]];\r\n}\r\n\r\nArcballCamera.prototype.eyeDir = function() {\r\n    var dir = vec4.set(vec4.create(), 0.0, 0.0, -1.0, 0.0);\r\n    dir = vec4.transformMat4(dir, dir, this.invCamera);\r\n    dir = vec4.normalize(dir, dir);\r\n    return [dir[0], dir[1], dir[2]];\r\n}\r\n\r\nArcballCamera.prototype.upDir = function() {\r\n    var dir = vec4.set(vec4.create(), 0.0, 1.0, 0.0, 0.0);\r\n    dir = vec4.transformMat4(dir, dir, this.invCamera);\r\n    dir = vec4.normalize(dir, dir);\r\n    return [dir[0], dir[1], dir[2]];\r\n}\r\n\r\nvar screenToArcball = function(p) {\r\n    var dist = vec2.dot(p, p);\r\n    if (dist <= 1.0) {\r\n        return quat.set(quat.create(), p[0], p[1], Math.sqrt(1.0 - dist), 0);\r\n    } else {\r\n        var unitP = vec2.normalize(vec2.create(), p);\r\n        // cgmath is w, x, y, z\r\n        // glmatrix is x, y, z, w\r\n        return quat.set(quat.create(), unitP[0], unitP[1], 0, 0);\r\n    }\r\n}\r\nvar clamp = function(a, min, max) {\r\n    return a < min ? min : a > max ? max : a;\r\n}\r\n\r\nvar pointDist = function(a, b) {\r\n    var v = [b[0] - a[0], b[1] - a[1]];\r\n    return Math.sqrt(Math.pow(v[0], 2.0) + Math.pow(v[1], 2.0));\r\n}\r\n\r\nvar Buffer = function(capacity, dtype) {\r\n    this.len = 0;\r\n    this.capacity = capacity;\r\n    if (dtype == \"uint8\") {\r\n        this.buffer = new Uint8Array(capacity);\r\n    } else if (dtype == \"int8\") {\r\n        this.buffer = new Int8Array(capacity);\r\n    } else if (dtype == \"uint16\") {\r\n        this.buffer = new Uint16Array(capacity);\r\n    } else if (dtype == \"int16\") {\r\n        this.buffer = new Int16Array(capacity);\r\n    } else if (dtype == \"uint32\") {\r\n        this.buffer = new Uint32Array(capacity);\r\n    } else if (dtype == \"int32\") {\r\n        this.buffer = new Int32Array(capacity);\r\n    } else if (dtype == \"float32\") {\r\n        this.buffer = new Float32Array(capacity);\r\n    } else if (dtype == \"float64\") {\r\n        this.buffer = new Float64Array(capacity);\r\n    } else {\r\n        console.log(\"ERROR: unsupported type \" + dtype);\r\n    }\r\n}\r\n\r\nBuffer.prototype.append = function(buf) {\r\n    if (this.len + buf.length >= this.capacity) {\r\n        var newCap = Math.floor(this.capacity * 1.5);\r\n        var tmp = new (this.buffer.constructor)(newCap);\r\n        tmp.set(this.buffer);\r\n\r\n        this.capacity = newCap;\r\n        this.buffer = tmp;\r\n    }\r\n    this.buffer.set(buf, this.len);\r\n    this.len += buf.length;\r\n}\r\n\r\nBuffer.prototype.clear = function() {\r\n    this.len = 0;\r\n}\r\n\r\nBuffer.prototype.stride = function() {\r\n    return this.buffer.BYTES_PER_ELEMENT;\r\n}\r\n\r\nBuffer.prototype.view = function(offset, length) {\r\n    return new (this.buffer.constructor)(this.buffer.buffer, offset, length);\r\n}\r\n\r\n// Various utilities that don't really fit anywhere else\r\n\r\n// Parse the hex string to RGB values in [0, 255]\r\nvar hexToRGB = function(hex) {\r\n    var val = parseInt(hex.substr(1), 16);\r\n    var r = (val >> 16) & 255;\r\n    var g = (val >> 8) & 255;\r\n    var b = val & 255;\r\n    return [r, g, b];\r\n}\r\n\r\n// Parse the hex string to RGB values in [0, 1]\r\nvar hexToRGBf = function(hex) {\r\n    var c = hexToRGB(hex);\r\n    return [c[0] / 255.0, c[1] / 255.0, c[2] / 255.0];\r\n}\r\n\r\n/* The controller can register callbacks for various events on a canvas:\r\n *\r\n * mousemove: function(prevMouse, curMouse, evt)\r\n *     receives both regular mouse events, and single-finger drags (sent as a left-click),\r\n *\r\n * press: function(curMouse, evt)\r\n *     receives mouse click and touch start events\r\n *\r\n * wheel: function(amount)\r\n *     mouse wheel scrolling\r\n *\r\n * pinch: function(amount)\r\n *     two finger pinch, receives the distance change between the fingers\r\n *\r\n * twoFingerDrag: function(dragVector)\r\n *     two finger drag, receives the drag movement amount\r\n */\r\nvar Controller = function(camera) {\r\n    this.camera = camera;\r\n    this.mousemove = null;\r\n    this.press = null;\r\n    this.wheel = null;\r\n    this.twoFingerDrag = null;\r\n    this.pinch = null;\r\n}\r\n\r\nController.prototype.registerForCanvas = function(canvas) {\r\n    var prevMouse = null;\r\n    var mouseState = [false, false];\r\n    var self = this;\r\n    canvas.addEventListener(\"mousemove\", function(evt) {\r\n        evt.preventDefault();\r\n        var rect = canvas.getBoundingClientRect();\r\n        var curMouse = [evt.clientX - rect.left, evt.clientY - rect.top];\r\n        if (!prevMouse) {\r\n            prevMouse = [evt.clientX - rect.left, evt.clientY - rect.top];\r\n        } else if (self.mousemove) {\r\n            self.mousemove(prevMouse, curMouse, evt);\r\n        }\r\n        prevMouse = curMouse;\r\n    });\r\n\r\n    canvas.addEventListener(\"mousedown\", function(evt) {\r\n        evt.preventDefault();\r\n        var rect = canvas.getBoundingClientRect();\r\n        var curMouse = [evt.clientX - rect.left, evt.clientY - rect.top];\r\n        if (self.press) {\r\n            self.press(curMouse, evt);\r\n        }\r\n    });\r\n\r\n    canvas.addEventListener(\"wheel\", function(evt) {\r\n        evt.preventDefault();\r\n        if (self.wheel) {\r\n            self.wheel(-evt.deltaY);\r\n        }\r\n    });\r\n\r\n    canvas.oncontextmenu = function (evt) {\r\n        evt.preventDefault();\r\n    };\r\n\r\n    var touches = {};\r\n    canvas.addEventListener(\"touchstart\", function(evt) {\r\n        var rect = canvas.getBoundingClientRect();\r\n        evt.preventDefault();\r\n        for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n            var t = evt.changedTouches[i];\r\n            touches[t.identifier] = [t.clientX - rect.left, t.clientY - rect.top];\r\n            if (evt.changedTouches.length == 1 && self.press) {\r\n                self.press(touches[t.identifier], evt);\r\n            }\r\n        }\r\n    });\r\n\r\n    canvas.addEventListener(\"touchmove\", function(evt) {\r\n        evt.preventDefault();\r\n        var rect = canvas.getBoundingClientRect();\r\n        var numTouches = Object.keys(touches).length;\r\n        // Single finger to rotate the camera\r\n        if (numTouches == 1) {\r\n            if (self.mousemove) {\r\n                var t = evt.changedTouches[0];\r\n                var prevTouch = touches[t.identifier];\r\n                var curTouch = [t.clientX - rect.left, t.clientY - rect.top];\r\n                evt.buttons = 1;\r\n                self.mousemove(prevTouch, curTouch, evt);\r\n            }\r\n        } else {\r\n            var curTouches = {};\r\n            for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n                var t = evt.changedTouches[i];\r\n                curTouches[t.identifier] = [t.clientX - rect.left, t.clientY - rect.top];\r\n            }\r\n\r\n            // If some touches didn't change make sure we have them in\r\n            // our curTouches list to compute the pinch distance\r\n            // Also get the old touch points to compute the distance here\r\n            var oldTouches = [];\r\n            for (t in touches) {\r\n                if (!(t in curTouches)) {\r\n                    curTouches[t] = touches[t];\r\n                }\r\n                oldTouches.push(touches[t]);\r\n            }\r\n\r\n            var newTouches = [];\r\n            for (t in curTouches) {\r\n                newTouches.push(curTouches[t]);\r\n            }\r\n\r\n            // Determine if the user is pinching or panning\r\n            var motionVectors = [\r\n                vec2.set(vec2.create(), newTouches[0][0] - oldTouches[0][0],\r\n                    newTouches[0][1] - oldTouches[0][1]),\r\n                vec2.set(vec2.create(), newTouches[1][0] - oldTouches[1][0],\r\n                    newTouches[1][1] - oldTouches[1][1])\r\n            ];\r\n            var motionDirs = [vec2.create(), vec2.create()];\r\n            vec2.normalize(motionDirs[0], motionVectors[0]);\r\n            vec2.normalize(motionDirs[1], motionVectors[1]);\r\n\r\n            var pinchAxis = vec2.set(vec2.create(), oldTouches[1][0] - oldTouches[0][0],\r\n                oldTouches[1][1] - oldTouches[0][1]);\r\n            vec2.normalize(pinchAxis, pinchAxis);\r\n\r\n            var panAxis = vec2.lerp(vec2.create(), motionVectors[0], motionVectors[1], 0.5);\r\n            vec2.normalize(panAxis, panAxis);\r\n\r\n            var pinchMotion = [\r\n                vec2.dot(pinchAxis, motionDirs[0]),\r\n                vec2.dot(pinchAxis, motionDirs[1])\r\n            ];\r\n            var panMotion = [\r\n                vec2.dot(panAxis, motionDirs[0]),\r\n                vec2.dot(panAxis, motionDirs[1])\r\n            ];\r\n\r\n            // If we're primarily moving along the pinching axis and in the opposite direction with\r\n            // the fingers, then the user is zooming.\r\n            // Otherwise, if the fingers are moving along the same direction they're panning\r\n            if (self.pinch && Math.abs(pinchMotion[0]) > 0.5 && Math.abs(pinchMotion[1]) > 0.5\r\n                && Math.sign(pinchMotion[0]) != Math.sign(pinchMotion[1]))\r\n            {\r\n                // Pinch distance change for zooming\r\n                var oldDist = pointDist(oldTouches[0], oldTouches[1]);\r\n                var newDist = pointDist(newTouches[0], newTouches[1]);\r\n                self.pinch(newDist - oldDist);\r\n            } else if (self.twoFingerDrag && Math.abs(panMotion[0]) > 0.5 && Math.abs(panMotion[1]) > 0.5\r\n                && Math.sign(panMotion[0]) == Math.sign(panMotion[1]))\r\n            {\r\n                // Pan by the average motion of the two fingers\r\n                var panAmount = vec2.lerp(vec2.create(), motionVectors[0], motionVectors[1], 0.5);\r\n                panAmount[1] = -panAmount[1];\r\n                self.twoFingerDrag(panAmount);\r\n            }\r\n        }\r\n\r\n        // Update the existing list of touches with the current positions\r\n        for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n            var t = evt.changedTouches[i];\r\n            touches[t.identifier] = [t.clientX - rect.left, t.clientY - rect.top];\r\n        }\r\n    });\r\n\r\n    var touchEnd = function(evt) {\r\n        evt.preventDefault();\r\n        for (var i = 0; i < evt.changedTouches.length; ++i) {\r\n            var t = evt.changedTouches[i];\r\n            delete touches[t.identifier];\r\n        }\r\n    }\r\n    canvas.addEventListener(\"touchcancel\", touchEnd);\r\n    canvas.addEventListener(\"touchend\", touchEnd);\r\n}\r\n\r\nexport {\r\n    Frustum,\r\n    Shader,\r\n    ArcballCamera,\r\n    Controller,\r\n}","// Code from https://github.com/Twinklebear/webgl-volume-raycaster\r\n// blog: https://www.willusher.io/webgl/2019/01/13/volume-rendering-with-webgl\r\n\r\nexport const vertShader =\r\n`#version 300 es\r\n#line 4\r\nlayout(location=0) in vec3 pos;\r\nuniform mat4 proj_view;\r\nuniform vec3 eye_pos;\r\nuniform vec3 volume_scale;\r\n\r\nout vec3 vray_dir;\r\nflat out vec3 transformed_eye;\r\n\r\nvoid main(void) {\r\n\t// TODO: For non-uniform size volumes we need to transform them differently as well\r\n\t// to center them properly\r\n\tvec3 volume_translation = vec3(0.5) - volume_scale * 0.5;\r\n\tgl_Position = proj_view * vec4(pos * volume_scale + volume_translation, 1);\r\n\ttransformed_eye = (eye_pos - volume_translation) / volume_scale;\r\n\tvray_dir = pos - transformed_eye;\r\n}`;\r\n\r\nexport const fragShader =\r\n`#version 300 es\r\n#line 24\r\nprecision highp int;\r\nprecision highp float;\r\nuniform highp sampler3D volume;\r\nuniform highp sampler2D colormap;\r\nuniform ivec3 volume_dims;\r\nuniform float dt_scale;\r\n\r\nin vec3 vray_dir;\r\nflat in vec3 transformed_eye;\r\nout vec4 color;\r\n\r\nvec2 intersect_box(vec3 orig, vec3 dir) {\r\n\tconst vec3 box_min = vec3(0);\r\n\tconst vec3 box_max = vec3(1);\r\n\tvec3 inv_dir = 1.0 / dir;\r\n\tvec3 tmin_tmp = (box_min - orig) * inv_dir;\r\n\tvec3 tmax_tmp = (box_max - orig) * inv_dir;\r\n\tvec3 tmin = min(tmin_tmp, tmax_tmp);\r\n\tvec3 tmax = max(tmin_tmp, tmax_tmp);\r\n\tfloat t0 = max(tmin.x, max(tmin.y, tmin.z));\r\n\tfloat t1 = min(tmax.x, min(tmax.y, tmax.z));\r\n\treturn vec2(t0, t1);\r\n}\r\n\r\n// Pseudo-random number gen from\r\n// http://www.reedbeta.com/blog/quick-and-easy-gpu-random-numbers-in-d3d11/\r\n// with some tweaks for the range of values\r\nfloat wang_hash(int seed) {\r\n\tseed = (seed ^ 61) ^ (seed >> 16);\r\n\tseed *= 9;\r\n\tseed = seed ^ (seed >> 4);\r\n\tseed *= 0x27d4eb2d;\r\n\tseed = seed ^ (seed >> 15);\r\n\treturn float(seed % 2147483647) / float(2147483647);\r\n}\r\n\r\nfloat linear_to_srgb(float x) {\r\n\tif (x <= 0.0031308f) {\r\n\t\treturn 12.92f * x;\r\n\t}\r\n\treturn 1.055f * pow(x, 1.f / 2.4f) - 0.055f;\r\n}\r\n\r\nvoid main(void) {\r\n\tvec3 ray_dir = normalize(vray_dir);\r\n\tvec2 t_hit = intersect_box(transformed_eye, ray_dir);\r\n\tif (t_hit.x > t_hit.y) {\r\n\t\tdiscard;\r\n\t}\r\n\tt_hit.x = max(t_hit.x, 0.0);\r\n\tvec3 dt_vec = 1.0 / (vec3(volume_dims) * abs(ray_dir));\r\n\tfloat dt = dt_scale * min(dt_vec.x, min(dt_vec.y, dt_vec.z));\r\n\tfloat offset = wang_hash(int(gl_FragCoord.x + 640.0 * gl_FragCoord.y));\r\n\tvec3 p = transformed_eye + (t_hit.x + offset * dt) * ray_dir;\r\n\tfor (float t = t_hit.x; t < t_hit.y; t += dt) {\r\n\t\tfloat val = texture(volume, p).r;\r\n\t\tvec4 val_color = vec4(texture(colormap, vec2(val, 0.5)).rgb, val);\r\n\t\t// Opacity correction\r\n\t\tval_color.a = 1.0 - pow(1.0 - val_color.a, dt_scale);\r\n\t\tcolor.rgb += (1.0 - color.a) * val_color.a * val_color.rgb;\r\n\t\tcolor.a += (1.0 - color.a) * val_color.a;\r\n\t\tif (color.a >= 0.95) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tp += ray_dir * dt;\r\n\t}\r\n    color.r = linear_to_srgb(color.r);\r\n    color.g = linear_to_srgb(color.g);\r\n    color.b = linear_to_srgb(color.b);\r\n}`;\r\n\r\n","// Fenced code from: https://github.com/Twinklebear/webgl-volume-raycaster\r\n\r\nimport React, { Component } from 'react'\r\nimport { connect, ConnectedProps } from 'react-redux'\r\n\r\nimport { State_t } from '../../app/model'\r\nimport { fetch_data_cache } from '../../api'\r\n\r\nimport { selectors } from '../'\r\nimport { apply_green_LUT } from '../helpers'\r\n\r\nimport { mat4, vec3 } from '../webgl/gl-matrix'\r\nimport { ArcballCamera, Shader, Controller } from '../webgl/webgl-util'\r\nimport { fragShader, vertShader } from '../webgl/shader-srcs'\r\n\r\nconst cubeStrip = [\r\n  1, 1, 0,\r\n  0, 1, 0,\r\n  1, 1, 1,\r\n  0, 1, 1,\r\n  0, 0, 1,\r\n  0, 1, 0,\r\n  0, 0, 0,\r\n  1, 1, 0,\r\n  1, 0, 0,\r\n  1, 1, 1,\r\n  1, 0, 1,\r\n  0, 0, 1,\r\n  1, 0, 0,\r\n  0, 0, 0\r\n];\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    shape_x: selectors.get_shape_x(state),\r\n    shape_y: selectors.get_shape_y(state),\r\n    shape_z: selectors.get_shape_z(state),\r\n    scale_x: selectors.get_scale_x(state),\r\n    scale_y: selectors.get_scale_y(state),\r\n    scale_z: selectors.get_scale_z(state),\r\n    height: (selectors.get_shape_y(state) * selectors.get_scale_y(state)\r\n      + selectors.get_shape_z(state) * selectors.get_scale_z(state)),\r\n    width: (selectors.get_shape_x(state) * selectors.get_scale_x(state)\r\n      + selectors.get_shape_z(state) * selectors.get_scale_z(state)),\r\n    data_url: selectors.get_vol_url(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_y(state),\r\n    z: selectors.get_z(state),\r\n    LUT: selectors.get_LUT(state)\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps)\r\n\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\ntype VolumeView_props_t = ReduxProps_t & {\r\n  left: number,\r\n  top: number,\r\n}\r\n\r\ntype VolumeView_state_t = {\r\n  data: Uint8ClampedArray | null\r\n}\r\n\r\nclass _VolumeView\r\n  extends Component<VolumeView_props_t, VolumeView_state_t> {\r\n\r\n  state: VolumeView_state_t\r\n  abort_controller: AbortController\r\n\r\n  // Begin from volume-raycaster.js\r\n\r\n  canvas: HTMLCanvasElement | null = null\r\n  gl: WebGL2RenderingContext | null = null\r\n  shader: Shader | null = null\r\n  volumeTexture: WebGLTexture | null = null\r\n  proj: mat4 = mat4.create()\r\n  camera = new ArcballCamera(vec3.create(), vec3.create(), vec3.create(), 2,\r\n    [500, 500])\r\n  projView = mat4.create()\r\n  targetFrameTime = 50\r\n  samplingRate = 1.0\r\n  WIDTH = 640\r\n  HEIGHT = 480\r\n\r\n  static readonly defaultEye = vec3.set(vec3.create(), 0.5, 0.5, 1.5)\r\n  static readonly center = vec3.set(vec3.create(), 0.5, 0.5, 0.5)\r\n  static readonly up = vec3.set(vec3.create(), 0.0, 1.0, 0.0)\r\n\r\n  // End from volume-raycaster.js\r\n\r\n  constructor(props: VolumeView_props_t) {\r\n    super(props)\r\n    this.abort_controller = new AbortController()\r\n    this.state = {\r\n      data: null,\r\n    }\r\n\r\n    // Begin from volume-raycaster.js\r\n\r\n    this.WIDTH = props.width\r\n    this.HEIGHT = props.height\r\n    this.proj = mat4.perspective(mat4.create(), 60 * Math.PI / 180.0,\r\n      this.WIDTH / this.HEIGHT, 0.1, 100)\r\n\r\n    this.camera = new ArcballCamera(\r\n      _VolumeView.defaultEye, _VolumeView.center, _VolumeView.up,\r\n      2,\r\n      [this.WIDTH, this.HEIGHT])\r\n\r\n    // End from volume-raycaster.js\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    this.canvas = this.refs.canvas as HTMLCanvasElement\r\n    this.gl = this.canvas.getContext(\"webgl2\") as WebGL2RenderingContext\r\n\r\n    const gl = this.gl\r\n\r\n    const controller = new Controller(this.camera);\r\n    controller.mousemove = function (prev: number[], cur: number[],\r\n      evt: MouseEvent) {\r\n\r\n      if (evt.buttons === 1) {\r\n        this.camera.rotate(prev, cur);\r\n\r\n      } else if (evt.buttons === 2) {\r\n        this.camera.pan([cur[0] - prev[0], prev[1] - cur[1]]);\r\n      }\r\n    };\r\n    controller.wheel = function (amt: number) { this.camera.zoom(amt); };\r\n    controller.pinch = controller.wheel;\r\n    controller.twoFingerDrag = function (drag: number) {\r\n      this.camera.pan(drag);\r\n    }\r\n    controller.registerForCanvas(this.canvas);\r\n\r\n    const vao = gl.createVertexArray();\r\n    gl.bindVertexArray(vao);\r\n\r\n    var vbo = gl.createBuffer();\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\r\n    gl.bufferData(gl.ARRAY_BUFFER,\r\n      new Float32Array(cubeStrip), gl.STATIC_DRAW);\r\n\r\n    gl.enableVertexAttribArray(0);\r\n    gl.vertexAttribPointer(0, 3, gl.FLOAT, false, 0, 0);\r\n\r\n    this.shader = new Shader(gl, vertShader, fragShader);\r\n    this.shader.use(gl);\r\n\r\n    // @ts-ignore Property 'volume' does not exist on type '{}'\r\n    gl.uniform1i(this.shader.uniforms[\"volume\"], 0);\r\n    // @ts-ignore\r\n    gl.uniform1i(this.shader.uniforms[\"colormap\"], 1);\r\n    // @ts-ignore\r\n    gl.uniform1f(this.shader.uniforms[\"dt_scale\"], this.samplingRate);\r\n\r\n    // Setup required OpenGL state for drawing the back faces and\r\n    // composting with the background color\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.cullFace(gl.FRONT);\r\n    gl.enable(gl.BLEND);\r\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    // Load the default colormap and upload it, then draw the volume.\r\n    const colormapImage = new Image();\r\n    colormapImage.onload = ((gl, draw) => function () {\r\n      var colormap = gl.createTexture();\r\n      gl.activeTexture(gl.TEXTURE1);\r\n      gl.bindTexture(gl.TEXTURE_2D, colormap);\r\n      gl.texStorage2D(gl.TEXTURE_2D, 1, gl.SRGB8_ALPHA8, 180, 1);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_R, gl.CLAMP_TO_EDGE);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n      gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, 180, 1,\r\n        gl.RGBA, gl.UNSIGNED_BYTE, colormapImage);\r\n\r\n      draw();\r\n    })(gl, this.draw_to_canvas)\r\n    colormapImage.src = \"webgl_colormaps/samsel-linear-green.png\";\r\n\r\n    // End from volume-raycaster.js\r\n\r\n    this.fetch_and_draw()\r\n\r\n  }\r\n\r\n  componentDidUpdate(prev_props: VolumeView_props_t) {\r\n    if (this.props.data_url !== prev_props.data_url)\r\n      this.fetch_and_draw()\r\n    else if (this.props.LUT !== prev_props.LUT)\r\n      this.draw_to_canvas()\r\n  }\r\n\r\n  fetch_and_draw = () => {\r\n\r\n    this.abort_controller.abort()\r\n    this.abort_controller = new AbortController()\r\n\r\n    fetch_data_cache(this.props.data_url, this.abort_controller.signal)\r\n      .then(data => this.setState({ data }))\r\n      .then(this.draw_to_canvas)\r\n  }\r\n\r\n  draw_to_canvas = () => {\r\n\r\n    if ((this.state.data === null) ||\r\n      (this.state.data === undefined) ||\r\n      (this.props.width === 0) ||\r\n      (this.props.height === 0) ||\r\n      (this.gl === null) ||\r\n      (this.camera === null)) {\r\n\r\n      return\r\n    }\r\n\r\n    const gl = this.gl\r\n    const volDims = [\r\n      this.props.shape_x,\r\n      this.props.shape_y,\r\n      this.props.shape_z\r\n    ]\r\n\r\n    const LUTdata = apply_green_LUT(this.state.data, this.props.LUT)\r\n\r\n    const tex = gl.createTexture();\r\n\r\n    gl.activeTexture(gl.TEXTURE0);\r\n    gl.bindTexture(gl.TEXTURE_3D, tex);\r\n    gl.texStorage3D(gl.TEXTURE_3D, 1, gl.R8, volDims[0], volDims[1], volDims[2]);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_R, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_3D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texSubImage3D(gl.TEXTURE_3D, 0, 0, 0, 0,\r\n      volDims[0], volDims[1], volDims[2],\r\n      gl.RED, gl.UNSIGNED_BYTE, LUTdata);\r\n\r\n    var longestAxis = Math.max(volDims[0], Math.max(volDims[1], volDims[2]));\r\n    var volScale = [\r\n      volDims[0] / longestAxis * this.props.scale_x,\r\n      volDims[1] / longestAxis * this.props.scale_y,\r\n      volDims[2] / longestAxis * this.props.scale_z,\r\n    ]\r\n\r\n    // @ts-ignore Property 'volume_dims' does not exist on type '{}'\r\n    gl.uniform3iv(this.shader.uniforms[\"volume_dims\"], volDims)\r\n    // @ts-ignore Property 'volume_scale' does not exist on type '{}'\r\n    gl.uniform3fv(this.shader.uniforms[\"volume_scale\"], volScale)\r\n\r\n    if (!this.volumeTexture) {\r\n      this.volumeTexture = tex;\r\n      setInterval(() => {\r\n\r\n        // Save them some battery if they're not viewing the tab\r\n        if (document.hidden) {\r\n          return;\r\n        }\r\n        const startTime = new Date()\r\n        gl.clearColor(0.0, 0.0, 0.0, 1.0)\r\n        gl.clear(gl.COLOR_BUFFER_BIT)\r\n\r\n        this.projView = mat4.mul(this.projView as mat4, this.proj,\r\n          this.camera.camera);\r\n\r\n        // @ts-ignore Property 'proj_view' does not exist on type '{}'\r\n        gl.uniformMatrix4fv(this.shader.uniforms[\"proj_view\"],\r\n          false,\r\n          this.projView)\r\n\r\n        var eye = [this.camera.invCamera[12],\r\n        this.camera.invCamera[13],\r\n        this.camera.invCamera[14]]\r\n\r\n        // @ts-ignore Property 'eye_pos' does not exist on type '{}'\r\n        gl.uniform3fv(this.shader.uniforms[\"eye_pos\"], eye);\r\n\r\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, cubeStrip.length / 3);\r\n        // Wait for rendering to actually finish\r\n        gl.finish()\r\n\r\n        const endTime = new Date();\r\n        const renderTime = (endTime.getTime() - startTime.getTime())\r\n        const targetSamplingRate = renderTime / this.targetFrameTime\r\n        if (this.samplingRate < targetSamplingRate) {\r\n          this.samplingRate = (\r\n            0.8 * this.samplingRate +\r\n            0.2 * targetSamplingRate)\r\n          // @ts-ignore\r\n          gl.uniform1f(this.shader.uniforms[\"dt_scale\"], this.samplingRate);\r\n        }\r\n\r\n      }, this.targetFrameTime)\r\n    }\r\n    else {\r\n      gl.deleteTexture(this.volumeTexture);\r\n      this.volumeTexture = tex;\r\n    }\r\n\r\n  }\r\n\r\n  render() {\r\n\r\n    return (\r\n      <div style={{\r\n        position: \"relative\",\r\n        left: this.props.left,\r\n        top: this.props.top,\r\n        right: \"0px\",\r\n      }}>\r\n\r\n        <canvas ref=\"canvas\"\r\n          width={this.props.width}\r\n          height={this.props.height}\r\n          style={{\r\n            position: \"absolute\",\r\n            left: \"0px\",\r\n            top: \"0px\",\r\n            zIndex: 1,\r\n          }}>\r\n        </canvas>\r\n\r\n      </div>)\r\n  }\r\n}\r\n\r\nexport const VolumeView = connector(_VolumeView)\r\n","import React from 'react'\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect, ConnectedProps } from \"react-redux\"\r\n\r\nimport { Slider } from '@material-ui/core';\r\n\r\nimport { AppDispatch_t } from '../../index'\r\nimport { actions } from '../actions'\r\nimport * as selectors from '../selectors'\r\nimport { saga_actions as annotations_saga_actions } from '../../annotations'\r\nimport { selectors as annotations_selectors } from '../../annotations'\r\nimport { State_t } from '../../app/model'\r\nimport { AnnotationViewZ, AnnotationViewX, AnnotationViewY }\r\n  from './AnnovationView'\r\nimport { AnnotationPanel } from '../../annotations'\r\nimport { saga_actions } from '../sagas'\r\nimport WindowPanel from './WindowPanel'\r\nimport { WorldlinesPanel } from '../../worldlines'\r\nimport { VolumeView } from './VolumeView'\r\nimport { ProvenancePanel } from '../../provenances'\r\n\r\nconst XYZSliderBase = (props: {\r\n  left: number,\r\n  top: number,\r\n  length: number,\r\n  flip: boolean,\r\n  orientation: \"horizontal\" | \"vertical\",\r\n  val: number,\r\n  handler: (x: number) => any\r\n}) => {\r\n\r\n  return <Slider\r\n    style={{\r\n      position: \"absolute\",\r\n      left: props.left,\r\n      top: props.top,\r\n      width: (props.orientation === \"horizontal\") ? props.length : 0,\r\n      height: (props.orientation === \"vertical\") ? props.length : 0\r\n    }}\r\n    color=\"primary\"\r\n    orientation={props.orientation}\r\n    defaultValue={0.5}\r\n    value={props.flip ? (1 - props.val) : props.val}\r\n    min={0}\r\n    max={1}\r\n    step={0.0001}\r\n    track={false}\r\n    scale={props.flip ? (x) => (1 - x) : (x) => x}\r\n    onChange={(e, v) => props.handler(props.flip ?\r\n      1 - (v as number) : (v as number))} />\r\n}\r\n\r\nconst TSliderBase = (props: {\r\n  left: number,\r\n  top: number,\r\n  length: number,\r\n  val: number,\r\n  max_val: number,\r\n  handler: (x: number) => any\r\n}) => {\r\n\r\n  return <Slider\r\n    style={{\r\n      position: \"absolute\",\r\n      left: props.left,\r\n      top: props.top,\r\n      width: props.length,\r\n    }}\r\n    color=\"secondary\"\r\n    orientation=\"horizontal\"\r\n    defaultValue={0}\r\n    value={props.val}\r\n    min={0}\r\n    max={props.max_val}\r\n    track={false}\r\n    step={1}\r\n    onChange={(e, v) => props.handler(v as number)} />\r\n}\r\n\r\nconst LUTSliderBase = (props: {\r\n  left: number,\r\n  top: number,\r\n  length: number,\r\n  color: string,\r\n  val: [number, number],\r\n  handler: (x: [number, number]) => any\r\n}) => {\r\n  const [value, setValue] = React.useState<number[]>([0, 255]);\r\n\r\n  const handleChange = (event: any, newValue: number | number[]) => {\r\n    setValue(newValue as number[]);\r\n    props.handler(newValue as [number, number])\r\n  };\r\n\r\n  return (\r\n\r\n    <Slider\r\n      style={{\r\n        position: \"absolute\",\r\n        left: props.left,\r\n        top: props.top,\r\n        width: props.length,\r\n        color: props.color,\r\n      }}\r\n      value={value}\r\n      min={0}\r\n      max={255}\r\n      onChange={handleChange}\r\n      valueLabelDisplay=\"auto\"\r\n    />\r\n\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    window_state: selectors.get_state(state),\r\n    annotations_z: annotations_selectors.get_z_annotations(state),\r\n    annotations_3D: annotations_selectors.get_annotations_view3D(state),\r\n    size_x: selectors.get_shape_x(state) * selectors.get_scale_x(state),\r\n    size_y: selectors.get_shape_y(state) * selectors.get_scale_y(state),\r\n    size_z: selectors.get_shape_z(state) * selectors.get_scale_z(state),\r\n    x: selectors.get_x(state),\r\n    y: selectors.get_y(state),\r\n    z: selectors.get_z(state),\r\n    t_idx: selectors.get_t_idx(state),\r\n    shape_t: selectors.get_shape_t(state),\r\n    LUT: selectors.get_LUT(state),\r\n    view: selectors.get_view(state),\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch_t) => {\r\n  return {\r\n    actions: bindActionCreators({ ...actions }, dispatch),\r\n    saga_actions: bindActionCreators({ ...saga_actions }, dispatch),\r\n    delete_annotation: () => dispatch(\r\n      annotations_saga_actions.delete_annotation()),\r\n  }\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps)\r\ntype ReduxProps_t = ConnectedProps<typeof connector>\r\n\r\ntype AnnotationWindow_props_t = ReduxProps_t & {\r\n}\r\n\r\nconst _AnnotationWindow = (props: AnnotationWindow_props_t) => {\r\n\r\n  const origin_left = 20;\r\n  const origin_top = 20;\r\n  const padding_1 = 10;\r\n\r\n  const x_image_left = origin_left + props.size_x + padding_1;\r\n  const x_image_top = origin_top;\r\n\r\n  const y_image_left = origin_left;\r\n  const y_image_top = origin_top + props.size_y + padding_1;\r\n\r\n  const x_slider_left = origin_left;\r\n  const x_slider_top = y_image_top + props.size_z;\r\n\r\n  const y_slider_left = x_image_left + props.size_z + 2 * padding_1;\r\n  const y_slider_top = origin_top;\r\n\r\n  const z_slider_1_left = x_image_left;\r\n  const z_slider_1_top = x_slider_top;\r\n\r\n  const z_slider_2_left = y_slider_left;\r\n  const z_slider_2_top = y_slider_top + y_image_top - origin_top;\r\n\r\n  const t_slider_left = origin_left\r\n  const t_slider_top = x_slider_top + 2 * padding_1\r\n  const t_slider_length = props.size_x + props.size_z + padding_1\r\n\r\n  const annotation_panel_left = y_slider_left + 5 * padding_1\r\n\r\n  const LUT_slider_length = t_slider_length / 3 - 2 * padding_1\r\n  const LUT_top = t_slider_top + 5 * padding_1\r\n  const LUT_R_left = origin_left\r\n  const LUT_G_left = LUT_R_left + LUT_slider_length + 5 * padding_1\r\n  const LUT_B_left = LUT_G_left + LUT_slider_length + 5 * padding_1\r\n\r\n  const window_panel_left = origin_left\r\n  const window_panel_top = LUT_top + 5 * padding_1\r\n\r\n\r\n  let views\r\n  if (props.view === \"vol\") {\r\n    views = (\r\n      <VolumeView\r\n        left={origin_left}\r\n        top={origin_top} />\r\n    )\r\n  }\r\n  else {\r\n    views = (\r\n      <React.Fragment>\r\n        <AnnotationViewZ left={origin_left} top={origin_top} />\r\n        <AnnotationViewX left={x_image_left} top={x_image_top} />\r\n        <AnnotationViewY left={y_image_left} top={y_image_top} />\r\n      </React.Fragment>\r\n    )\r\n  }\r\n\r\n  const XSlider =\r\n    <XYZSliderBase\r\n      left={x_slider_left}\r\n      top={x_slider_top}\r\n      length={props.size_x}\r\n      orientation=\"horizontal\"\r\n      flip={false}\r\n      val={props.x}\r\n      handler={props.actions.set_x} />\r\n\r\n  const YSlider =\r\n    <XYZSliderBase\r\n      left={y_slider_left}\r\n      top={y_slider_top}\r\n      length={props.size_y}\r\n      orientation=\"vertical\"\r\n      flip={true}\r\n      val={props.y}\r\n      handler={props.actions.set_y} />\r\n\r\n  const ZSlider1 =\r\n    <XYZSliderBase\r\n      left={z_slider_1_left}\r\n      top={z_slider_1_top}\r\n      length={props.size_z}\r\n      orientation=\"horizontal\"\r\n      flip={false}\r\n      val={props.z}\r\n      handler={props.actions.set_z} />\r\n\r\n  const ZSlider2 =\r\n    <XYZSliderBase\r\n      left={z_slider_2_left}\r\n      top={z_slider_2_top}\r\n      length={props.size_z}\r\n      orientation=\"vertical\"\r\n      flip={true}\r\n      val={props.z}\r\n      handler={props.actions.set_z} />\r\n\r\n  const TSlider =\r\n    <TSliderBase\r\n      left={t_slider_left}\r\n      top={t_slider_top}\r\n      length={t_slider_length}\r\n      val={props.t_idx}\r\n      max_val={props.shape_t - 1}\r\n      handler={props.actions.set_t_idx} />\r\n\r\n  const LUTSliderRed =\r\n    <LUTSliderBase\r\n      left={LUT_R_left}\r\n      top={LUT_top}\r\n      length={LUT_slider_length}\r\n      val={props.LUT.red}\r\n      color=\"red\"\r\n      handler={([l, h]) => props.actions.set_LUT_color([\"red\", l, h])} />\r\n  const LUTSliderGreen =\r\n    <LUTSliderBase\r\n      left={LUT_G_left}\r\n      top={LUT_top}\r\n      length={LUT_slider_length}\r\n      val={props.LUT.green}\r\n      color=\"green\"\r\n      handler={([l, h]) => props.actions.set_LUT_color([\"green\", l, h])} />\r\n  const LUTSliderBlue =\r\n    <LUTSliderBase\r\n      left={LUT_B_left}\r\n      top={LUT_top}\r\n      length={LUT_slider_length}\r\n      val={props.LUT.blue}\r\n      color=\"blue\"\r\n      handler={([l, h]) => props.actions.set_LUT_color([\"blue\", l, h])} />\r\n\r\n\r\n  const keydown_handler = (event: React.KeyboardEvent) => {\r\n\r\n    const key = String.fromCharCode(event.which)\r\n    const ctrl = event.ctrlKey\r\n    const shift = event.shiftKey\r\n\r\n    switch (key) {\r\n      case \"F\": {\r\n        if (shift) props.saga_actions.adjust_t(10)\r\n        else props.saga_actions.adjust_t(1)\r\n        break;\r\n      }\r\n      case \"D\": {\r\n        if (shift) props.saga_actions.adjust_t(-10)\r\n        else props.saga_actions.adjust_t(-1)\r\n        break;\r\n      }\r\n      case \"V\": {\r\n        if (shift) props.actions.set_z(props.z + 0.2)\r\n        else if (ctrl) props.actions.set_z(props.z + 0.02)\r\n        else props.actions.set_z(props.z + 0.05)\r\n        break;\r\n      }\r\n      case \"C\": {\r\n        if (shift) props.actions.set_z(props.z - 0.2)\r\n        else if (ctrl) props.actions.set_z(props.z - 0.01)\r\n        else props.actions.set_z(props.z - 0.05)\r\n        break;\r\n      }\r\n      case \"R\": {\r\n        props.actions.adjust_c_idx(1)\r\n        break\r\n      }\r\n      case \"E\": {\r\n        props.actions.adjust_c_idx(-1)\r\n        break\r\n      }\r\n      case \".\": {\r\n        props.delete_annotation()\r\n        break\r\n      }\r\n      case \"S\": {\r\n        if (ctrl) props.saga_actions.save()\r\n        break\r\n      }\r\n      case \"O\": {\r\n        props.actions.toggle_fill_circles()\r\n        break\r\n      }\r\n      case \"A\": {\r\n        props.actions.toggle_all_annotations()\r\n        break\r\n      }\r\n      case \"1\":\r\n      case \"2\":\r\n      case \"3\":\r\n      case \"4\":\r\n      case \"5\":\r\n      case \"6\":\r\n      case \"7\":\r\n      case \"8\":\r\n      case \"9\":\r\n      case \"0\":\r\n        if (!ctrl && !shift) props.saga_actions.rpc_from_key(key)\r\n        break\r\n    }\r\n\r\n    event.preventDefault()\r\n  }\r\n\r\n  const keyup_handler = (event: React.KeyboardEvent) => {\r\n    //const key = String.fromCharCode(event.which)\r\n  }\r\n\r\n  return (\r\n    <div style={{ position: \"absolute\" }}>\r\n      <div tabIndex={0}\r\n        onKeyDown={keydown_handler}\r\n        onKeyUp={keyup_handler}>\r\n\r\n        {views}\r\n\r\n        {XSlider}\r\n        {YSlider}\r\n        {ZSlider1}\r\n        {ZSlider2}\r\n        {TSlider}\r\n\r\n        {LUTSliderRed}\r\n        {LUTSliderGreen}\r\n        {LUTSliderBlue}\r\n\r\n      </div>\r\n\r\n      <WindowPanel\r\n        left={window_panel_left}\r\n        top={window_panel_top} />\r\n\r\n      <div style={{ position: \"absolute\",\r\n        left: annotation_panel_left,\r\n        width: \"340px\" }}>\r\n\r\n        <AnnotationPanel/>\r\n\r\n        <ProvenancePanel/>\r\n\r\n        <WorldlinesPanel/>\r\n\r\n      </div>\r\n\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nconst AnnotationWindow = connector(_AnnotationWindow)\r\n\r\nexport default AnnotationWindow","import React from 'react'\r\n\r\nimport { AnnotationWindow } from '../../annotation_window'\r\n\r\n\r\nconst App = () => {\r\n  return (\r\n    <div>\r\n      <AnnotationWindow />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App","import { combineReducers } from 'redux'\r\n\r\nimport {\r\n  actions as annotation_window_actions,\r\n  reducer as annotation_window_reducer\r\n} from '../annotation_window'\r\n\r\nimport {\r\n  actions as annotations_actions,\r\n  reducer as annotations_reducer\r\n} from '../annotations'\r\n\r\nimport {\r\n  actions as worldlines_actions,\r\n  reducer as worldlines_reducer\r\n} from '../worldlines'\r\n\r\nimport {\r\n  actions as provenances_actions,\r\n  reducer as provenances_reducer\r\n} from '../provenances'\r\n\r\nexport const actions = {\r\n  annotation_window: annotation_window_actions,\r\n  annotations: annotations_actions,\r\n  worldlines: worldlines_actions,\r\n  provenances: provenances_actions\r\n}\r\n\r\nexport const reducer = combineReducers({\r\n  annotation_window: annotation_window_reducer,\r\n  annotations: annotations_reducer,\r\n  worldlines: worldlines_reducer,\r\n  provenances: provenances_reducer\r\n});","import { all } from 'redux-saga/effects'\r\n\r\nimport {\r\n  sagas as annotation_window_sagas,\r\n  saga_actions as annotation_window_saga_actions,\r\n} from '../annotation_window'\r\n\r\nimport {\r\n  sagas as annotations_sagas,\r\n  saga_actions as annotations_saga_actions,\r\n} from '../annotations'\r\n\r\nimport {\r\n  sagas as worldlines_sagas,\r\n  saga_actions as worldlines_saga_actions,\r\n} from '../worldlines'\r\n\r\nimport {\r\n  sagas as provenances_sagas,\r\n  saga_actions as provenances_saga_actions,\r\n} from '../provenances'\r\n\r\nexport function* saga() {\r\n  yield all([\r\n    ...annotation_window_sagas,\r\n    ...annotations_sagas,\r\n    ...worldlines_sagas,\r\n    ...provenances_sagas\r\n  ].map(f => f()))\r\n}\r\n\r\nexport const saga_actions = {\r\n  annotation_window: annotation_window_saga_actions,\r\n  annotations: annotations_saga_actions,\r\n  worldlines: worldlines_saga_actions,\r\n  provenances: provenances_saga_actions\r\n}","/* This file should provide an interface to visualize the state and dispatch\r\nactions. UI and styling should be minimal. */\r\n\r\nimport React from 'react'\r\nimport { connect } from \"react-redux\"\r\nimport ReactJson from 'react-json-view'\r\n\r\nimport { actions } from '../actions'\r\nimport { saga_actions } from '../sagas'\r\nimport { State_t } from '../../app/model'\r\nimport { FloatForm } from '../../test_components/ActionForm'\r\n\r\nimport * as annotation_window_selectors\r\n  from '../../annotation_window/selectors'\r\n\r\nconst _Test = ({ state, x_idx, ...A }: any) => {\r\n\r\n  const derived_state = { x_idx }\r\n\r\n  const full_state = { bare_state: state, derived_state }\r\n\r\n  // const state_json = JSON.stringify(full_state, null, 4);\r\n\r\n  return (\r\n    <div>\r\n\r\n      {/* <pre><code>app: {state_json}</code></pre> */}\r\n      <ReactJson theme=\"monokai\" src={full_state} />\r\n\r\n      <br />\r\n\r\n      Simple Actions:\r\n      <FloatForm name=\"set_shape_x\" action={A.set_shape_x} />\r\n      <FloatForm name=\"set_x\" action={A.set_x} />\r\n      <FloatForm name=\"set_t_idx\" action={A.set_t_idx} />\r\n      <FloatForm name=\"adjust_x\" action={A.adjust_x} />\r\n      <FloatForm name=\"set_scale_x\" action={A.set_scale_x} />\r\n\r\n      <br />\r\n\r\n      Async Actions:\r\n      <br />\r\n\r\n      <button onClick={() => A.fetch_state()}>\r\n        fetch_state\r\n      </button>\r\n\r\n      <button onClick={() => A.insert_annotation_here()}>\r\n        insert_annotation\r\n      </button>\r\n\r\n      <FloatForm name=\"fetch_annotations\" action={A.get_annotations} />\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: State_t) => {\r\n  return {\r\n    state: state,\r\n    x_idx: annotation_window_selectors.get_x_idx(state)\r\n  }\r\n}\r\n\r\nconst AppTest =\r\n  connect(mapStateToProps,\r\n    { ...actions.annotation_window,\r\n      ...actions.annotations,\r\n      ...saga_actions.annotation_window,\r\n      ...saga_actions.annotations\r\n    })(_Test)\r\n\r\nexport default AppTest","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux'\r\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom'\r\nimport { configureStore, getDefaultMiddleware } from \"@reduxjs/toolkit\"\r\nimport createSagaMiddleware from 'redux-saga'\r\n\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles'\r\nimport { blue, pink } from '@material-ui/core/colors';\r\n\r\nimport './index.css';\r\nimport { App, AppTest, reducer, saga } from './app';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { saga_actions } from './app'\r\n\r\nconst sagaMiddleware = createSagaMiddleware();\r\nconst middleware = [...getDefaultMiddleware({ thunk: false }), sagaMiddleware];\r\n\r\n\r\nconst store = configureStore({\r\n  reducer,\r\n  middleware,\r\n});\r\n\r\nexport type AppDispatch_t = typeof store.dispatch\r\n\r\nsagaMiddleware.run(saga);\r\n\r\nconst darkTheme = createMuiTheme({\r\n  palette: {\r\n    type: 'dark',\r\n    primary: blue,\r\n    secondary: pink,\r\n  },\r\n  typography: {\r\n    fontFamily: [\r\n      'source-code-pro',\r\n      '-apple-system',\r\n      'BlinkMacSystemFont',\r\n      '\"Segoe UI\"',\r\n      'Roboto',\r\n      '\"Helvetica Neue\"',\r\n      'Arial',\r\n      'sans-serif',\r\n      '\"Apple Color Emoji\"',\r\n      '\"Segoe UI Emoji\"',\r\n      '\"Segoe UI Symbol\"',\r\n    ].join(','),\r\n  },\r\n})\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <ThemeProvider theme={darkTheme}>\r\n      <Router>\r\n        <Switch>\r\n          <Route exact path=\"/\" component={App} />\r\n          <Route path=\"/AppTest\" component={AppTest} />\r\n        </Switch>\r\n      </Router>\r\n    </ThemeProvider>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n)\r\n\r\nstore.dispatch(saga_actions.annotation_window.fetch_state())\r\nstore.dispatch(saga_actions.worldlines.get_worldlines())\r\nstore.dispatch(saga_actions.annotations.get_annotations())\r\nstore.dispatch(saga_actions.provenances.fetch_provenances())\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}